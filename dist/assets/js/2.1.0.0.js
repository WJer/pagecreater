(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{251:function(e,t,n){var r=n(252);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},252:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"home-index.less"}])},253:function(e,t,n){var r=n(254);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},254:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"animate.less"}])},255:function(e,t,n){var r=n(256);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},256:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"animations.less"}])},257:function(e,t,n){var r=n(258);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},258:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"h5ds.app.less"}])},259:function(e,t,n){var r=n(260);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},260:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"initialize.less"}])},261:function(e,t,n){var r=n(262);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},262:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"initantd.less"}])},263:function(e,t,n){var r=n(264);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},264:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"utils.less"}])},265:function(e,t){$.contextMenu=function(e){var t=$.extend({x:0,y:0,vals:[],callback:null},e);if(!$(".app-contextmenu")[0]){var n='<div class="app-contextmenu" style="left: '.concat(t.x,"px; top: ").concat(t.y,'px;">\n          <ul>\n              ').concat(t.vals.map((function(e){return'<li class="app-contextmenu-item" data-val="'.concat(e.val,'">').concat(e.name,"</li>")})).join(""),"\n          </ul>\n      </div>");$("body").append(n)}var r=$(".app-contextmenu"),a={height:r.height(),width:r.width(),win_width:$(window).width(),win_height:$(window).height(),new_x:t.x,new_y:t.y};t.x+a.width>a.win_width&&(a.new_x=a.win_width-a.width-20),t.y+a.height>a.win_height&&(a.new_y=a.win_height-a.height-50),r.css({left:a.new_x,top:a.new_y}),$(document).off("click.contextmenu").on("click.contextmenu",(function(e){var n=$(e.target).closest(".app-contextmenu-item");n[0]&&t.callback&&t.callback(n.attr("data-val"),n),$(".app-contextmenu").remove()}))}},342:function(e,t){$(document).on("mousedown.uniqlist",".app-uniqlist",(function(e){e.stopPropagation();var t=e.pageX,n=e.pageY,r=$(this);if(r.trigger("uniqstart"),"app-uniqlist"!==e.target.className&&!$(e.target).closest(".app-uniq-clone")[0]){var a=$(e.target).closest("li");if(a[0]){var o=parseInt(a.position().left,10),i=parseInt(a.position().top,10),s=a.height(),c=a.index(),p=null,l=function(){a.addClass("app-uniq-start").siblings("li").removeClass("app-uniq-start"),(p=$(a.clone())).addClass("app-uniq-clone").css({left:o,top:i,width:a.width(),height:a.height(),position:"absolute"}),r.append(p.prop("outerHTML")),p=$(".app-uniq-clone")},u=s+(parseInt(a.css("margin-top"),10)+parseInt(a.css("margin-bottom"),10)),h=parseInt(a.css("top"),10),d=r.scrollTop();h="auto"!=h?h:0;var f=!0,y=!1;$(document).on("mousemove.uniqlist",(function(e){var r=h+(e.pageY-n);Math.abs(r)>3&&(f=!1,y||(y=!0,l(),l=null),p.css({left:o+(e.pageX-t),top:i+(e.pageY-n)+d}),r>0&&r>u?a.next()[0]&&(h-=u,a.before(a.next())):r<0&&-r>u&&a.prev()[0]&&(h+=u,a.after(a.prev())))})).on("mouseup.uniqlist",(function(){var e=parseInt(a.position().left,10),t=parseInt(a.position().top,10)+d;f?(a.removeClass("app-uniq-start"),r=null,a=null):p.animate({left:e,top:t},500,(function(){p.remove(),a.removeClass("app-uniq-start");var e=a.index();e>=0&&c!=e&&r.trigger("uniqend",{from:c,to:e}),p=null,r=null,a=null})),$(document).off("mousemove.uniqlist"),$(document).off("mouseup.uniqlist")}))}}}))},343:function(e,t){$.helps=function(e){var t=$.extend({data:[]},e);$(".app-helps")[0]||$("body").append('\n      <div class="app-helps">\n          <div class="app-helps-content">\n              <a class="app-helps-close"><i class="app-ico app-ico-close"></i></a>\n              <div class="app-helps-info"></div>\n              <div class="app-helps-btns">\n                  <a class="app-helps-prev">上一步</a>\n                  <a class="app-helps-next">下一步</a>\n                  <a class="app-helps-end">完成</a>\n              </div>\n          </div>\n      </div>\n      ');var n=$(".app-helps"),r=n.find(".app-helps-content"),a=function(e){0===e?($(".app-helps-prev").hide(),$(".app-helps-next").show(),$(".app-helps-end").hide()):e===t.data.length-1?($(".app-helps-next").hide(),$(".app-helps-end").show(),$(".app-helps-prev").show()):($(".app-helps-end").hide(),$(".app-helps-next").show(),$(".app-helps-prev").show());var a=t.data[e],o=$(a.dom),i={transfrom:o.css("transfrom"),width:o.outerWidth(),height:o.outerHeight(),left:o.offset().left,top:o.offset().top};n.css(i),r.removeClass().addClass("app-helps-content app-helps-"+a.pos),n.find(".app-helps-info").html(a?a.content:"")},o=0;a(o),1===t.data.length&&($(".app-helps-next").hide(),$(".app-helps-end").show()),n.on("click",".app-helps-next",(function(){++o<t.data.length&&a(o)})),n.on("click",".app-helps-prev",(function(){--o>=0&&a(o)})),n.on("click",".app-helps-close, .app-helps-end",(function(){n.off("click"),n.remove()}))}},345:function(e,t,n){var r=n(346);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},346:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"editor.less"}])},347:function(e,t,n){var r=n(348);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},348:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"layer.less"}])},349:function(e,t,n){var r=n(350);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},350:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"layer.less"}])},351:function(e,t,n){var r=n(352);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},352:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"editor.less"}])},353:function(e,t,n){var r=n(354);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},354:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"cropImage.less"}])},355:function(e,t,n){var r=n(356);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},356:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"layer.less"}])},357:function(e,t,n){var r=n(358);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},358:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"modal.less"}])},359:function(e,t,n){var r=n(360);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},360:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"h5dsmodal.less"}])},361:function(e,t,n){var r=n(362);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},362:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"noserver-modal.less"}])},363:function(e,t,n){var r=n(364);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},364:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"editor.less"}])},365:function(e,t,n){var r=n(366);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},366:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"color.less"}])},464:function(e,t,n){var r=n(465);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},465:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"setgrid.less"}])},466:function(e,t,n){var r=n(467);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},467:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"setitem.less"}])},468:function(e,t,n){var r=n(469);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},469:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"layer.less"}])},470:function(e,t,n){var r=n(471);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},471:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"modal.less"}])},472:function(e,t,n){var r=n(473);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},473:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"h5dsdrawer.less"}])},476:function(e,t,n){var r=n(477);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},477:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"editor.less"}])},478:function(e,t,n){var r=n(479);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},479:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"layer.less"}])},480:function(e,t,n){var r=n(481);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},481:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"editor.less"}])},482:function(e,t,n){var r=n(483);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},483:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"style.less"}])},484:function(e,t,n){var r=n(485);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},485:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"slidergroup.less"}])},585:function(e,t,n){var r=n(586);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},586:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"layer.less"}])},590:function(e,t,n){var r=n(591);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},591:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"adsorbline.less"}])},592:function(e,t,n){var r=n(593);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},593:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"canvas.less"}])},594:function(e,t,n){var r=n(595);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},595:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"setpage.less"}])},596:function(e,t,n){var r=n(597);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},597:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"grid.less"}])},598:function(e,t,n){var r=n(599);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},599:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"editarea.less"}])},600:function(e,t,n){var r=n(601);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},601:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"appset.less"}])},602:function(e,t,n){var r=n(603);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},603:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"background.less"}])},604:function(e,t,n){var r=n(605);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},605:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"layerset.less"}])},606:function(e,t,n){var r=n(607);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},607:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"animateset.less"}])},608:function(e,t,n){var r=n(609);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},609:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"layerevent.less"}])},610:function(e,t,n){var r=n(611);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},611:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"style.less"}])},612:function(e,t,n){var r=n(613);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},613:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"eventbox.less"}])},614:function(e,t,n){var r=n(615);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},615:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"style.less"}])},616:function(e,t,n){var r=n(617);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},617:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"style.less"}])},618:function(e,t,n){var r=n(619);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},619:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"style.less"}])},620:function(e,t,n){var r=n(621);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},621:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"style.less"}])},622:function(e,t,n){var r=n(623);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},623:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"style.less"}])},624:function(e,t,n){var r=n(625);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},625:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"adsorbset.less"}])},626:function(e,t,n){var r=n(627);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},627:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"basicset.less"}])},628:function(e,t,n){var r=n(629);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},629:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"moreset.less"}])},630:function(e,t,n){var r=n(631);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},631:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"pageset.less"}])},632:function(e,t,n){var r=n(633);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},633:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"header.less"}])},634:function(e,t,n){var r=n(635);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},635:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"layermenu.less"}])},636:function(e,t,n){var r=n(637);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},637:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"publish.less"}])},638:function(e,t,n){var r=n(639);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},639:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"preview.less"}])},640:function(e,t,n){var r=n(641);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},641:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"h5swiper.less"}])},648:function(e,t,n){var r=n(649);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},649:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"template.less"}])},650:function(e,t,n){var r=n(651);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},651:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"loadingBox.less"}])},652:function(e,t,n){var r=n(653);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(24)(r,a);r.locals&&(e.exports=r.locals)},653:function(e,t,n){(e.exports=n(23)(!0)).push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"loading.less"}])},658:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"LayerComp",(function(){return Ye})),n.d(r,"config",(function(){return Fe}));var a={};n.r(a),n.d(a,"LayerComp",(function(){return mt})),n.d(a,"config",(function(){return dt}));var o={};n.r(o),n.d(o,"LayerComp",(function(){return Jt})),n.d(o,"config",(function(){return Bt}));var i={};n.r(i),n.d(i,"LayerComp",(function(){return cn})),n.d(i,"config",(function(){return on}));var s={};n.r(s),n.d(s,"LayerComp",(function(){return Fn})),n.d(s,"config",(function(){return $n}));var c={};n.r(c),n.d(c,"Editor",(function(){return Tn})),n.d(c,"LayerJSON",(function(){return zn})),n.d(c,"LayerComp",(function(){return Fn})),n.d(c,"icon",(function(){return Hn})),n.d(c,"config",(function(){return $n}));var p={};n.r(p),n.d(p,"text",(function(){return c}));var l={};n.r(l),n.d(l,"img",(function(){return a})),n.d(l,"text",(function(){return s})),n.d(l,"sound",(function(){return i})),n.d(l,"combin",(function(){return r})),n.d(l,"shape",(function(){return o}));var u=n(2),h=n.n(u),d=n(11),f=n.n(d),y=n(3),m=n.n(y),v=n(5),g=n.n(v),b=n(15),w=n.n(b),k=n(16),E=n.n(k),O=n(10),S=n.n(O),x=(n(251),n(0)),D=n.n(x),P=n(18),j=n(83),C=n.n(j),R=n(79),I=n.n(R);window.pubSubEditor||(window.pubSubEditor=new I.a,window.pubSubEditor.publish=window.pubSubEditor.publishSync);var N=window.pubSubEditor,L=(n(253),n(255),n(257),n(259),n(261),n(263),n(265),n(107)),A=n.n(L);function _(){var e={start:"mousedown",move:"mousemove",end:"mouseup",touch:!1,touchEvent:function(e){return e.originalEvent.targetTouches[0]}};return"ontouchend"in document&&(e.start="touchstart",e.move="touchmove",e.end="touchend",e.touch=!0),e}var T=n(89),z=n.n(T),H=n(185),W=n.n(H),M=n(29),B=n.n(M),F=n(157),V=n.n(F),G=n(90),U=n.n(G),Y=n(204),J=n.n(Y),q=n(330),X=n.n(q),K={datetime:"YYYY/MM/DD HH:mm:ss",date:"YYYY/MM/DD",time:"HH:mm:ss"},Q=new(function(){function e(){m()(this,e)}return g()(e,[{key:"isUrl",value:function(e){return/https?:\/\/[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/i.test(e)}},{key:"isPhoneNum",value:function(e){return/^(0|86|17951)?(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/.test(e)}},{key:"getUrlQuery",value:function(e){for(var t=window.location.search.substring(1).split("&"),n=0;n<t.length;n++){var r=t[n].split("=");if(r[0]==e)return r[1]}return!1}},{key:"getSource",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{loadSound:!1},r=[],a=e.pages,o=void 0===a?[]:a,i=e.fixeds,s=void 0===i?[]:i,c=e.popups,p=void 0===c?[]:c;return e.style&&e.style.backgroundImage&&r.push(this.getBackGroundImageUrl(e.style.backgroundImage)),[].concat(z()(o),z()(s),z()(p)).forEach((function(e){e.style&&e.style.backgroundImage&&r.push(t.getBackGroundImageUrl(e.style.backgroundImage)),e.estyle&&e.estyle.backgroundImage&&r.push(t.getBackGroundImageUrl(e.estyle.backgroundImage)),e.layers&&e.layers.forEach((function(e){"h5ds_img"===e.pid?r.push(e.data.src):"h5ds_combin"===e.pid?e.layers.forEach((function(e){"h5ds_img"===e.pid&&r.push(e.data.src)})):n.loadSound&&"h5ds_sound"===e.pid&&r.push(e.data.sound)}))})),Array.from(new Set(r))}},{key:"uniq",value:function(e,t){return X()(e,t)}},{key:"cloneDeep",value:function(e){return W()(e)}},{key:"toJS",value:function(e){return JSON.parse(JSON.stringify(e))}},{key:"debounce",value:function(e,t){return V()(e,t)}},{key:"throttle",value:function(e,t){return J()(e,t)}},{key:"escape",value:function(e){try{var t=U()(e)?JSON.stringify(e):e;return window.escape(t)}catch(e){return""}}},{key:"setStorage",value:function(e,t){"string"==typeof t?window.localStorage.setItem(e,t):window.localStorage.setItem(e,JSON.stringify(t))}},{key:"getStorage",value:function(e){var t=window.localStorage.getItem(e);try{return JSON.parse(t)}catch(e){return t}}},{key:"clearStorage",value:function(e){e?window.localStorage.removeItem(e):window.localStorage.clear()}},{key:"setSession",value:function(e,t){"string"==typeof t?window.sessionStorage.setItem(e,t):window.sessionStorage.setItem(e,JSON.stringify(t))}},{key:"getSession",value:function(e){var t=window.sessionStorage.getItem(e);try{return JSON.parse(t)}catch(e){return t}}},{key:"clearSession",value:function(e){e?window.sessionStorage.removeItem(e):window.sessionStorage.clear()}},{key:"toFixed",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return e?(e=parseFloat(e),e=parseFloat(e.toFixed(t))):e=0,e}},{key:"exchageArrayElem",value:function(e,t,n){var r=[e[t],e[n]];e[n]=r[0],e[t]=r[1]}},{key:"removeArrayElement",value:function(e,t){var n=e.indexOf(t);return n>=0&&e.splice(n,1),this.cloneDeep(e)}},{key:"plus",value:function(e,t){return+(e+t).toFixed(10)}},{key:"minus",value:function(e,t){return+(e-t).toFixed(10)}},{key:"formatDate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"datetime";return B()(e).format(K[t]||t)}},{key:"randomNumber",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return Math.min(Math.floor(e+Math.random()*(t-e)),t)}},{key:"randomColor",value:function(){return"#"+("00000"+(16777216*Math.random()<<0).toString(16)).slice(-6)}},{key:"randomID",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;return Number(Math.random().toString().substr(3,e)+Date.now()).toString(36)}},{key:"getBase64",value:function(e,t){var n=this,r=t.width,a=t.height,o=t.x,i=t.y;return new Promise((function(t,s){var c=new Image;c.crossOrigin="Anonymous",c.onload=function(){var e=$('<canvas width="'+r+'" height="'+a+'"></canvas>')[0];e.getContext("2d").drawImage(c,o,i,r,a,0,0,r,a),t(e.toDataURL())},c.onerror=function(e){console.error("图片转base64失败！"),s(e)},c.src=e+"?t="+n.randomID()}))}},{key:"arrayToObject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={};return e.forEach((function(e){Object.keys(e).forEach((function(r){var a=e[r];!t&&n.hasOwnProperty(r)||(n[r]=a)}))})),n}},{key:"isEmpty",value:function(e){return null==e||""===e}},{key:"getBackGroundImageUrl",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(e=e.replace(/url\((.*)\)/,"$1")).replace(/["']/g,"")}},{key:"imgLazy",value:function(e){return new Promise((function(t,n){var r=new Image;r.src=e,r.onload=function(){t(r)},r.onerror=function(){console.error("图片加载失败",null),n(null)}}))}},{key:"compile",value:function(e){for(var t=String.fromCharCode(e.charCodeAt(0)+e.length),n=1;n<e.length;n++)t+=String.fromCharCode(e.charCodeAt(n)+e.charCodeAt(n-1));return escape(t)}},{key:"uncompile",value:function(e){e=unescape(e);for(var t=String.fromCharCode(e.charCodeAt(0)-e.length),n=1;n<e.length;n++)t+=String.fromCharCode(e.charCodeAt(n)-t.charCodeAt(n-1));return t}},{key:"saveShareContent",value:function(e,t){var n=document.createElement("a");n.download=t;var r=new Blob([e]);n.href=URL.createObjectURL(r),document.body.appendChild(n),n.click(),document.body.removeChild(n)}},{key:"fullScreen",value:function(){var e=document.documentElement;e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()}},{key:"exitFullscreen",value:function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}}]),e}());function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){C()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var te=_();$.fn.control=function(e){var t=$(this),n=$.extend({lockWideHigh:!1,setHeight:!0,setWidth:!0,movex:!0,movey:!0,autosize:!0,fixedsize:!0,scale:1,rotate:!0},e);n.scale=$(".app-js-canvas").transform("scale")||1;var r='<div class="app-control">\n\t\t\t\t\t{{rotate}}\n\t\t\t\t\t{{autosize}}\n\t\t\t\t\t{{fixedsize}}\n\t\t\t\t\t<span class="app-control-center"></span>\n\t\t\t\t</div>';r=n.rotate?r.replace("{{rotate}}",'<span class="app-control-rotate"></span>'):r.replace("{{rotate}}",""),r=n.autosize?r.replace("{{autosize}}","".concat(n.setHeight?'<span style="display: '.concat(n.lockWideHigh?"none":"block",'" class="app-control-top"></span>'):"","\n\t\t\t\t\t").concat(n.setWidth?'<span style="display: '.concat(n.lockWideHigh?"none":"block",'" class="app-control-left"></span>'):"","\n\t\t\t\t\t").concat(n.setWidth?'<span style="display: '.concat(n.lockWideHigh?"none":"block",'" class="app-control-right"></span>'):"","\n\t\t\t\t\t").concat(n.setHeight?'<span style="display: '.concat(n.lockWideHigh?"none":"block",'" class="app-control-bottom"></span>'):"")):r.replace("{{autosize}}",""),r=n.fixedsize?r.replace("{{fixedsize}}",'<span class="app-control-topleft"></span>\n\t\t\t\t\t<span class="app-control-topright"></span>\n\t\t\t\t\t<span class="app-control-bottomleft"></span>\n\t\t\t\t\t<span class="app-control-bottomright"></span>'):r.replace("{{fixedsize}}","");var a=t.find(".app-control");a[0]&&(a.remove(),a=null),t.append(r);var o=function(e,r,a){var o={x:e.pageX,y:e.pageY},i=$(r).parent(),s={width:i[0].offsetWidth,height:i[0].offsetHeight,left:i[0].offsetLeft,top:i[0].offsetTop,offsetLeft:i.offset().left,offsetTop:i.offset().top};t.trigger("controlStart",ee({},s));var c=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=A()(e,2),a=r[0],o=r[1],i=A()(t,2),s=i[0],c=i[1],p=a-s,l=o-c;return Math.sqrt(p*p+l*l)*n},p=c([s.offsetLeft,s.offsetTop],[s.width+s.offsetLeft,s.height+s.offsetTop],n.scale),l=c([s.offsetLeft,s.offsetTop],[s.width+s.offsetLeft,s.height+s.offsetTop]);$(document).on("".concat(te.move,".control_resize"),(function(e){te.touch&&(e=te.touchEvent(e));var r=e.pageX-o.x,u=e.pageY-o.y,h=s.height,d=s.width,f=s.top,y=s.left,m=s.offsetLeft,v=s.offsetTop,g=d,b=h,w=f,k=y,E=0;switch(a){case"top":E=c([e.pageX,e.pageY],[o.x,o.y]),u>0&&(E=-E),b=h+(E/=n.scale),w=f-E;break;case"left":E=c([e.pageX,e.pageY],[o.x,o.y]),r>0&&(E=-E),g=d+(E/=n.scale),k=y-E;break;case"right":E=c([e.pageX,e.pageY],[o.x,o.y]),r<0&&(E=-E),g=d+(E/=n.scale);break;case"bottom":E=c([e.pageX,e.pageY],[o.x,o.y]),u<0&&(E=-E),b=h+(E/=n.scale);break;case"topleft":E=c([e.pageX,e.pageY],[d+m,h+v],n.scale),E-=p,E/=n.scale,d>h?(k=y-E,w=f-((b=(g=d+E)/d*h)-h)):(w=f-E,k=y-((g=(b=h+E)/h*d)-d));break;case"bottomleft":E=c([e.pageX,e.pageY],[d+m,v]),E-=l,E/=n.scale,d>h?(b=(g=d+E)/d*h,k=y-E):k=y-((g=(b=h+E)/h*d)-d);break;case"topright":E=c([e.pageX,e.pageY],[m,h+v]),E-=p,E/=n.scale,d>h?w=f-((b=(g=d+E)/d*h)-h):(g=(b=h+E)/h*d,w=f-E);break;case"bottomright":E=c([e.pageX,e.pageY],[m,v]),E-=p,E/=n.scale,d>h?b=(g=d+E)/d*h:g=(b=h+E)/h*d}g<0||b<0||(i.css({width:g,height:b,top:w,left:k}),t.trigger("controlResizeTick",{width:g,height:b,top:w,left:k}))})).on("".concat(te.end,".control_resize"),(function(){$(document).off("".concat(te.move,".control_resize ").concat(te.end,".control_resize"));var e=i[0],n=e.offsetWidth,r=e.offsetHeight,a=e.offsetLeft,o=e.offsetTop,s={height:parseInt(r,10),width:parseInt(n,10),top:parseInt(o,10),left:parseInt(a,10)};t.trigger("controlEnd",ee({},s)),t.trigger("change",ee({},s))}))};return this.distory=function(){$(".app-control").remove()},$(document).off("".concat(te.start,".control")).on("".concat(te.start,".control"),".app-control",(function(e){switch(e.stopPropagation(),te.touch?e=te.touchEvent(e):e.preventDefault(),n.scale=parseFloat($(".app-canvas-box").transform("scale"))||1,e.target.className){case"app-control":!function(e,r){var a,o,i=e.pageX,s=e.pageY,c=$(r).parent(),p=n.scale,l=(c.width(),c.height(),parseInt(c.css("left"),10)*p),u=parseInt(c.css("top"),10)*p,h=null,d=$(".app-js-grid");d[0]&&(a="true"===d.attr("data-adsorb"),o=parseInt(d.attr("data-size"),10)),N.publish("h5ds.control.absorb.start"),$(document).on("".concat(te.move,".control_move"),(function(e){e.stopPropagation(),te.touch&&(e=te.touchEvent(e)),h={left:parseInt((l+(e.pageX-i))/p,10),top:parseInt((u+(e.pageY-s))/p,10)},n.movex||delete h.left,n.movey||delete h.top,a&&o?(h.left&&(h.left=Math.round(h.left/o,10)*o),h.top&&(h.top=Math.round(h.top/o,10)*o),c.css(h)):(c.css(h),N.publish("h5ds.control.absorb.move"))})).on("".concat(te.end,".control_move"),(function(e){te.touch&&(e=te.touchEvent(e)),c=$(r).parent(),h={left:parseFloat(c.css("left")),top:parseFloat(c.css("top"))},$(document).off("".concat(te.move,".control_move ").concat(te.end,".control_move")),t.trigger("change",h),N.publish("h5ds.control.absorb.end",h),h=null}))}(e,this);break;case"app-control-rotate":r=this,a=$(r).find(".app-control-center"),i=$(r).parent(),s=parseInt(a.offset().left,10),c=parseInt(a.offset().top,10),p=180/Math.PI,l=null,$(document).on("".concat(te.move,".control_rotate"),(function(e){te.touch&&(e=e.originalEvent.targetTouches[0]);var t=e.pageX-s,n=c-e.pageY;l=Math.atan(t/n),l*=p,l=parseInt(l,10),t>=0&&n>=0||(t>=0&&n<0?l=180-(l=Math.abs(l)):l+=t<0&&n>=0?360:180),i.transform({rotate:"".concat(Q.toFixed(l,1),"deg")})})).on("".concat(te.end,".control_rotate"),(function(e){e.stopPropagation(),$(document).off("".concat(te.move,".control_rotate ").concat(te.end,".control_rotate")),t.trigger("change",{value:Q.toFixed(l,1),rotate:Q.toFixed(l,1)+"deg",transform:"rotate(".concat(Q.toFixed(l,1),"deg)")}),l=null}));break;case"app-control-top":o(e,this,"top");break;case"app-control-topleft":o(e,this,"topleft");break;case"app-control-topright":o(e,this,"topright");break;case"app-control-bottom":o(e,this,"bottom");break;case"app-control-bottomleft":o(e,this,"bottomleft");break;case"app-control-bottomright":o(e,this,"bottomright");break;case"app-control-left":o(e,this,"left");break;case"app-control-right":o(e,this,"right")}var r,a,i,s,c,p,l})),this};var ne=_();$(document).on("".concat(ne.start,".drag"),".app-drag",(function(e){ne.touch&&(e=ne.touchEvent(e));var t=e.pageX,n=e.pageY,r=$(this),a=r.offset().left,o=r.offset().top,i={limit:!0,undrag:[]},s=r.attr("data-dragset");if(s=s?JSON.parse(s):{},0!=(i=$.extend(i,s)).undrag.length)for(var c=0;c<i.undrag.length;c++)if($(e.target).closest(i.undrag[c])[0])return;if(i.limit)var p=r.width(),l=r.height(),u=r.parent().offset().left,h=r.parent().offset().top,d=r.parent().width(),f=r.parent().height();$(document).on("".concat(ne.move,".drag"),(function(e){ne.touch&&(e=ne.touchEvent(e));var s=a+(e.pageX-t),c=o+(e.pageY-n);i.limit&&(s<u?s=u:s>d-p&&(s=d-p),c<h?c=h:c>f-l&&(c=f-l)),r.css({left:s,top:c})})).on("".concat(ne.end,".drag"),(function(){$(document).off("".concat(ne.move,".drag ").concat(ne.end,".drag"))}))}));n(342),n(343);var re=new(function(){function e(){m()(this,e)}return g()(e,[{key:"getTransform",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=A()(e,2),n=t[0],r=t[1],a=Math.sqrt(n*n+r*r),o=this.getRotate(e);return{x:parseFloat(e[4]),y:parseFloat(e[5]),translate:[parseFloat(e[4]),parseFloat(e[5])],scale:a,rotate:o}}},{key:"getRotate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=A()(e,2),n=t[0],r=t[1],a=Math.round(Math.atan2(r,n)*(180/Math.PI));return a>360?a%=360:a<0&&(a+=360),a}},{key:"setRotate",value:function(e,t){e-=this.getAngle(t);var n=[Math.cos(e),Math.sin(e),-Math.sin(e),Math.cos(e),0,0];return this.concat(t,n)}},{key:"setScale",value:function(e,t,n){var r=[e,0,0,t=t||e,0,0];return this.concat(n,r)}},{key:"setTranslate",value:function(e,t,n){return this.concat(n,[1,0,0,1,e,t])}},{key:"getAngle",value:function(e){return Math.atan2(e[1],e[0])}},{key:"concat",value:function(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}},{key:"setTransform",value:function(e,t){e=this.testjQuery(e);var n=this.convertMatrixToArray(e);if(t.rotate&&(n=this.setRotate(parseFloat(t.rotate)/180*Math.PI,n)),t.translate){var r=t.translate.replace(/\s|px/g,"").split(","),a=A()(r,2),o=a[0],i=a[1];n=this.translate(parseFloat(o),parseFloat(i),n)}return t.scale&&(n=this.translate(parseFloat(t.scale),parseFloat(t.scale),n)),this.getTransform(z()(n))}},{key:"getTranslate",value:function(e,t){var n;e=this.testjQuery(e);var r=this.convertMatrixToArray(e),a=parseFloat(r[5]),o=parseFloat(r[4]);return"Y"===t&&(n=a),"X"===t&&(n=o),void 0===t&&(n=[o,a]),n}},{key:"getScale",value:function(e,t){var n;e=this.testjQuery(e);var r=this.convertMatrixToArray(e),a=parseFloat(r[3]),o=parseFloat(r[0]);return"Y"===t&&(n=a),"X"===t&&(n=o),void 0===t&&(n=[o,a]),n}},{key:"convertMatrixToArray",value:function(e){e=this.testjQuery(e);var t=window.getComputedStyle(e,null),n=t.getPropertyValue("-webkit-transform")||t.getPropertyValue("-moz-transform")||t.getPropertyValue("-ms-transform")||t.getPropertyValue("-o-transform")||t.getPropertyValue("transform")||null;return n=(n=String(n).replace("matrix(","").replace(")","").replace(" ","")).split(","),[parseFloat(n[0])||1,parseFloat(n[1])||0,parseFloat(n[2])||0,parseFloat(n[3])||1,parseFloat(n[4])||0,parseFloat(n[5])||0]}},{key:"testjQuery",value:function(e){return e instanceof jQuery&&(e=e[0]),e}},{key:"radiansToDeg",value:function(e){var t=180*e/Math.PI;return t=parseInt(t.toFixed(0),10)}}]),e}());$.fn.transform=function(e){var t=re.convertMatrixToArray(this);if("string"==typeof e)return(re.getTransform(t)||{})[e];var n=re.setTransform(this,e);$(this).css({transform:"translate(".concat(n.x,"px, ").concat(n.y,"px) scale(").concat(n.scale,") rotate(").concat(n.rotate,"deg)")})};var ae=n(26),oe=n.n(ae),ie=n(12),se=n.n(ie),ce=n(100),pe=n.n(ce),le=(n(345),n(41)),ue=n.n(le),he=n(114),de=n.n(he);function fe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"rgba(255,255,255,1)";if(e){var n=de()(e),r=n.getAlpha();e=n.setAlpha(r).toRgbString()}else e=t;return e}var ye=new(function(){function e(){m()(this,e)}return g()(e,[{key:"getBorder",value:function(e){if(e&&"none"!==e){var t=e.split(" ");return{size:parseInt(t[0],10),type:t[1],color:fe(e.replace(/.+(rgba.+)/,"$1"))}}return{size:null,type:null,color:null}}},{key:"setBorder",value:function(e,t){var n=this.getBorder(e),r=n.size,a=n.type,o=n.color;return Q.isEmpty(t.size)||(r=t.size),Q.isEmpty(t.type)||(a=t.type),Q.isEmpty(t.color)||(o=fe(t.color)),"".concat(r,"px ").concat(a," ").concat(o)}},{key:"getBoxshadow",value:function(e){var t=null,n=null;if(e&&"none"!==e){var r=e.split(" ");t=parseInt(r[2],10),n=fe(e.replace(/.+(rgba.+)/,"$1"))}return{size:t,color:n}}},{key:"setBoxshadow",value:function(e,t){var n=this.getBoxshadow(e),r=n.size,a=n.color;return Q.isEmpty(t.size)||(r=t.size),Q.isEmpty(t.color)||(a=fe(t.color)),"0 0 ".concat(r,"px ").concat(a)}},{key:"getAnimation",value:function(e){var t=null,n=null,r=null,a=null,o=null,i=null,s=null,c=null;if(e&&"none"!==e){var p=e.split(" ");t=p[0],n=Q.toFixed(p[1],1),r=p[2],a=Q.toFixed(p[3],1),o=isNaN(parseInt(p[4],10))?1/0:parseInt(p[4],10),i=p[5]||"normal",s=p[6]||"forwards",c=p[7]||"running"}return{name:t,duration:n,timing:r,delay:a,count:o,direction:i,fillMode:s,playState:c}}},{key:"setAnimation",value:function(e,t){var n=this.getAnimation(e),r=n.name,a=n.duration,o=n.timing,i=n.delay,s=n.count,c=n.direction,p=n.fillMode,l=n.playState;return Q.isEmpty(t.name)||(r=t.name),Q.isEmpty(t.duration)||(a=t.duration),Q.isEmpty(t.timing)||(o=t.timing),Q.isEmpty(t.delay)||(i=t.delay),Q.isEmpty(t.count)||(s=isNaN(parseInt(t.count,10))?1/0:parseInt(t.count,10)),Q.isEmpty(t.direction)||(c=t.direction),Q.isEmpty(t.fillMode)||(p=t.fillMode),Q.isEmpty(t.playState)||(l=t.playState),"".concat(r," ").concat(Q.toFixed(a,1),"s ").concat(o," ").concat(Q.toFixed(i,1),"s ").concat(s===1/0?"infinite":s," ").concat(c," ").concat(p," ").concat(l)}},{key:"getTransformVal",value:function(e,t){var n="";if(-1!==e.indexOf(t)){var r=RegExp(".*"+t+"\\((.+?)\\).*");n=e.replace(r,"$1")}if(""===(n=n.replace(/\s+/g,"")))switch(t){case"rotate":n=0;break;case"translate":n="0,0";break;case"scale":n="1,1";break;case"skew":n="0,0"}if("object"!==ue()(n))n=Q.toFixed(n,2);else{var a=n.split(","),o=A()(a,2),i=o[0],s=o[1];n=[parseFloat(i),parseFloat(s)]}return n}},{key:"getTransform",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=null,n=null,r=null,a=null;return e&&"none"!==e&&(t=this.getTransformVal(e,"rotate"),n=this.getTransformVal(e,"translate"),r=this.getTransformVal(e,"scale"),a=this.getTransformVal(e,"skew")),"number"==typeof r&&(r=[r,r]),{rotate:t||0,translate:n||[0,0],scale:r||[1,1],skew:a||[0,0]}}},{key:"setTransform",value:function(e,t){var n=this.getTransform(e),r=n.rotate,a=n.translate,o=n.scale,i=n.skew;Q.isEmpty(t.rotate)||(r=t.rotate),Q.isEmpty(t.translate)||(a=t.translate),Q.isEmpty(t.scale)||(o=t.scale),Q.isEmpty(t.skew)||(i=t.skew);var s=[];return Q.isEmpty(r)||s.push("rotate(".concat(r,"deg)")),Q.isEmpty(a)||s.push("translate(".concat(a.map((function(e){return e+"px"})).join(","),")")),Q.isEmpty(o)||s.push("scale(".concat(o.join(","),")")),Q.isEmpty(i)||s.push("skew(".concat(i.map((function(e){return e+"deg"})).join(","),")")),s.join(" ")}},{key:"resetTransform",value:function(e,t){try{var n=[];for(var r in t)n.push("".concat(r,"(").concat(t[r],")"));n=n.join(" "),e.css({"-webkit-transform":n,transform:n})}catch(e){console.error("function:addTransform error！",e)}}}]),e}()),me=function(){function e(t){m()(this,e),this.progress=null,t&&(this.manifest=this.setSource(t)),this.sources=t}return g()(e,[{key:"imgLazy",value:function(e){return new Promise((function(t,n){var r=new Image;r.src=e,r.onload=function(){t(r)},r.onerror=function(){console.error("图片加载失败",r),n(r)}}))}},{key:"soundLazy",value:function(e){return new Promise((function(t,n){var r=new Audio(e);r.onloadedmetadata=function(){t(r)},r.onerror=function(){console.error("sound加载失败",e),alert("音乐资源不存在！"),n(e)},r.src=e}))}},{key:"jsLazy",value:function(e,t){return new Promise((function(n,r){if(!t||!document.getElementById(t)){var a=document.createElement("script");a.type="text/javascript",a.charset="utf-8",a.async="async",a.id=t,a.src=e,document.head.appendChild(a),a.onload=function(){n(a)},a.onerror=function(){console.error("js加载失败",e),r(e)}}}))}},{key:"cssLazy",value:function(e,t){if(!e)return!1;if(!t||!document.getElementById(t)){var n=document.getElementsByTagName("head")[0],r=document.createElement("link");r.type="text/css",r.rel="stylesheet",r.id=t,r.href=e,n.appendChild(r)}}},{key:"load",value:function(){var e=this,t=this.manifest;return new Promise(function(){var n=f()(h.a.mark((function n(r,a){var o,i,s,c;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=[],i=[],s=h.a.mark((function n(r){var a,s,c,p;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:a=t[r],s=a.src,c=a.id,p=a.type,n.t0=p,n.next="image"===n.t0?4:"js"===n.t0?7:"sound"===n.t0?10:"css"===n.t0?13:15;break;case 4:return n.next=6,e.imgLazy(s).then((function(){i.push({src:s,id:c,type:p}),e.progress&&e.progress({src:s,id:c,type:p,success:!0,loaded:(r+1)/t.length})})).catch((function(){o.push({src:s,id:c,type:p}),e.progress&&e.progress({src:s,id:c,type:p,success:!1,loaded:(r+1)/t.length})}));case 6:return n.abrupt("break",15);case 7:return n.next=9,e.jsLazy(s,c).then((function(){i.push({src:s,id:c,type:p}),e.progress&&e.progress({src:s,id:c,type:p,success:!0,loaded:(r+1)/t.length})})).catch((function(){o.push({src:s,id:c,type:p}),e.progress&&e.progress({src:s,id:c,type:p,success:!1,loaded:(r+1)/t.length})}));case 9:return n.abrupt("break",15);case 10:return n.next=12,e.soundLazy(s).then((function(){i.push({src:s,id:c,type:p}),e.progress&&e.progress({src:s,id:c,type:p,success:!0,loaded:(r+1)/t.length})})).catch((function(){o.push({src:s,id:c,type:p}),e.progress&&e.progress({src:s,id:c,type:p,success:!1,loaded:(r+1)/t.length})}));case 12:return n.abrupt("break",15);case 13:return e.cssLazy(s,c),n.abrupt("break",15);case 15:case"end":return n.stop()}}),n)})),c=0;case 4:if(!(c<t.length)){n.next=9;break}return n.delegateYield(s(c),"t0",6);case 6:c++,n.next=4;break;case 9:e.complete&&e.complete({error:o,success:i}),i.length===t.length?(e.success&&e.success(),r({error:o,success:i})):(e.error&&e.error(),a({error:o,success:i}));case 11:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())}},{key:"on",value:function(e,t){switch(e){case"progress":this.progress=t;break;case"error":this.error=t;break;case"complete":this.complete=t;break;case"success":this.success=t}}},{key:"setSource",value:function(e){if(e){var t=e.map((function(e,t){var n="*",r=e.replace(/.+\.(.+)/,"$1");return-1!==["jpg","gif","png","jpeg"].indexOf(r)?n="image":-1!==["mp3","wav","ogg","acc","webm"].indexOf(r)?n="sound":-1!==["js","es"].indexOf(r)?n="js":-1!==["css"].indexOf(r)&&(n="css"),{src:e,id:"source_"+t,type:n}}));return this.manifest=t,t}}}]),e}(),ve=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{tips:"loading",zIndex:3e3},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.querySelector("body");m()(this,e),this.set=t,this.id="winLoad_"+Q.randomID(),this.target=n,this.render()}return g()(e,[{key:"show",value:function(){document.querySelector("#".concat(this.id)).style.display="block"}},{key:"hide",value:function(){document.querySelector("#".concat(this.id)).style.display="none"}},{key:"destroy",value:function(){var e=document.querySelector("#".concat(this.id));document.body.removeChild(e)}},{key:"render",value:function(){var e=document.createElement("div");e.className="app-win-loading",e.id=this.id;var t=document.createElement("div");t.className="app-win-loading-inner",t.innerHTML=this.set.tips,e.appendChild(t),this.target.appendChild(e)}}]),e}(),ge=new(function(){function e(){m()(this,e)}return g()(e,[{key:"getPid",value:function(e,t){var n=this;e&&e.forEach((function(e){t.push(e.pid),"h5ds_combin"===e.pid&&n.getPid(e.data,t)}))}},{key:"getPidByPageData",value:function(e){var t=[];return this.getPid(e.layers,t),t=(t=Array.from(new Set(t))).filter((function(e){return!["h5ds_combin","h5ds_img","h5ds_shape","h5ds_sound","h5ds_text"].includes(e)}))}},{key:"getPidByData",value:function(e){var t=this,n=[],r=e.pages,a=void 0===r?[]:r,o=e.fixeds,i=void 0===o?[]:o,s=e.popups,c=void 0===s?[]:s;return[].concat(z()(a),z()(i),z()(c)).forEach((function(e){t.getPid(e.layers,n)})),n=(n=Array.from(new Set(n))).filter((function(e){return!["h5ds_combin","h5ds_img","h5ds_shape","h5ds_sound","h5ds_text"].includes(e)}))}}]),e}());new(function(){function e(){m()(this,e)}return g()(e,[{key:"getBezierPoints",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,o=null,i=[];r||a?r&&!a?o=this.twoBezier:r&&a&&(o=this.threeBezier):o=this.oneBezier;for(var s=0;s<e;s++)i.push(o(s/e,t,n,r,a));return a?i.push(z()(a)):r&&i.push(z()(r)),i}},{key:"oneBezier",value:function(e,t,n){var r=A()(t,2),a=r[0],o=r[1],i=A()(n,2);return[a+(i[0]-a)*e,o+(i[1]-o)*e]}},{key:"twoBezier",value:function(e,t,n,r){var a=A()(t,2),o=a[0],i=a[1],s=A()(n,2),c=s[0],p=s[1],l=A()(r,2);return[(1-e)*(1-e)*o+2*e*(1-e)*c+e*e*l[0],(1-e)*(1-e)*i+2*e*(1-e)*p+e*e*l[1]]}},{key:"threeBezier",value:function(e,t,n,r,a){var o=A()(t,2),i=o[0],s=o[1],c=A()(a,2),p=c[0],l=c[1],u=A()(n,2),h=u[0],d=u[1],f=A()(r,2);return[i*(1-e)*(1-e)*(1-e)+3*h*e*(1-e)*(1-e)+3*f[0]*e*e*(1-e)+p*e*e*e,s*(1-e)*(1-e)*(1-e)+3*d*e*(1-e)*(1-e)+3*f[1]*e*e*(1-e)+l*e*e*e]}}]),e}());function be(e,t,n){return{configurable:!0,get:function(){var e=n.value.bind(this);return Object.defineProperty(this,t,{value:e,configurable:!0,writable:!0}),e}}}new(function(){function e(){m()(this,e)}return g()(e,[{key:"rectParam",value:function(e){if(e[0]){var t=e.transform("rotate"),n=e.width(),r=e.height(),a=parseFloat(e.css("left")),o=parseFloat(e.css("top")),i={left:a+n/2,top:o+r/2};return 0===t?{rotate:t,top:o,left:a,boxWidth:n,boxHeight:r,width:n,height:r,center:i}:this._hasRotate(t,n,r,i)}}},{key:"rectParamObj",value:function(e){var t=0,n=e.style;n.transform&&(t=ye.getTransformVal(n.transform,"rotate"));var r=n.width||0,a=n.height||0,o=n.left||0,i=n.top||0,s={left:o+r/2,top:i+a/2};return 0==t?{rotate:t,top:i,left:o,boxWidth:r,boxHeight:a,width:r,height:a,center:s}:this._hasRotate(t,r,a,s)}},{key:"_hasRotate",value:function(e,t,n,r){var a=e%90*(Math.PI/180),o=Math.atan(n/t),i=Math.sqrt(n/2*(n/2)+t/2*(t/2)),s=i*Math.cos(Math.PI/2-(a+o))*2,c=i*Math.cos(a-o)*2;return{rotate:e,top:r.top-c/2,left:r.left-s/2,boxWidth:s,boxHeight:c,width:t,height:n,center:r}}}]),e}());var we,ke=n(25),Ee=n(1);function Oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}we=function(e){w()(n,e);var t=Oe(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).state={layer:Object(Ee.toJS)(e.layer)},r.eventId=Q.randomID(),r}return g()(n,[{key:"getEditor",value:function(e){return this.props.scope.pluginsKey[e.pid]||{}}},{key:"render",value:function(){var e=this,t=this.props,n=t.layer,r=pe()(t,["layer"]),a=ke.Collapse.Panel;return D.a.createElement("div",{className:"app-ex-h5ds_combin"},D.a.createElement("div",{className:"app-ex-h5ds_combin-set"},D.a.createElement("div",{className:"app-ex-h5ds_combin-titles"},"修改合并图层中的子图层"),D.a.createElement(ke.Collapse,{accordion:!0},n.data.map((function(t,n){var o=e.getEditor(t),i=o.Editor,s=o.name;return D.a.createElement(a,{header:s+"图层设置",key:n},i?D.a.createElement(i,oe()({layer:t},r)):null)})))))}}]),n}(x.Component),se()(we.prototype,"getEditor",[be],Object.getOwnPropertyDescriptor(we.prototype,"getEditor"),we.prototype),n(347),n(349);var Se={appType:"phone",version:"5.0.0",appWidth:320,appHeight:514,canvasScale:1},xe=function(e){switch(Se.appType=e,e){case"phone":Se.appWidth=320,Se.appHeight=514;break;case"pc":Se.appWidth=800,Se.appHeight=600;break;case"ppt":Se.appWidth=1280,Se.appHeight=720,Se.canvasScale=(window.innerWidth-700)/1280;break;case"horizontal-phone":Se.appWidth=514,Se.appHeight=320}},De=function e(){m()(this,e),this.id=null,this.className=null,this.keyid=Q.randomID(),this.name="未命名",this.desc="页面描述",this.style={height:Se.appHeight,width:Se.appWidth},this.layers=[],this.animate=[],this.slider={autoplay:!1,lock:!1,time:5}};function Pe(){var e=Se.appType,t=Se.appWidth,n=Se.appHeight;return{version:Se.version,img:"http://cdn.h5ds.cn/static/images/img-null.png",desc:"点石H5，官方网站h5ds.cn",name:"点石H5",type:e,slider:{speed:.5,effect:"slide",autoplay:!1,time:5},style:{width:t,height:n},fixeds:[{id:null,className:null,keyid:Q.randomID(),name:"浮动层上",style:{height:n,width:t},layers:[]},{id:null,className:null,keyid:Q.randomID(),name:"浮动层下",style:{height:n,width:t},layers:[]}],popups:[],pages:[{id:null,className:null,keyid:Q.randomID(),name:"空白页面",desc:"页面描述",style:{width:t,height:n},layers:[],slider:{animate:1,autoplay:!1,lock:!1,time:5}}]}}var je={RENDER_IN_PAGELIST:"render_in_pagelist",RENDER_IN_TEMPLATES:"render_in_templates",RENDER_IN_CANVAS:"render_in_canvas",RENDER_IN_PREVIEW:"render_in_preview",RENDER_IN_INDEPENDENT:"render_in_independent",RENDER_IN_PUBLISH:"render_in_publish"};function Ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ce(Object(n),!0).forEach((function(t){C()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var Ne=function(e){w()(n,e);var t=Ie(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).outAnimateDo=function(){e.layerBoxRef&&(e.settime=setTimeout((function(){e.layerBoxRef.style.display="none",setTimeout((function(){e.layerBoxRef.style.display="block"}))}),200))},e.onClick=function(t){if(t.stopPropagation(),[je.RENDER_IN_PREVIEW,je.RENDER_IN_PUBLISH].includes(e.props.renderIn)){var n=e.props.layer.events,r=function(t,n){var r=n.value;(r=r.split(",").filter((function(e){return e}))).forEach((function(n){if(t.keyid===n){var r=null;r=e.props.renderIn===je.RENDER_IN_PREVIEW?document.querySelector('.app-preview [data-keyid="'.concat(n,'"]')):document.querySelector('[data-keyid="'.concat(n,'"]'));var a=window.getComputedStyle(r).display;r.style.display="none"===a?"block":"none"}}))};(void 0===n?[]:n).forEach((function(t){var n=t.eventId,a=t.eventParam;switch(n){case"h5ds_event_topage":window.pubSubLayer.publish("h5ds.layerEvent.topage",a);break;case"h5ds_event_click":switch(a.eventName){case"h5ds_show_modal":e.props.appData?e.props.appData.popups.forEach((function(e){r(e,a)})):alert("单独使用Layer或者Page无需传入appData，弹窗事件无效！");break;case"h5ds_show_hide_layer":e.props.appData?e.props.pageData.layers.forEach((function(e){r(e,a)})):alert("单独使用Layer无需传入pageData，隐藏页面中的其他元素事件无效！");break;case"h5ds_custom_event_name":window.pubSubLayer.publish(a.value,a)}break;case"h5ds_event_link":location.href=a.value}}))}},e}return g()(n,[{key:"setAdsorb",value:function(e,t,n,r){if(![je.RENDER_IN_PREVIEW,je.RENDER_IN_PUBLISH].includes(this.props.renderIn))return{top:t,left:n};if(!r)return{top:t,left:n};var a=r.adsorbTopBottom,o=void 0===a?0:a,i=r.adsorbLeftRight,s=void 0===i?0:i,c=r.scale,p=void 0===c?1:c;switch(o/=p,s/=p,e){case"top-left":t-=o,n-=s;break;case"top-center":t-=o;break;case"top-right":t-=o,n+=s;break;case"left-center":n+=s;break;case"right-center":n-=s;break;case"bottom-left":t+=o,n-=s;break;case"bottom-center":t+=o;break;case"bottom-right":t+=o,n+=s}return{top:t,left:n}}},{key:"componentWillUnmount",value:function(){this.settime&&clearTimeout(this.settime)}},{key:"render",value:function(){var e=this,t=this.props,n=t.layer,r=t.zIndex,a=t.children,o=t.adsorbSet,i=t.initControl,s=["layer"],c=n.style,p=c.top,l=c.left,u=pe()(c,["top","left"]),h=this.setAdsorb(n.adsorb,p,l,o),d=Re({zIndex:r,top:h.top,left:h.left},u);s.push("layer-".concat(n.pid)),n.className&&s.push(n.className),n.set&&n.set.hide&&s.push("layer-temporary-hide"),n.set&&n.set.lock&&s.push("layer-temporary-lock"),n.set&&n.set.noEvent&&s.push("layer-temporary-noevent");var f=Re({},n.estyle)||{},y=[],m=null;switch(n.animate&&n.animate.length>0&&n.animate.forEach((function(e,t){0===t&&(m=e.type),y.push(e.style)})),"h5ds_text"===n.pid&&n.data.animate&&Object.assign(d,Re({},this.props.style)),m){case"in":Object.assign(d,Re({},this.props.style)),Object.assign(f,{opacity:0});break;case"out":this.outAnimateDo()}var v=this.onClick;return i&&(v=function(e){i(9999-r,e)}),D.a.createElement("div",{id:n.id,ref:function(t){return e.layerBoxRef=t},key:n.keyid,"data-keyid":n.keyid,onClick:v,className:s.join(" "),style:d},D.a.createElement("div",{ref:function(t){return e.layerRef=t},className:"element",style:Re({WebkitAnimation:y.join(","),animation:y.join(",")},f)},D.a.createElement("div",{style:{transform:d.flip?"scale(".concat(d.flip.join(","),")"):"scale(1,1)"},className:"element-flip"},a)))}}]),n}(x.Component);function Le(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var Ae=function(e){w()(n,e);var t=Le(n);function n(){return m()(this,n),t.apply(this,arguments)}return g()(n,[{key:"setAdsorb",value:function(e,t,n,r){if(!r)return{};var a=r.adsorbTopBottom,o=void 0===a?0:a,i=r.adsorbLeftRight,s=void 0===i?0:i,c=r.scale,p=void 0===c?1:c;switch(o/=p,s/=p,e){case"top-left":t-=o,n-=s;break;case"top-center":t-=o;break;case"top-right":t-=o,n+=s;break;case"left-center":n+=s;break;case"right-center":n-=s;break;case"bottom-left":t+=o,n-=s;break;case"bottom-center":t+=o;break;case"bottom-right":t+=o,n+=s}return{top:t,left:n}}},{key:"render",value:function(){if("page"!==this.props.pageType)return null;this.setAdsorb("bottom-left",this.props.height-20,0,this.props.adsorbSet);return""}}]),n}(x.Component);function _e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_e(Object(n),!0).forEach((function(t){C()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_e(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ze(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var He=function(e){w()(n,e);var t=ze(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).autoplay=function(){if(!r.props.data)return!1;var e=r.props.data.slider;e&&e.autoplay&&(r.timer=setTimeout((function(){window.swiperInstance&&window.swiperInstance.slideNext()}),1e3*e.time))},r.updateSwiper=function(){r.swiperLangPage&&r.swiperLangPage.scrollbar.updateSize()},r.pageType="page",r}return g()(n,[{key:"componentDidMount",value:function(){if(this.props.isRenderThis&&this.autoplay(),this.props.isLangPage){this.props.scrollSet<0?window.initialSlide=0:this.props.scrollSet>0&&(window.initialSlide=9999);var e=this.props.keyid;this.swiperLangPage=new Swiper("#".concat(e),{touchMoveStopPropagation:!1,direction:"vertical",slidesPerView:"auto",roundLengths:!0,nested:!0,resistanceRatio:0,freeMode:!0,scrollbar:{el:".".concat(e,"_swiper-scrollbar")},initialSlide:window.initialSlide||0,mousewheel:!0})}}},{key:"componentDidUpdate",value:function(){this.props.isRenderThis&&this.autoplay()}},{key:"componentWillUnmount",value:function(){this.timer&&clearTimeout(this.timer),this.swiperLangPage&&(this.swiperLangPage.off("touchMove"),this.swiperLangPage.destroy())}},{key:"render",value:function(){var e=this,t=this.props,n=t.data,r=t.plugins,a=t.adsorbSet,o=t.initControl,i=t.isLangPage,s=t.appData,c=void 0===s?null:s,p=this.props.isRenderThis;if(void 0===p&&(p=!0),this.props.index,!n)return console.warn("pages/Page.js error, data is not null"),null;var l=r.pluginsKey,u=n.layers,h=void 0===u?[]:u,d=n.style,f=void 0===d?{}:d,y=null;if([je.RENDER_IN_INDEPENDENT,je.RENDER_IN_PAGELIST].includes(this.props.renderIn))y=f;else{f.backgroundColor;var m=f.backgroundGlobal,v=pe()(f,["backgroundColor","backgroundGlobal"]);if(m){v.backgroundImage,v.backgroundSize,v.backgroundRepeat;y=pe()(v,["backgroundImage","backgroundSize","backgroundRepeat"])}else y=v}return D.a.createElement("div",{className:"app-swiper-layers-box ".concat(i?"swiper-wrapper":"")},D.a.createElement("div",{ref:function(t){return e.swiperPageRef=t},className:"app-swiper-layers ".concat(i?"swiper-slide":""),style:Te({},y)},h.map((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0,s=t,u=s.pid,h=s.leavePageUnmount,d=void 0!==h&&h,f=s.name,y=l[u],m=y?y.LayerComp:null;return d&&!p||i>30&&je.RENDER_IN_PAGELIST===e.props.renderIn?null:(je.RENDER_IN_CANVAS===e.props.renderIn&&(t=JSON.parse(JSON.stringify(t))),D.a.createElement(Ne,{style:{display:p?"block":"none"},appData:c,isRenderThis:p,pageData:n,renderIn:e.props.renderIn,initControl:o,layer:t,adsorbSet:a,zIndex:9999-i,key:t.keyid},m?D.a.createElement(m,{appData:c,pageData:n,isRender:p,renderIn:e.props.renderIn,layer:t,plugins:r}):D.a.createElement("div",{className:"layer-null"},"请载入",f,":",u,"插件",D.a.createElement("span",{style:{display:"none"}},JSON.stringify(t)))))})),"h5ds_combin"===n.type?null:D.a.createElement(Ae,{height:n.style.height,renderIn:this.props.renderIn,adsorbSet:a,pageType:this.pageType})))}}]),n}(x.Component);function $e(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var We=function(e){w()(n,e);var t=$e(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).pageType="fixed",r}return n}(He);function Me(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var Be=function(e){w()(n,e);var t=Me(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).pageType="popup",r}return n}(He),Fe={name:"合并图层",pid:"h5ds_combin",version:"1.0.0"};function Ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ve(Object(n),!0).forEach((function(t){C()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var Ye=function(e){w()(n,e);var t=Ue(n);function n(){return m()(this,n),t.apply(this,arguments)}return g()(n,[{key:"render",value:function(){var e=this.props,t=e.layer,n=e.renderIn,r=e.plugins,a=this.props.isRender;void 0===a&&(a=!0);var o=t.originstyle,i=t.style,s=void 0===i?{}:i,c=Ge(Ge({},o),{},{transform:"scale(".concat(s.width/o.width,", ").concat(s.height/o.height,")")}),p={layers:t.data,style:{},type:"h5ds_combin"};return D.a.createElement("div",{className:"layer-h5ds_combin",style:Ge({},c)},t?D.a.createElement(He,{isRenderThis:a,data:p,plugins:r,renderIn:n}):null)}}]),n}(x.Component);n(351),n(353);function Je(e,t,n){return{configurable:!0,get:function(){var e=n.value.bind(this);return Object.defineProperty(this,t,{value:e,configurable:!0,writable:!0}),e}}}var qe=n(31),Xe=(new(n.n(qe).a.EventEmitter),n(7)),Ke=(Object(Xe.a)(),new(function(){function e(){m()(this,e),this.storage=localStorage}return g()(e,[{key:"get",value:function(e){var t=this.storage.getItem(e);try{t=JSON.parse(t)}catch(e){t=null}return t}},{key:"set",value:function(e,t){return this.storage.setItem(e,JSON.stringify(t))}},{key:"remove",value:function(e){return this.storage.removeItem(e)}},{key:"clear",value:function(){return this.storage.clear()}}]),e}()),n(17)),Qe={datetime:"YYYY/MM/DD HH:mm:ss",date:"YYYY/MM/DD",time:"HH:mm:ss"},Ze=new(function(){function e(){m()(this,e)}return g()(e,[{key:"isUrl",value:function(e){return/https?:\/\/[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/i.test(e)}},{key:"isPhoneNum",value:function(e){return/^(0|86|17951)?(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/.test(e)}},{key:"getUrlQuery",value:function(e){for(var t=window.location.search.substring(1).split("&"),n=0;n<t.length;n++){var r=t[n].split("=");if(r[0]==e)return r[1]}return!1}},{key:"getUrlData",value:function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),n=window.location.search.substr(1).match(t),r=null;return null!=n&&(r=unescape(n[2])),r}},{key:"uniq",value:function(e,t){return Object(Ke.uniq)(e,t)}},{key:"cloneDeep",value:function(e){return Object(Ke.cloneDeep)(e)}},{key:"toJS",value:function(e){return JSON.parse(JSON.stringify(e))}},{key:"debounce",value:function(e,t){return Object(Ke.debounce)(e,t)}},{key:"throttle",value:function(e,t){return Object(Ke.throttle)(e,t)}},{key:"escape",value:function(e){try{var t=Object(Ke.isObject)(e)?JSON.stringify(e):e;return window.escape(t)}catch(e){return""}}},{key:"setStorage",value:function(e,t){"string"==typeof t?window.localStorage.setItem(e,t):window.localStorage.setItem(e,JSON.stringify(t))}},{key:"getStorage",value:function(e){var t=window.localStorage.getItem(e);try{return JSON.parse(t)}catch(e){return t}}},{key:"clearStorage",value:function(e){e?window.localStorage.removeItem(e):window.localStorage.clear()}},{key:"setSession",value:function(e,t){"string"==typeof t?window.sessionStorage.setItem(e,t):window.sessionStorage.setItem(e,JSON.stringify(t))}},{key:"getSession",value:function(e){var t=window.sessionStorage.getItem(e);try{return JSON.parse(t)}catch(e){return t}}},{key:"clearSession",value:function(e){e?window.sessionStorage.removeItem(e):window.sessionStorage.clear()}},{key:"toFixed",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return e?(e=parseFloat(e),e=parseFloat(e.toFixed(t))):e=0,e}},{key:"exchageArrayElem",value:function(e,t,n){var r=[e[t],e[n]];e[n]=r[0],e[t]=r[1]}},{key:"removeArrayElement",value:function(e,t){var n=e.indexOf(t);return n>=0&&e.splice(n,1),this.cloneDeep(e)}},{key:"plus",value:function(e,t){return+(e+t).toFixed(10)}},{key:"minus",value:function(e,t){return+(e-t).toFixed(10)}},{key:"formatDate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"datetime";return B()(e).format(Qe[t]||t)}},{key:"randomNumber",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return Math.min(Math.floor(e+Math.random()*(t-e)),t)}},{key:"randomColor",value:function(){return"#"+("00000"+(16777216*Math.random()<<0).toString(16)).slice(-6)}},{key:"randomID",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;return Number(Math.random().toString().substr(3,e)+Date.now()).toString(36)}},{key:"getBase64",value:function(e,t){var n=this,r=t.width,a=t.height,o=t.x,i=t.y;return new Promise((function(t,s){var c=new Image;c.crossOrigin="Anonymous",c.onload=function(){var e=$('<canvas width="'+r+'" height="'+a+'"></canvas>')[0];e.getContext("2d").drawImage(c,o,i,r,a,0,0,r,a),t(e.toDataURL())},c.onerror=function(e){console.error("图片转base64失败！"),s(e)},c.src=e+"?t="+n.randomID()}))}},{key:"arrayToObject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={};return e.forEach((function(e){Object.keys(e).forEach((function(r){var a=e[r];!t&&n.hasOwnProperty(r)||(n[r]=a)}))})),n}},{key:"isEmpty",value:function(e){return null==e||""===e}},{key:"getBackGroundImageUrl",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(e=e.replace(/url\((.*)\)/,"$1")).replace(/["']/g,"")}},{key:"imgLazy",value:function(e){return new Promise((function(t,n){var r=new Image;r.src=e,r.onload=function(){t(r)},r.onerror=function(){console.error("图片加载失败",null),n(null)}}))}},{key:"compile",value:function(e){for(var t=String.fromCharCode(e.charCodeAt(0)+e.length),n=1;n<e.length;n++)t+=String.fromCharCode(e.charCodeAt(n)+e.charCodeAt(n-1));return escape(t)}},{key:"uncompile",value:function(e){e=unescape(e);for(var t=String.fromCharCode(e.charCodeAt(0)-e.length),n=1;n<e.length;n++)t+=String.fromCharCode(e.charCodeAt(n)-t.charCodeAt(n-1));return t}}]),e}());function et(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"rgba(255,255,255,1)";if(e){var n=de()(e),r=n.getAlpha();e=n.setAlpha(r).toRgbString()}else e=t;return e}var tt;new(function(){function e(){m()(this,e)}return g()(e,[{key:"getBorder",value:function(e){if(e&&"none"!==e){var t=e.split(" ");return{size:parseInt(t[0],10),type:t[1],color:et(e.replace(/.+(rgba.+)/,"$1"))}}return{size:null,type:null,color:null}}},{key:"setBorder",value:function(e,t){var n=this.getBorder(e),r=n.size,a=n.type,o=n.color;return Ze.isEmpty(t.size)||(r=t.size),Ze.isEmpty(t.type)||(a=t.type),Ze.isEmpty(t.color)||(o=et(t.color)),"".concat(r,"px ").concat(a," ").concat(o)}},{key:"getBoxshadow",value:function(e){var t=null,n=null;if(e&&"none"!==e){var r=e.split(" ");t=parseInt(r[2],10),n=et(e.replace(/.+(rgba.+)/,"$1"))}return{size:t,color:n}}},{key:"setBoxshadow",value:function(e,t){var n=this.getBoxshadow(e),r=n.size,a=n.color;return Ze.isEmpty(t.size)||(r=t.size),Ze.isEmpty(t.color)||(a=et(t.color)),"0 0 ".concat(r,"px ").concat(a)}},{key:"getAnimation",value:function(e){var t=null,n=null,r=null,a=null,o=null,i=null,s=null,c=null;if(e&&"none"!==e){var p=e.split(" ");t=p[0],n=Ze.toFixed(p[1],1),r=p[2],a=Ze.toFixed(p[3],1),o=isNaN(parseInt(p[4],10))?1/0:parseInt(p[4],10),i=p[5]||"normal",s=p[6]||"forwards",c=p[7]||"running"}return{name:t,duration:n,timing:r,delay:a,count:o,direction:i,fillMode:s,playState:c}}},{key:"setAnimation",value:function(e,t){var n=this.getAnimation(e),r=n.name,a=n.duration,o=n.timing,i=n.delay,s=n.count,c=n.direction,p=n.fillMode,l=n.playState;return Ze.isEmpty(t.name)||(r=t.name),Ze.isEmpty(t.duration)||(a=t.duration),Ze.isEmpty(t.timing)||(o=t.timing),Ze.isEmpty(t.delay)||(i=t.delay),Ze.isEmpty(t.count)||(s=isNaN(parseInt(t.count,10))?1/0:parseInt(t.count,10)),Ze.isEmpty(t.direction)||(c=t.direction),Ze.isEmpty(t.fillMode)||(p=t.fillMode),Ze.isEmpty(t.playState)||(l=t.playState),"".concat(r," ").concat(Ze.toFixed(a,1),"s ").concat(o," ").concat(Ze.toFixed(i,1),"s ").concat(s===1/0?"infinite":s," ").concat(c," ").concat(p," ").concat(l)}},{key:"getTransformVal",value:function(e,t){var n="";if(-1!==e.indexOf(t)){var r=RegExp(".*"+t+"\\((.+?)\\).*");n=e.replace(r,"$1")}if(""===(n=n.replace(/\s+/g,"")))switch(t){case"rotate":n=0;break;case"translate":n="0,0";break;case"scale":n="1,1";break;case"skew":n="0,0"}if("object"!==ue()(n))n=Ze.toFixed(n,2);else{var a=n.split(","),o=A()(a,2),i=o[0],s=o[1];n=[parseFloat(i),parseFloat(s)]}return n}},{key:"getTransform",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=null,n=null,r=null,a=null;return e&&"none"!==e&&(t=this.getTransformVal(e,"rotate"),n=this.getTransformVal(e,"translate"),r=this.getTransformVal(e,"scale"),a=this.getTransformVal(e,"skew")),"number"==typeof r&&(r=[r,r]),{rotate:t||0,translate:n||[0,0],scale:r||[1,1],skew:a||[0,0]}}},{key:"setTransform",value:function(e,t){var n=this.getTransform(e),r=n.rotate,a=n.translate,o=n.scale,i=n.skew;Ze.isEmpty(t.rotate)||(r=t.rotate),Ze.isEmpty(t.translate)||(a=t.translate),Ze.isEmpty(t.scale)||(o=t.scale),Ze.isEmpty(t.skew)||(i=t.skew);var s=[];return Ze.isEmpty(r)||s.push("rotate(".concat(r,"deg)")),Ze.isEmpty(a)||s.push("translate(".concat(a.map((function(e){return e+"px"})).join(","),")")),Ze.isEmpty(o)||s.push("scale(".concat(o.join(","),")")),Ze.isEmpty(i)||s.push("skew(".concat(i.map((function(e){return e+"deg"})).join(","),")")),s.join(" ")}},{key:"resetTransform",value:function(e,t){try{var n=[];for(var r in t)n.push("".concat(r,"(").concat(t[r],")"));n=n.join(" "),e.css({"-webkit-transform":n,transform:n})}catch(e){console.error("function:addTransform error！",e)}}}]),e}());function nt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nt(Object(n),!0).forEach((function(t){C()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function at(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var ot,it=(tt=function(e){w()(n,e);var t=at(n);function n(e){var r;m()(this,n),(r=t.call(this,e)).set={dashFill:"#f04e00",fill:"#f04e00",bgFill:"rgba(0,0,0, 0.2)",dotSize:10};var a=e.boxWidth,o=e.boxHeight,i=e.width,s=e.height,c=e.top,p=void 0===c?0:c,l=e.left,u=void 0===l?0:l;return r.state={width:i||a,height:s||o,top:p,left:u,boxWidth:a,boxHeight:o},r}return g()(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.width,n=e.height,r=e.top,a=e.left,o=e.boxWidth,i=e.boxHeight;this.setState({width:t,height:n,top:r,left:a,boxWidth:o,boxHeight:i})}},{key:"cropTick",value:function(){this.props.onCropTick&&this.props.onCropTick(rt({},this.state))}},{key:"cropEnd",value:function(){this.props.onCropEnd&&this.props.onCropEnd(rt({},this.state))}},{key:"mousedownDrag",value:function(e){var t=this,n=e.pageX-this.state.left,r=e.pageY-this.state.top,a=this.state,o=a.width,i=a.height,s=a.boxHeight,c=a.boxWidth;$(document).on("mousemove.h5ds.cropControl.drag",(function(e){var a=e.pageX-n,p=e.pageY-r;p+i>s?p=s-i:p<0&&(p=0),a+o>c?a=c-o:a<0&&(a=0),t.setState({top:p,left:a},t.cropTick)})).on("mouseup.h5ds.cropControl.drag",(function(){$(document).off("mousemove.h5ds.cropControl.drag"),$(document).off("mouseup.h5ds.cropControl.drag"),t.cropEnd()}))}},{key:"mousedownZoom",value:function(e,t){var n=this,r=e.pageX,a=e.pageY,o=this.state,i=o.left,s=o.top,c=o.width,p=o.height,l=o.boxHeight,u=o.boxWidth,h=c,d=p,f=s,y=i;$(document).on("mousemove.h5ds.cropControl.zoom",(function(e){var o=e.pageX-r,m=e.pageY-a;"topleft"==t?(h=c-o,y=i+o,f=s+p-(d=p-m)):"topright"==t?(h=c+o,f=s+p-(d=p-m)):"bottomleft"==t?(h=c-o,d=p+m,y=i+o):"bottomright"==t&&(h=c+o,d=p+m),d<0?d=0:d>l&&(d=l),h<0?h=0:h>u&&(h=u),f<0&&(f=0),y<0&&(y=0),n.setState({left:y,top:f,width:h,height:d},n.cropTick)})).on("mouseup.h5ds.cropControl.zoom",(function(){$(document).off("mousemove.h5ds.cropControl.zoom"),$(document).off("mouseup.h5ds.cropControl.zoom"),n.cropEnd()}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.top,r=t.left,a=t.width,o=t.height,i=t.boxHeight,s=t.boxWidth,c=this.set,p=c.dashFill,l=c.fill,u=c.bgFill,h=c.dotSize,d=[{x:0,y:0,width:h,height:h,type:"topleft"},{x:a,y:0,width:h,height:h,type:"topright"},{x:a,y:o,width:h,height:h,type:"bottomright"},{x:0,y:o,width:h,height:h,type:"bottomleft"}];return D.a.createElement("div",{className:"app-recrop-control",style:{width:s,height:i}},D.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:s,height:i},D.a.createElement("g",{style:{transform:"translate(".concat(r,"px, ").concat(n,"px)")}},D.a.createElement("polygon",{onMouseDown:this.mousedownDrag,style:{fill:u,stroke:p,strokeDasharray:"3,3",strokeWidth:.5},points:"0,0 ".concat(a,",0 ").concat(a,",").concat(o," 0,").concat(o)}),d.map((function(t,n){return D.a.createElement("rect",{key:n,x:t.x,y:t.y,width:t.width,height:t.height,onMouseDown:function(n){return e.mousedownZoom(n,t.type)},style:{transform:"translate(-".concat(t.width/2,"px, -").concat(t.height/2,"px)"),fill:l}})})))))}}]),n}(x.Component),se()(tt.prototype,"cropTick",[Je],Object.getOwnPropertyDescriptor(tt.prototype,"cropTick"),tt.prototype),se()(tt.prototype,"cropEnd",[Je],Object.getOwnPropertyDescriptor(tt.prototype,"cropEnd"),tt.prototype),se()(tt.prototype,"mousedownDrag",[Je],Object.getOwnPropertyDescriptor(tt.prototype,"mousedownDrag"),tt.prototype),se()(tt.prototype,"mousedownZoom",[Je],Object.getOwnPropertyDescriptor(tt.prototype,"mousedownZoom"),tt.prototype),tt);function st(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ct(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?st(Object(n),!0).forEach((function(t){C()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):st(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var lt,ut=(ot=function(e){w()(n,e);var t=pt(n);function n(e){var r;m()(this,n),r=t.call(this,e);var a=e.cropSet||{},o=a.width,i=void 0===o?0:o,s=a.height,c=void 0===s?0:s,p=a.top,l=void 0===p?0:p,u=a.left,h=void 0===u?0:u;return r.state={src:e.src,delbtn:void 0===e.delbtn||e.delbtn,width:i,height:c,top:0,left:0,boxWidth:0,boxHeight:0,naturalWidth:0,naturalHeight:0,cropLeft:h,cropTop:l,cropWidth:i,cropHeight:c,imageInfo:null},r}return g()(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this;e.src&&e.src!==this.props.src&&this.setState({src:e.src},(function(){Ze.imgLazy(e.src).then(function(){var n=f()(h.a.mark((function n(r){return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!r){n.next=4;break}return n.next=3,t.initImage(e.src,{cropLeft:0,cropTop:0,cropWidth:r.naturalWidth,cropHeight:r.naturalHeight});case 3:t.onCropOk();case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}))}},{key:"_countViewSet",value:function(e){var t=e.cropLeft,n=e.cropTop,r=e.cropWidth,a=e.cropHeight,o=e.naturalHeight,i=e.naturalWidth/(e.boxWidth||1)||1,s=o/(e.boxHeight||1)||1;return{top:n/s,left:t/i,width:r/i,height:a/s}}},{key:"_countCropData",value:function(e){var t=e.top,n=e.left,r=e.width,a=e.height,o=e.boxWidth,i=e.boxHeight,s=e.naturalHeight,c=e.naturalWidth/(o||1),p=s/(i||1),l=t*p,u=n*c,h=r*c,d=a*p;return Object.assign(e,{cropTop:l,cropLeft:u,cropWidth:h,cropHeight:d})}},{key:"initImage",value:function(e,t){var n=this;return new Promise((function(r,a){e?Ze.imgLazy(e).then((function(){var e=t.cropTop,a=t.cropLeft,o=t.cropWidth,i=t.cropHeight,s=$(n.imgRef);if(n.imgRef){t.boxWidth=s.width(),t.boxHeight=s.height(),t.naturalHeight=s[0].naturalHeight,t.naturalWidth=s[0].naturalWidth,!e&&(t.cropTop=0),!a&&(t.cropLeft=0),!o&&(t.cropWidth=t.naturalWidth),!i&&(t.cropHeight=t.naturalHeight);var c=n._countViewSet(t),p=c.top,l=c.left,u=c.width,h=c.height;n.setState(ct({top:p,left:l,width:u,height:h},t),r)}else r()})):(console.error("src 参数为null"),a())}))}},{key:"onCropBase64",value:function(){var e=this,t=this.state,n=t.src,r=t.cropLeft,a=t.cropTop,o=t.cropWidth,i=t.cropHeight;if(n)return Ze.getBase64(n,{width:o,height:i,x:r,y:a}).then((function(t){e.props.onCropBase64&&e.props.onCropBase64(ct({base64:t},e.state))}));this.props.onCropBase64&&this.props.onCropBase64(ct({base64:""},this.state))}},{key:"onCropEnd",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._countCropData(Object.assign(this.state,e));this.props.onCropEnd&&this.props.onCropEnd(t)}},{key:"onCropTick",value:function(e){this.props.onCropTick&&this.props.onCropTick(e)}},{key:"onCropOk",value:function(){var e=this.state,t=e.top,n=e.left,r=e.naturalWidth,a=e.naturalHeight,o=e.cropTop,i=e.cropLeft,s=e.cropHeight,c=e.cropWidth;this.props.onCropOk&&this.props.onCropOk(ct({},this.state)),t===o&&n===i&&r===c&&a===s||this.props.onCropBase64&&this.onCropBase64()}},{key:"resetCrop",value:function(){this.initImage(this.state.src,{cropLeft:0,cropTop:0}),this.onCropOk()}},{key:"delImage",value:function(){var e=this;this.setState({src:""},(function(){e.props.onCropOk&&e.props.onCropOk(),e.props.onCropBase64&&e.onCropBase64()}))}},{key:"getImageSize",value:function(e){var t=this;if("admin"===Ze.getUrlQuery("userType")){var n=new Image;n.onload=function(){var r=n.width,a=n.height,o=0;$.ajax({url:e,cache:!1,success:function(e,n,i){o=i.getResponseHeader("Content-Length"),t.setState({imageInfo:{width:r,height:a,size:parseInt(o/1e3,10)}})}})},n.src=e}}},{key:"componentDidMount",value:function(){var e=this.props.cropSet||{},t=e.left,n=e.top,r=e.width,a=e.height;this.props.src&&this.initImage(this.props.src,{cropLeft:t,cropTop:n,cropWidth:r,cropHeight:a}),this.getImageSize(this.props.src)}},{key:"render",value:function(){var e=this,t=this.state,n=t.src,r=t.width,a=t.height,o=t.boxWidth,i=t.boxHeight,s=t.top,c=t.left,p=t.delbtn,l=t.imageInfo;return n?D.a.createElement("div",{className:"app-util-cropimage"},D.a.createElement("div",{className:"app-util-cropimage-imgbox"},D.a.createElement(it,oe()({onCropEnd:this.onCropEnd},{width:r,height:a,top:s,left:c,boxWidth:o,boxHeight:i})),D.a.createElement("img",{ref:function(t){return e.imgRef=t},src:n,alt:"",style:{clipPath:"none"}})),D.a.createElement("div",{className:"app-util-cropimage-btns"},D.a.createElement("a",{onClick:this.props.onChangeImage},D.a.createElement("i",{className:"app-ico app-ico-icoreset"})," 换图"),p?D.a.createElement("a",{onClick:this.delImage},D.a.createElement("i",{className:"app-ico app-ico-icodel"})," 删除"):null,D.a.createElement("a",{onClick:this.resetCrop},D.a.createElement("i",{className:"app-ico app-ico-icoinit"})," 重置"),D.a.createElement("a",{onClick:this.onCropOk},D.a.createElement("i",{className:"app-ico app-ico-icocrop"})," 裁剪"),D.a.createElement("a",{className:"app-img-down",href:n,rel:"noopener noreferrer",target:"_blank"},l?D.a.createElement("span",{style:{fontSize:12,color:l.size>200?"#ff3636":"#a5b6c8"}},"".concat(l.size,"kb")):"...",D.a.createElement("i",{className:"app-ico app-ico-xiazai"})))):D.a.createElement("div",{className:"app-util-cropimage-nullimg",onClick:this.props.onClickNullImage},"选择图片")}}]),n}(x.Component),se()(ot.prototype,"initImage",[Je],Object.getOwnPropertyDescriptor(ot.prototype,"initImage"),ot.prototype),se()(ot.prototype,"onCropBase64",[Je],Object.getOwnPropertyDescriptor(ot.prototype,"onCropBase64"),ot.prototype),se()(ot.prototype,"onCropEnd",[Je],Object.getOwnPropertyDescriptor(ot.prototype,"onCropEnd"),ot.prototype),se()(ot.prototype,"onCropTick",[Je],Object.getOwnPropertyDescriptor(ot.prototype,"onCropTick"),ot.prototype),se()(ot.prototype,"onCropOk",[Je],Object.getOwnPropertyDescriptor(ot.prototype,"onCropOk"),ot.prototype),se()(ot.prototype,"resetCrop",[Je],Object.getOwnPropertyDescriptor(ot.prototype,"resetCrop"),ot.prototype),se()(ot.prototype,"delImage",[Je],Object.getOwnPropertyDescriptor(ot.prototype,"delImage"),ot.prototype),se()(ot.prototype,"getImageSize",[Je],Object.getOwnPropertyDescriptor(ot.prototype,"getImageSize"),ot.prototype),ot);function ht(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}lt=function(e){w()(n,e);var t=ht(n);function n(e){var r;m()(this,n),r=t.call(this,e);var a=e.layer,o={};return a.data.crop&&(o=JSON.parse(a.data.crop)),r.state={src:a.data.src,crop:o,cropKey:Q.randomID()},r.eventId=Q.randomID(),r}return g()(n,[{key:"renderLayer",value:function(e){var t=this,n=this.props,r=n.h5ds,a=n.layer;e?Q.imgLazy(e).then((function(n){Object(Ee.transaction)((function(){var o=JSON.stringify({top:0,left:0,width:n.naturalWidth,height:n.naturalWidth,naturalWidth:n.naturalWidth,naturalHeight:n.naturalWidth});a.data.src=e,a.data.crop=o,r.edata.keys=Q.randomID(),window.pubSubEditor.publish("h5ds.setHistory"),t.setState({src:e,crop:o,cropKey:Q.randomID()})})),setTimeout((function(){$("#h5dsLayerList").find(".app-layerlist-active").trigger("click")}))})):Object(Ee.transaction)((function(){a.data.crop=JSON.stringify(t.state.crop),r.edata.keys=Q.randomID(),window.pubSubEditor.publish("h5ds.setHistory")}))}},{key:"changeImage",value:function(){window.pubSubEditor.publish("h5ds.img.modal.show",{callback:this.renderLayer})}},{key:"scaleEvent",value:function(){var e=this,t=this.props.h5ds;this.$layer=t.getLayerDom(),this.$layer.on("controlStart.h5ds.img",(function(){e.layerBox=e.$layer.find(".layer-h5ds_img-inner")})),this.$layer.on("controlResizeTick.h5ds.img",(function(t,n){var r=e.state.crop,a=r.width,o=void 0===a?1:a,i=r.height,s=void 0===i?1:i;e.layerBox.css({transform:"scale(".concat(n.width/o,", ").concat(n.height/s,")")})}))}},{key:"cropCallback",value:function(e){if(e){var t=e.cropLeft,n=e.cropTop,r=e.cropWidth,a=e.cropHeight,o=e.naturalWidth,i=e.naturalHeight;this.setState({crop:{left:t,top:n,width:r,height:a,naturalWidth:o,naturalHeight:i}},this.renderLayer)}else window.pubSubEditor.publish("h5ds.shortcuts_dellayer")}},{key:"componentDidMount",value:function(){var e=this;this.scaleEvent(),$("#h5dsCanvas").on("dblclick.imgeditor",".app-control",(function(){e.changeImage()}))}},{key:"componentWillUnmount",value:function(){this.$layer&&(this.$layer.off("controlStart.h5ds.img"),this.$layer.off("controlResizeTick.h5ds.img"),this.$layer=null),$("#h5dsCanvas").off("dblclick.imgeditor")}},{key:"render",value:function(){var e=this.state,t=e.src,n=e.crop,r=e.cropKey;return D.a.createElement("div",{className:"app-edit-h5ds_img",key:r},D.a.createElement(ut,{cropSet:n,onClickNullImage:this.changeImage,onChangeImage:this.changeImage,onCropOk:this.cropCallback,src:t}))}}]),n}(x.Component),se()(lt.prototype,"renderLayer",[be],Object.getOwnPropertyDescriptor(lt.prototype,"renderLayer"),lt.prototype),se()(lt.prototype,"changeImage",[be],Object.getOwnPropertyDescriptor(lt.prototype,"changeImage"),lt.prototype),se()(lt.prototype,"scaleEvent",[be],Object.getOwnPropertyDescriptor(lt.prototype,"scaleEvent"),lt.prototype),se()(lt.prototype,"cropCallback",[be],Object.getOwnPropertyDescriptor(lt.prototype,"cropCallback"),lt.prototype);n(355);var dt={name:"图片",pid:"h5ds_img",version:"1.0.0"};function ft(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var yt,mt=function(e){w()(n,e);var t=ft(n);function n(){return m()(this,n),t.apply(this,arguments)}return g()(n,[{key:"render",value:function(){var e=this.props.layer,t={};e.data.crop&&(t=JSON.parse(e.data.crop));var n=t,r=n.top,a=void 0===r?0:r,o=n.left,i=void 0===o?0:o,s=n.width,c=void 0===s?1:s,p=n.height,l=void 0===p?1:p,u={top:-a,left:-i,width:n.naturalWidth,height:n.naturalHeight},h={width:c,height:l,transform:"scale(".concat(e.style.width/c,", ").concat(e.style.height/l,")")};return D.a.createElement("div",{className:"layer-h5ds_img-inner",style:h},D.a.createElement("div",{className:"layer-h5ds_img-box",style:u},D.a.createElement("img",{src:e.data.src||"http://cdn.h5ds.cn/lib/images/imgDom.jpg"})))}}]),n}(x.Component),vt=(n(357),n(359),n(13)),gt=n.n(vt);function bt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var wt=(yt=function(e){w()(n,e);var t=bt(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).container=document.createElement("div"),document.body.appendChild(r.container),r}return g()(n,[{key:"onClose",value:function(){this.props.close&&this.props.close()}},{key:"componentWillUnmount",value:function(){document.body.removeChild(this.container)}},{key:"render",value:function(){var e=this.props,t=e.show,n=e.title,r=e.className,a=e.forceRender,o=void 0!==a&&a,i=["app-modal"];return t&&i.push("app-modal-show"),n&&i.push("app-modal-hastitle"),r&&i.push(r),gt.a.createPortal(D.a.createElement("div",{className:i.join(" ")},D.a.createElement("a",{className:"app-modal-close",onClick:this.onClose},"×"),n?D.a.createElement("div",{className:"app-modal-title"},D.a.createElement("span",{className:"app-modal-title-icon"}),D.a.createElement("h3",null,n)):null,o?D.a.createElement("div",{className:"app-modal-content"},t?this.props.children:null):D.a.createElement("div",{className:"app-modal-content"},this.props.children)),this.container)}}]),n}(x.Component),se()(yt.prototype,"onClose",[Je],Object.getOwnPropertyDescriptor(yt.prototype,"onClose"),yt.prototype),yt);n(361);function kt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var Et,Ot=function(e){w()(n,e);var t=kt(n);function n(e){var r;m()(this,n),(r=t.call(this,e)).storeAdd=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=Q.getStorage("H5DS_NO_SERVER_IMAGES");t=t?t.split(","):[],t=[].concat(z()(t),z()(e.split(","))),r.setState({imgList:t}),Q.setStorage("H5DS_NO_SERVER_IMAGES",t.join(","))},r.storeDel=function(e){var t=Q.getStorage("H5DS_NO_SERVER_IMAGES");(t=t?t.split(","):[]).splice(e,1),r.setState({imgList:t}),Q.setStorage("H5DS_NO_SERVER_IMAGES",t.join(","))},r.addImg=function(e){r.props.select({url:e})},r.delImg=function(e,t){e.stopPropagation(),r.storeDel(t)},r.addSource=function(){r.setState({value:""}),r.state.value?r.storeAdd(r.state.value):ke.Modal.error({title:"错误提示",content:"请先添加图片资源，多个图片链接使用','分割"})},r.onChangeText=function(e){r.setState({value:e.target.value})};var a=Q.getStorage("H5DS_NO_SERVER_IMAGES");return a=a?a.split(","):[],r.state={imgList:a,value:""},r}return g()(n,[{key:"render",value:function(){var e=this,t=ke.Input.TextArea;return D.a.createElement("div",{className:"app-noserver-modal"},D.a.createElement("div",{className:"app-noserver-tips"},"未设置options.imageSourceModal参数，这里显示系统自带的图片管理器"),D.a.createElement("div",null,D.a.createElement(t,{value:this.state.value,onChange:this.onChangeText,rows:3,placeholder:"添加图片资源，多个图片链接使用','分割"}),D.a.createElement("br",null),D.a.createElement("br",null),D.a.createElement(ke.Button,{type:"primary",onClick:this.addSource},"添加图片资源")),D.a.createElement("div",{className:"app-noserver-imgs"},this.state.imgList.map((function(t,n){return D.a.createElement("div",{key:n,className:"app-noserver-item",onClick:function(){return e.addImg(t)}},D.a.createElement(ke.Icon,{onClick:function(t){e.delImg(t,n)},type:"close"}),D.a.createElement("img",{src:t}))}))))}}]),n}(x.Component);function St(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}Et=function(e){w()(n,e);var t=St(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).state={visible:!1},r}return g()(n,[{key:"hideModal",value:function(){this.setState({visible:!1})}},{key:"selectPicture",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.selectImgCallback&&this.selectImgCallback(e.url),this.hideModal()}},{key:"componentDidMount",value:function(){var e=this;window.pubSubEditor.subscribe("h5ds.img.modal.show",(function(t){var n=t.callback,r=void 0===n?null:n;e.selectImgCallback=r,e.setState({visible:!0})}))}},{key:"componentWillUnmount",value:function(){window.pubSubEditor.unsubscribe("h5ds.img.modal.show")}},{key:"render",value:function(){var e=this.props.scope.options,t=void 0===e?{}:e;return D.a.createElement(wt,{className:"app-modal-source",close:this.hideModal,title:D.a.createElement("div",null,"图片库"," ",D.a.createElement(ke.Button,{onClick:this.hideModal,className:"app-modal-close-button"},"关闭窗口")),show:this.state.visible},t.imageSourceModal?D.a.createElement(t.imageSourceModal,{select:this.selectPicture}):D.a.createElement(Ot,{notRender:!0,select:this.selectPicture}))}}]),n}(x.Component),se()(Et.prototype,"hideModal",[be],Object.getOwnPropertyDescriptor(Et.prototype,"hideModal"),Et.prototype),se()(Et.prototype,"selectPicture",[be],Object.getOwnPropertyDescriptor(Et.prototype,"selectPicture"),Et.prototype),n(363),n(365);var xt,Dt=n(367);function Pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function jt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pt(Object(n),!0).forEach((function(t){C()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ct(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var Rt=(xt=function(e){w()(n,e);var t=Ct(n);function n(e){var r;m()(this,n);var a=(r=t.call(this,e)).filterColor(e.color);return r.state={colorStyle:{},show:!1,color:a},r.id="color_"+Ze.randomID(6),r}return g()(n,[{key:"filterColor",value:function(e){if(e){var t=de()(e),n=t.getAlpha();e=t.setAlpha(n).toRgbString()}else e="rgba(0,0,0,1)";return e}},{key:"showPicker",value:function(e){var t={};window.innerWidth<$(e.target).offset().left+220&&(t.left=window.innerWidth-($(e.target).offset().left+220)),window.innerHeight<$(e.target).offset().top+246&&(t.top=window.innerHeight-($(e.target).offset().top+310+10)),this.setState({show:!this.state.show,colorStyle:t})}},{key:"doChange",value:function(e){var t=this.props.onChange;if(t){var n=e.rgb,r=n.r,a=n.g,o=n.b,i=n.a;e.rgba="rgba(".concat(r,",").concat(a,",").concat(o,",").concat(i,")"),t(e)}}},{key:"changeColor",value:function(e){var t=this,n=e.rgb,r=n.r,a=n.g,o=n.b,i=n.a;this.setState({color:"rgba(".concat(r,",").concat(a,",").concat(o,",").concat(i,")")},(function(){return t.doChange(e)}))}},{key:"clickBank",value:function(e){var t=$(e.target).closest(".app-util-color");this.unmount||t[0]?!this.unmount&&t[0]&&t.attr("id")!==this.id&&this.setState({show:!1}):this.setState({show:!1})}},{key:"componentDidMount",value:function(){$(document).on("click.blank_"+this.id,this.clickBank)}},{key:"componentWillUnmount",value:function(){this.unmount=!0,$(document).off("click.blank_"+this.id)}},{key:"render",value:function(){var e=this.state,t=e.show,n=e.color,r=e.colorStyle,a=this.props.children;return r.zIndex=t?9999:"initial",D.a.createElement("div",{className:"app-util-color",id:this.id},a?D.a.createElement("span",{className:"app-util-color-inner",style:{backgroundColor:n},onClick:this.showPicker},a):D.a.createElement("span",{className:"app-util-color-btn",style:{backgroundColor:n},onClick:this.showPicker}),t?D.a.createElement("div",{className:"app-util-color-box",style:jt({},r)},D.a.createElement(Dt.SketchPicker,{presetColors:["#D0021B","#F5A623","#F8E71C","#8B572A","#7ED321","#417505","#BD10E0","#9013FE","#4A90E2","#50E3C2","#B8E986","#000000","#4A4A4A","#9B9B9B","#FFFFFF"],color:n,onChange:this.changeColor})):null)}}]),n}(x.Component),se()(xt.prototype,"showPicker",[Je],Object.getOwnPropertyDescriptor(xt.prototype,"showPicker"),xt.prototype),se()(xt.prototype,"doChange",[Je],Object.getOwnPropertyDescriptor(xt.prototype,"doChange"),xt.prototype),se()(xt.prototype,"changeColor",[Je],Object.getOwnPropertyDescriptor(xt.prototype,"changeColor"),xt.prototype),se()(xt.prototype,"clickBank",[Je],Object.getOwnPropertyDescriptor(xt.prototype,"clickBank"),xt.prototype),xt);n(464);function It(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var Nt=function(e){w()(n,e);var t=It(n);function n(){return m()(this,n),t.apply(this,arguments)}return g()(n,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.span,r=["app-layout-setgrid","app-layout-setgrid-".concat(void 0===n?1:n)];return D.a.createElement("div",{className:r.join(" ")},t)}}]),n}(x.Component);n(466);function Lt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var At,_t=function(e){w()(n,e);var t=Lt(n);function n(){return m()(this,n),t.apply(this,arguments)}return g()(n,[{key:"render",value:function(){var e=this.props,t=e.name,n=e.children,r=e.className,a=void 0===r?"":r,o=e.compose,i=void 0===o?"combin":o;return D.a.createElement("div",{className:"app-layout-setitem app-layout-setitem-".concat(i," ").concat(a)},D.a.createElement("div",{className:"app-layout-setitem-name"},t),D.a.createElement("div",{className:"app-layout-setitem-content"},n))}}]),n}(x.Component);function Tt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var zt,Ht=(At=function(e){w()(n,e);var t=Tt(n);function n(e){var r;m()(this,n),r=t.call(this,e);var a=e.color;return r.state={color:r.filterColor(a)},r}return g()(n,[{key:"filterColor",value:function(e){if(e){var t=de()(e),n=t.getAlpha();e=t.setAlpha(n).toRgbString()}else e="rgba(0,0,0,0)";return e}},{key:"setColor",value:function(e){var t=e.rgb,n=t.r,r=t.g,a=t.b,o=t.a;this.setState({color:"rgba(".concat(n,",").concat(r,",").concat(a,",").concat(o,")")}),this.props.onChange&&this.props.onChange(e)}},{key:"render",value:function(){var e=this.state.color,t=this.props.title;return D.a.createElement("div",{className:"app-util-bgcolor"},D.a.createElement(_t,{name:t||"背景底色"},D.a.createElement(Rt,{onChange:this.setColor,color:e})))}}]),n}(x.Component),se()(At.prototype,"setColor",[Je],Object.getOwnPropertyDescriptor(At.prototype,"setColor"),At.prototype),At);function $t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Wt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$t(Object(n),!0).forEach((function(t){C()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Mt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}zt=function(e){w()(n,e);var t=Mt(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).renderLayer=Q.debounce((function(){Object(Ee.transaction)((function(){var e=r.props.layer.data,t=(e.style,pe()(e,["style"]));r.props.layer.data=Wt({style:Wt({},r.state.data.style)},t),r.props.h5ds.edata.keys=Q.randomID(),window.pubSubEditor.publish("h5ds.setHistory")}))}),500),r.state={data:Object(Ee.toJS)(e.layer.data)||{}},r}return g()(n,[{key:"changeColor",value:function(e){var t=this.state.data,n=e.rgb,r=n.r,a=n.g,o=n.b,i=n.a;t.style.fill="rgba(".concat(r,",").concat(a,",").concat(o,",").concat(i,")"),this.setState({data:t},this.renderLayer)}},{key:"changeStrokeWidth",value:function(e){var t=this.state.data;t.style.strokeWidth=e,this.setState({data:t},this.renderLayer)}},{key:"render",value:function(){var e=this.state.data;return D.a.createElement("div",{className:"app-ex-h5ds_shape"},D.a.createElement(_t,{name:"选择颜色"},D.a.createElement(Rt,{onChange:this.changeColor,color:e.style.fill||"rgba(0,0,0,1)"})),"line"===e.shape?D.a.createElement(_t,{name:"线条宽度"},D.a.createElement(ke.InputNumber,{min:1,max:1/0,size:"small",className:"app-input",defaultValue:e.style.strokeWidth||1,onChange:this.changeStrokeWidth,placeholder:"边框样式"})):null)}}]),n}(x.Component),se()(zt.prototype,"changeColor",[be],Object.getOwnPropertyDescriptor(zt.prototype,"changeColor"),zt.prototype),se()(zt.prototype,"changeStrokeWidth",[be],Object.getOwnPropertyDescriptor(zt.prototype,"changeStrokeWidth"),zt.prototype);n(468);var Bt={pid:"h5ds_shape",name:"形状",version:"1.0.0"},Ft=[{type:"line",name:"线条",img:"http://cdn.h5ds.cn/static/images/line.png",dom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.a.createElement("svg",{preserveAspectRatio:"none",viewBox:"0 0 ".concat(e.width||1," ").concat(e.height||1),xmlns:"http://www.w3.org/2000/svg"},D.a.createElement("line",{x1:0,y1:0,x2:e.width||1,y2:e.height||1,style:{stroke:e.fill||"#000",strokeWidth:e.strokeWidth||1}}))}},{type:"star4",name:"四角星",dom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.a.createElement("svg",{preserveAspectRatio:"none",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},D.a.createElement("path",{d:"M523.93046471 1021.82852532L408.07239629 618.0485752 1.90635325 510.6743928l401.12873572-105.25321088 97.03444632-403.24970724L615.92760371 405.9514248l406.16604304 107.3741824-401.12873572 105.25321088-97.03444632 403.24970724z",fill:e.fill}))}},{type:"star5",name:"五星",dom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.a.createElement("svg",{preserveAspectRatio:"none",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1092 1024",version:"1.1"},D.a.createElement("path",{fill:e.fill,d:"M546.133333 819.2l-320.989866 168.7552 61.303466-357.444267L26.760533 377.378133l358.877867-52.155733L546.133333 0l160.494934 325.2224 358.877866 52.155733-259.6864 253.1328 61.303467 357.444267z"}))}},{type:"circle",name:"圆形",dom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.a.createElement("svg",{preserveAspectRatio:"none",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},D.a.createElement("path",{d:"M512 512m-512 0a512 512 0 1 0 1024 0 512 512 0 1 0-1024 0Z",fill:e.fill}))}},{type:"path3",name:"三角形",dom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.a.createElement("svg",{preserveAspectRatio:"none",viewBox:"0 0 1170 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},D.a.createElement("path",{d:"M583.475783 1024L1.458689 0H1166.951567z",fill:e.fill}))}},{type:"path4",name:"四边形",dom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.a.createElement("svg",{preserveAspectRatio:"none",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg"},D.a.createElement("rect",{x:"0",y:"0",width:"100",height:"100",fill:e.fill}))}},{type:"path5",name:"五边形",dom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.a.createElement("svg",{preserveAspectRatio:"none",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},D.a.createElement("path",{d:"M512.128 0l-512 391.04L195.648 1024h632.64l195.84-632.96z",fill:e.fill}))}},{type:"path6",name:"六边形",dom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.a.createElement("svg",{preserveAspectRatio:"none",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},D.a.createElement("path",{d:"M768 64H256L0 512l256 448h512l256-448z",fill:e.fill}))}},{type:"path7",name:"平行四边形",dom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.a.createElement("svg",{preserveAspectRatio:"none",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},D.a.createElement("path",{d:"M630.08 1024H0L393.6 0H1024z",fill:e.fill}))}},{type:"path8",name:"梯形",dom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.a.createElement("svg",{preserveAspectRatio:"none",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},D.a.createElement("path",{d:"M1024 1024H0L256 0h512z",fill:e.fill}))}},{type:"path9",name:"菱形",dom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.a.createElement("svg",{preserveAspectRatio:"none",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},D.a.createElement("path",{d:"M0 512L512 0l512 512-512 512z",fill:e.fill}))}},{type:"path10",name:"管道",dom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.a.createElement("svg",{preserveAspectRatio:"none",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},D.a.createElement("path",{d:"M1024 704V320c-176.736 0-320-143.264-320-320H320c0 176.736-143.264 320-320 320v384c176.736 0 320 143.264 320 320h384c0-176.736 143.264-320 320-320z",fill:e.fill}))}},{type:"icon-qipao",name:"气泡",dom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.a.createElement("svg",{preserveAspectRatio:"none",viewBox:"0 0 1194 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},D.a.createElement("path",{d:"M597.333333 920.618667c-40.106667 0-79.274667-2.816-117.205333-8.448-131.882667 46.677333-176.426667 63.957333-309.205333 111.146666 33.536-74.666667 45.653333-115.029333 76.373333-190.037333C97.706667 749.482667 0 613.546667 0 460.672 0 205.653333 267.392 0 597.333333 0s597.333333 205.653333 597.333334 460.672c0 254.293333-267.392 459.946667-597.333334 459.946667z",fill:e.fill}))}},{type:"icon-heart",name:"心",dom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.a.createElement("svg",{preserveAspectRatio:"none",viewBox:"0 0 1025 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},D.a.createElement("path",{d:"M755.072 64q-26.016 0-52 7.008t-48.992 19.008-44.512 28.992-39.488 36.992-32.512 42.016-25.504 44.992q-35.008-74.016-100.992-126.496t-142.016-52.512q-111.008 0-190.016 79.008t-79.008 190.016q0 62.016 16.992 116.512t48.512 98.496 70.496 84.512 88 83.008 95.488 84 99.008 97.504 93.504 115.008q39.008-58.016 90.016-114.496t97.504-99.008 96-85.504 88.992-84 72-84.992 50.016-97.504 17.504-113.504q0-111.008-79.008-190.016t-190.016-79.008z",fill:e.fill}))}}];function Vt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Gt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vt(Object(n),!0).forEach((function(t){C()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ut(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var Yt,Jt=function(e){w()(n,e);var t=Ut(n);function n(){return m()(this,n),t.apply(this,arguments)}return g()(n,[{key:"render",value:function(){var e=JSON.parse(JSON.stringify(this.props.layer.data)),t=e.style,n=e.transform,r=e.shape,a=Ft.find((function(e){return e.type===r})),o=this.props.layer.style,i=o.width,s=o.height;return a?D.a.createElement("div",{className:"layer-h5ds_shape-inner"},D.a.createElement("div",{style:{transform:n},className:"layer-h5ds_shape-dom"},a.dom(Gt(Gt({},t),{},{width:i,height:s})))):null}}]),n}(x.Component);n(470),n(472);function qt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var Xt,Kt=(Yt=function(e){w()(n,e);var t=qt(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).container=document.createElement("div"),document.body.appendChild(r.container),r}return g()(n,[{key:"onClose",value:function(){this.props.close&&this.props.close()}},{key:"render",value:function(){var e=this.props,t=e.show,n=e.title,r=e.className,a=["app-drawer"];return t&&a.push("app-drawer-show"),n&&a.push("app-drawer-hastitle"),r&&a.push(r),gt.a.createPortal(D.a.createElement("div",{className:a.join(" ")},D.a.createElement("a",{className:"app-drawer-close",onClick:this.onClose},"×"),n?D.a.createElement("div",{className:"app-drawer-title"},D.a.createElement("span",{className:"app-drawer-title-icon"}),D.a.createElement("h3",null,n)):null,D.a.createElement("div",{className:"app-drawer-content"},t?this.props.children:null)),this.container)}}]),n}(x.Component),se()(Yt.prototype,"onClose",[Je],Object.getOwnPropertyDescriptor(Yt.prototype,"onClose"),Yt.prototype),Yt),Qt=n(474);function Zt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function en(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zt(Object(n),!0).forEach((function(t){C()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function tn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var nn;Xt=function(e){w()(n,e);var t=tn(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).state={visible:!1},r.willDrawShape="",r}return g()(n,[{key:"hideModal",value:function(){this.setState({visible:!1})}},{key:"drawShape",value:function(e){this.willDrawShape=e,$(".app-center").append('<div class="app-shape-shapepanel"></div>'),this.hideModal()}},{key:"addLayerData",value:function(e){var t=this,n=e.left,r=e.top,a=e.width,o=e.height,i=e.quadrant,s=this.props.scope.pluginsKey,c=this.props.h5ds.getJsonByPid(s,"h5ds_shape",this.willDrawShape),p="";switch(i){case 1:p="1, -1";break;case 2:p="-1, -1";break;case 3:p="-1, 1";break;case 4:p="1, 1"}"line"===this.willDrawShape&&(c.data.style.strokeWidth=1);var l=parseFloat($(".app-canvas-box").transform("scale"))||1;c.style.width=a/l,c.style.height=o/l,c.style.left=n/l,c.style.top=r/l,c.data.transform="scale(".concat(p,")"),Object(Ee.transaction)((function(){t.props.h5ds.addLayer(c),t.props.h5ds.edata.keys=Q.randomID()})),this.props.h5ds.clickLayer()}},{key:"drawTemporaryShape",value:function(e){var t=this,n=e.top,r=e.left,a=e.width,o=e.height,i=e.quadrant;if(this.$temporary){"line"===this.willDrawShape&&(this.$temporary.find("svg").attr({viewBox:"0 0 ".concat(a," ").concat(o)}),this.$temporary.find("line").attr({x1:0,y1:0,x2:a,y2:o}));var s="";switch(i){case 1:s="1, -1";break;case 2:s="-1, -1";break;case 3:s="-1, 1";break;case 4:s="1, 1"}this.$temporary.css({top:n,left:r,width:a,height:o,transform:"scale(".concat(s,")")})}else{var c,p="id_".concat(Q.randomID()),l=Ft.find((function(e){return e.type===t.willDrawShape}));c=Object(Qt.renderToStaticMarkup)(l.dom()),$(".app-shape-shapepanel").html('<div class="app-shape-shapepanel-inner" style="width:0; height: 0;" id="'.concat(p,'">').concat(c,"</div>")),this.$temporary=$("#".concat(p))}}},{key:"drawShapeEvent",value:function(){var e=this;$(document).on("mousedown.h5ds.shapepanel",".app-shape-shapepanel",(function(t){var n=$(".app-center").offset(),r=n.left,a=n.top,o={width:0,height:0,left:t.pageX-r,top:t.pageY-a},i=4;$(document).on("mousemove.h5ds.shapepanel",(function(n){o.width=Math.abs(n.pageX-t.pageX),o.height=Math.abs(n.pageY-t.pageY),n.shiftKey&&(o.height=o.width),n.pageX>t.pageX?(o.left=t.pageX,i=n.pageY>t.pageY?4:1):(o.left=n.pageX,i=n.pageY>t.pageY?3:2),n.pageY>t.pageY?o.top=t.pageY:n.shiftKey?(n.pageX=n.pageY,o.top=t.pageY-o.height):o.top=n.pageY,o.left-=r,o.top-=a,e.drawTemporaryShape(en(en({},o),{},{quadrant:i}))})).on("mouseup.h5ds.shapepanel",(function(){e.$temporary=null;var t=$(".app-js-canvas").offset();o.left=o.left-t.left+r,o.top=o.top-t.top+a,e.addLayerData(en(en({},o),{},{quadrant:i})),$(".app-shape-shapepanel")[0]&&$(".app-shape-shapepanel").remove(),$(document).off("mousemove.h5ds.shapepanel"),$(document).off("mouseup.h5ds.shapepanel")}))}))}},{key:"componentDidMount",value:function(){var e=this;window.pubSubEditor.subscribe("h5ds.shape.modal.show",(function(t){var n=t.callback,r=void 0===n?null:n;e.selectCallback=r,e.setState({visible:!0})})),this.drawShapeEvent()}},{key:"componentWillUnmount",value:function(){$(".app-shape-shapepanel")[0]&&$(".app-shape-shapepanel").remove(),$(document).off("mousedown.h5ds.shapepanel"),window.pubSubEditor.unsubscribe("h5ds.shape.modal.show")}},{key:"render",value:function(){var e=this;return D.a.createElement(Kt,{className:"app-shape-source",close:this.hideModal,title:null,show:this.state.visible},D.a.createElement("div",{className:"app-shape-list"},Ft.map((function(t,n){return D.a.createElement("div",{className:"app-shape-item",key:n,onClick:function(){return e.drawShape(t.type)}},t.img?D.a.createElement("img",{src:t.img}):t.dom({fill:"rgba(255,255,255,1)"}))}))))}}]),n}(x.Component),se()(Xt.prototype,"hideModal",[be],Object.getOwnPropertyDescriptor(Xt.prototype,"hideModal"),Xt.prototype),se()(Xt.prototype,"drawShape",[be],Object.getOwnPropertyDescriptor(Xt.prototype,"drawShape"),Xt.prototype),se()(Xt.prototype,"addLayerData",[be],Object.getOwnPropertyDescriptor(Xt.prototype,"addLayerData"),Xt.prototype),se()(Xt.prototype,"drawTemporaryShape",[be],Object.getOwnPropertyDescriptor(Xt.prototype,"drawTemporaryShape"),Xt.prototype),se()(Xt.prototype,"drawShapeEvent",[be],Object.getOwnPropertyDescriptor(Xt.prototype,"drawShapeEvent"),Xt.prototype),n(476);function rn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}nn=function(e){w()(n,e);var t=rn(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).state={keys:Q.randomID()},r.loadSource=new me,r}return g()(n,[{key:"changeDelay",value:function(e){this.props.layer.data.delay=e,this.setState({keys:Q.randomID()})}},{key:"autoPlayDo",value:function(e){this.props.layer.data.autoplay=e,this.setState({keys:Q.randomID()})}},{key:"changeMusicIcon",value:function(e){var t=this;Object(Ee.transaction)((function(){t.props.layer.data.icon=e?"default":"null",t.props.h5ds.edata.keys=Q.randomID(),t.setState({keys:Q.randomID()}),window.pubSubEditor.publish("h5ds.setHistory")}))}},{key:"changeMusicLoop",value:function(e){var t=this;Object(Ee.transaction)((function(){t.props.layer.data.loop=e,t.props.h5ds.edata.keys=Q.randomID(),t.setState({keys:Q.randomID()}),window.pubSubEditor.publish("h5ds.setHistory")}))}},{key:"changeMusicAutoPlay",value:function(e){var t=this;Object(Ee.transaction)((function(){t.props.layer.data.autoplay=e,t.props.h5ds.edata.keys=Q.randomID(),t.setState({keys:Q.randomID()}),window.pubSubEditor.publish("h5ds.setHistory")}))}},{key:"changeSound",value:function(){var e=this;window.pubSubEditor.publish("h5ds.sound.modal.show",{callback:function(t){var n=t.url,r=t.name,a=new ve;e.loadSource.soundLazy(n).then((function(t){a.destroy(),Object(Ee.transaction)((function(){e.props.layer.data.name=r,e.props.layer.data.sound=n,e.props.layer.data.duration=t.duration,e.setState({keys:Q.randomID()}),window.pubSubEditor.publish("h5ds.setHistory")}))}))}})}},{key:"render",value:function(){this.state.keys;var e=this.props.layer.data,t=e.delay,n=e.autoplay,r=e.loop,a=e.icon,o=e.name,i=e.sound;return D.a.createElement("div",{className:"app-ex-h5ds_sound"},D.a.createElement(Nt,{span:2},D.a.createElement(_t,{name:"音乐图标"},D.a.createElement(ke.Switch,{checked:"null"!==a,onChange:this.changeMusicIcon}))),D.a.createElement(Nt,{span:2},D.a.createElement(_t,{name:"循环播放"},D.a.createElement(ke.Switch,{checked:r,onChange:this.changeMusicLoop}))),D.a.createElement(Nt,{span:2},D.a.createElement(_t,{name:"自动播放"},D.a.createElement(ke.Switch,{checked:n,onChange:this.changeMusicAutoPlay}))),D.a.createElement(Nt,{span:2},D.a.createElement(_t,{name:"延迟时间"},D.a.createElement(ke.InputNumber,{step:.1,min:0,value:t,onChange:this.changeDelay,size:"small"}))),D.a.createElement(_t,{name:"当前音乐"},D.a.createElement("span",{className:"app-ex-h5ds_sound-name"},o),D.a.createElement("audio",{className:"app-sound-controls",key:i,controls:!0},D.a.createElement("source",{src:i,type:"audio/mpeg"})),D.a.createElement(ke.Button,{type:"primary",onClick:this.changeSound},"替换音乐")))}}]),n}(x.Component),se()(nn.prototype,"changeDelay",[be],Object.getOwnPropertyDescriptor(nn.prototype,"changeDelay"),nn.prototype),se()(nn.prototype,"autoPlayDo",[be],Object.getOwnPropertyDescriptor(nn.prototype,"autoPlayDo"),nn.prototype),se()(nn.prototype,"changeMusicIcon",[be],Object.getOwnPropertyDescriptor(nn.prototype,"changeMusicIcon"),nn.prototype),se()(nn.prototype,"changeMusicLoop",[be],Object.getOwnPropertyDescriptor(nn.prototype,"changeMusicLoop"),nn.prototype),se()(nn.prototype,"changeMusicAutoPlay",[be],Object.getOwnPropertyDescriptor(nn.prototype,"changeMusicAutoPlay"),nn.prototype),se()(nn.prototype,"changeSound",[be],Object.getOwnPropertyDescriptor(nn.prototype,"changeSound"),nn.prototype);n(478);var an,on={leavePageUnmount:!0,pid:"h5ds_sound",name:"音频",version:"1.0.0"};function sn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var cn=(an=function(e){w()(n,e);var t=sn(n);function n(e){var r;m()(this,n),(r=t.call(this,e)).soundId="id_"+Q.randomID();var a=e.layer.data;return r.state={status:a.autoplay?"play":"pause"},r}return g()(n,[{key:"doMusic",value:function(e){var t=this;e||(e=this.state.status);var n=this.props.layer;[je.RENDER_IN_PREVIEW,je.RENDER_IN_CANVAS,je.RENDER_IN_PUBLISH].includes(this.props.renderIn)&&("play"===e?(this.temp&&clearTimeout(this.temp),this.setState({status:"pause"},(function(){document.getElementById(t.soundId).pause()}))):this.temp=setTimeout((function(){t.setState({status:"play"},(function(){document.getElementById(t.soundId).play()}))}),1e3*parseFloat(n.data.delay)||1))}},{key:"clickMusic",value:function(){this.props.renderIn!==je.RENDER_IN_CANVAS&&this.doMusic()}},{key:"componentDidMount",value:function(){this.props.layer.data.autoplay&&this.props.renderIn!==je.RENDER_IN_CANVAS&&this.doMusic("play"===this.state.status?"pause":"play")}},{key:"componentWillUnmount",value:function(){document.getElementById(this.soundId).pause(),this.temp&&clearTimeout(this.temp)}},{key:"render",value:function(){var e=this,t=this.props.layer,n=this.state.status,r=null;switch(t.data.icon){case"default":r=D.a.createElement("div",{onClick:this.clickMusic,style:{transform:"scale(".concat(t.style.width/26,", ").concat(t.style.height/26,")")},className:"play"===n?"h5ds_sound-icon h5ds_sound-iconing":"h5ds_sound-icon"},D.a.createElement("i",null),D.a.createElement("i",null),D.a.createElement("i",null),D.a.createElement("i",null));break;case"null":r=null;break;default:r=D.a.createElement("img",{src:t.data.icon})}return D.a.createElement("div",{ref:function(t){return e.innerLayerRef=t},className:"layer-h5ds_sound-inner"},r,D.a.createElement("audio",{id:this.soundId,autoPlay:!1,preload:"preload",loop:t.data.loop},D.a.createElement("source",{src:t.data.sound,type:"audio/mpeg"})))}}]),n}(x.Component),se()(an.prototype,"doMusic",[be],Object.getOwnPropertyDescriptor(an.prototype,"doMusic"),an.prototype),se()(an.prototype,"clickMusic",[be],Object.getOwnPropertyDescriptor(an.prototype,"clickMusic"),an.prototype),an);function pn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var ln,un=function(e){w()(n,e);var t=pn(n);function n(e){var r;m()(this,n),(r=t.call(this,e)).storeAdd=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=Q.getStorage("H5DS_NO_SERVER_SOUNDS");t=t?t.split(","):[],t=[].concat(z()(t),z()(e.split(","))),r.setState({imgList:t}),Q.setStorage("H5DS_NO_SERVER_SOUNDS",t.join(","))},r.storeDel=function(e){var t=Q.getStorage("H5DS_NO_SERVER_SOUNDS");(t=t?t.split(","):[]).splice(e,1),r.setState({imgList:t}),Q.setStorage("H5DS_NO_SERVER_SOUNDS",t.join(","))},r.addImg=function(e){r.props.select({url:e})},r.delImg=function(e,t){e.stopPropagation(),r.storeDel(t)},r.addSource=function(){r.setState({value:""}),r.state.value?r.storeAdd(r.state.value):ke.Modal.error({title:"错误提示",content:"请先添加音频资源，多个音频链接使用','分割"})},r.onChangeText=function(e){r.setState({value:e.target.value})};var a=Q.getStorage("H5DS_NO_SERVER_SOUNDS");return a=a?a.split(","):[],r.state={imgList:a,value:""},r}return g()(n,[{key:"render",value:function(){var e=this,t=ke.Input.TextArea;return D.a.createElement("div",{className:"app-noserver-modal"},D.a.createElement("div",{className:"app-noserver-tips"},"未设置options.soundSourceModal参数，这里显示系统自带的音频管理器"),D.a.createElement("div",null,D.a.createElement(t,{value:this.state.value,onChange:this.onChangeText,rows:3,placeholder:"添加音频资源，多个音频链接使用','分割"}),D.a.createElement("br",null),D.a.createElement("br",null),D.a.createElement(ke.Button,{type:"primary",onClick:this.addSource},"添加音频资源")),D.a.createElement("div",{className:"app-noserver-imgs"},this.state.imgList.map((function(t,n){return D.a.createElement("div",{key:n,className:"app-noserver-item app-noserver-item-sound",onClick:function(){return e.addImg(t)}},D.a.createElement(ke.Icon,{onClick:function(t){e.delImg(t,n)},type:"close"}),D.a.createElement("audio",{className:"app-sound-controls",controls:!0},D.a.createElement("source",{src:t,type:"audio/mpeg"})),D.a.createElement(ke.Button,{type:"primary",onClick:function(){return e.props.select({url:t})}},"立即使用"))}))))}}]),n}(x.Component);function hn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}ln=function(e){w()(n,e);var t=hn(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).state={visible:!1},r}return g()(n,[{key:"hideModal",value:function(){this.setState({visible:!1})}},{key:"selectSound",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.selectSoundCallback&&this.selectSoundCallback(e),this.hideModal()}},{key:"componentDidMount",value:function(){var e=this;window.pubSubEditor.subscribe("h5ds.sound.modal.show",(function(t){var n=t.callback,r=void 0===n?null:n;e.selectSoundCallback=r,e.setState({visible:!0})}))}},{key:"componentWillUnmount",value:function(){window.pubSubEditor.unsubscribe("h5ds.sound.modal.show")}},{key:"render",value:function(){var e=this.props.scope.options,t=void 0===e?{}:e;return D.a.createElement(wt,{className:"app-modal-source",close:this.hideModal,title:D.a.createElement("div",null,"音乐库"," ",D.a.createElement(ke.Button,{onClick:this.hideModal,className:"app-modal-close-button"},"关闭窗口")),show:this.state.visible},t.soundSourceModal?D.a.createElement(t.soundSourceModal,{select:this.selectSound}):D.a.createElement(un,{select:this.selectSound}))}}]),n}(x.Component),se()(ln.prototype,"hideModal",[be],Object.getOwnPropertyDescriptor(ln.prototype,"hideModal"),ln.prototype),se()(ln.prototype,"selectSound",[be],Object.getOwnPropertyDescriptor(ln.prototype,"selectSound"),ln.prototype),n(480),n(482);function dn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var fn,yn=function(e){w()(n,e);var t=dn(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).getSpanStyle=function(e){var t=[],n={background:"background",backgroundClip:"-webkit-background-clip",color:"color",textFillColor:"-webkit-text-fill-color",textStroke:"text-stroke",opacity:"opacity",textShadow:"text-shadow",backgroundImage:"background-image",top:"top",left:"left",zIndex:"z-index"};for(var r in e)n[r]&&t.push("".concat(n[r],": ").concat(e[r]));return t.join(";")},e.getStyle=function(e,t,n){var r={},a={},o=null;switch(e){case"border":r.color=t[0],r.textFillColor="".concat(n,"px ").concat(t[0]),r.WebkitTextFillColor="".concat(n,"px ").concat(t[0]),a.textStroke="".concat(n,"px ").concat(t[1]),a.WebkitTextStroke="".concat(n,"px ").concat(t[1]);break;case"3d":r.color=t[0],r.textFillColor="".concat(n,"px ").concat(t[0]),r.WebkitTextFillColor="".concat(n,"px ").concat(t[0]),a.color=t[0],a.textShadow=new Array(n).fill(1).map((function(e,r){return r+1<n?"0px ".concat(r+1,"px 0px ").concat(t[1]):"0px ".concat(n,"px ").concat(n,"px ").concat(t[1])})).join(",");break;case"kaTong":r.color=t[0],r.background="url(data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAIAAAAmkwkpAAAAHklEQVQImWNkYGBgYGD4//8/A5wF5SBYyAr+//8PAPOCFO0Q2zq7AAAAAElFTkSuQmCC) repeat",r.textShadow="".concat(n/2,"px -").concat(n/2,"px ").concat(t[0],", ").concat(n/2,"px -").concat(n/2,"px white"),r.textFillColor="transparent",r.WebkitTextFillColor="transparent",r.backgroundClip="text",r.WebkitBackgroundClip="text",a.opacity=0;break;case"jiaXin":r.color=t[0],r.textFillColor="".concat(n,"px ").concat(t[0]),r.WebkitTextFillColor="".concat(n,"px ").concat(t[0]),a.textStroke="".concat(n,"px ").concat(t[1]),a.WebkitTextStroke="".concat(n,"px ").concat(t[1]),o={zIndex:99,textStroke:"".concat(n+n/2,"px ").concat(t[0]),WebkitTextStroke:"".concat(n+n/2,"px ").concat(t[0])};break;case"yinYing":r.color=t[0],r.textShadow="0px ".concat(n/2,"px ").concat(n/2,"px ").concat(t[1]),a.opacity=0;break;case"niHong":r.textStroke="1px ".concat(t[0]),r.WebkitTextStroke="1px ".concat(t[0]),r.color="transparent",a.color="transparent",a.textShadow="0px 0px ".concat(n,"px ").concat(t[0]);break;case"cuoJue":r.left=0,r.backgroundClip="text",r.WebkitBackgroundClip="text",r.textFillColor="transparent",r.WebkitTextFillColor="transparent",r.backgroundImage="linear-gradient(0deg, ".concat(t[1]," 50%, rgba(255, 255, 255, 0) 50%)"),a.left=-2,a.backgroundClip="text",a.WebkitBackgroundClip="text",a.textFillColor="transparent",a.WebkitTextFillColor="transparent",a.backgroundImage="linear-gradient(0deg, ".concat(t[2]," 100%, rgba(255, 255, 255, 0) 50%)"),o={zIndex:201,left:2,color:t[0]};break;case"jianBian":r.left=0,r.backgroundClip="text",r.WebkitBackgroundClip="text",r.textFillColor="transparent",r.WebkitTextFillColor="transparent",r.backgroundImage="linear-gradient(0deg, ".concat(t[0],", ").concat(t[1],", ").concat(t[2],")"),a.opacity=0;break;case"qieGe":r.backgroundClip="text",r.WebkitBackgroundClip="text",r.textFillColor="transparent",r.WebkitTextFillColor="transparent",r.backgroundImage="linear-gradient(0deg, ".concat(t[0]," 50%, rgba(255, 255, 255, 0) 50%)"),a.backgroundClip="text",a.WebkitBackgroundClip="text",a.textFillColor="transparent",a.WebkitTextFillColor="transparent",a.backgroundImage="linear-gradient(0deg, ".concat(t[1]," 100%, rgba(255, 255, 255, 0) 50%)");break;case"fire":r.color=t[0],a.opacity=0;break;case"snow":r.textFillColor=t[0],r.textFillColor=t[0],r.WebkitTextFillColor=t[0],a.color="#fff",a.textShadow="".concat(t[1]," 0px ").concat(n/2,"px ").concat(n/2,"px"),a.textStroke="".concat(n/2,"px ").concat(t[1]),a.WebkitTextStroke="".concat(n/2,"px ").concat(t[1]),o={zIndex:201,background:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAeCAYAAAARgF8NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpDOEJGMEM5MDMwRUYxMUU5OUU1QkJFMjJGQjU2M0JBMyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpDOEJGMEM5MTMwRUYxMUU5OUU1QkJFMjJGQjU2M0JBMyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkM4QkYwQzhFMzBFRjExRTk5RTVCQkUyMkZCNTYzQkEzIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkM4QkYwQzhGMzBFRjExRTk5RTVCQkUyMkZCNTYzQkEzIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+PM6S9AAAAFlJREFUeNpi/P///1cGBgYuIP4FxGwMEABjf2MEKvjPgAcwMRAAowqGm4JveOTBCQbEwJVoGCl3AwtSImVAS7QQO9DSLIzDSLIVDOg6aRfU/9EDjXJHAgQYAOqPGQ3i3HYXAAAAAElFTkSuQmCC) repeat-x",textFillColor:"transparent",WebkitTextFillColor:"transparent",backgroundClip:"text",WebkitBackgroundClip:"text"};break;case"louKong":r.top=-n/2,r.left=n/2,r.textStroke="1px ".concat(t[1]),r.WebkitTextStroke="1px ".concat(t[1]),r.textFillColor="transparent",r.WebkitTextFillColor="transparent",a.color=t[0]}return{upStyle:r,downStyle:a,otherStyle:o}},e}return g()(n,[{key:"render",value:function(){var e=this.props,t=e.type,n=e.size,r=void 0===n?10:n,a=e.colors,o=void 0===a?["#000"]:a,i=e.style,s=void 0===i?{}:i,c=e.shtml,p=["app-artword","app-artword-"+t],l=this.getStyle(t,o,r),u=l.upStyle,h=l.downStyle,d=l.otherStyle;return t?c?D.a.createElement("div",{style:s,className:p.join(" ")},D.a.createElement("div",{style:u,className:"app-artword-up",dangerouslySetInnerHTML:{__html:c}}),D.a.createElement("div",{style:h,className:"app-artword-down",dangerouslySetInnerHTML:{__html:c}}),d?D.a.createElement("div",{style:d,className:"app-artword-up",dangerouslySetInnerHTML:{__html:c}}):null):D.a.createElement("div",{style:s,className:p.join(" ")},D.a.createElement("div",{style:u,className:"app-artword-up"},this.props.children),D.a.createElement("div",{style:h,className:"app-artword-down"},this.props.children),d?D.a.createElement("div",{style:d,className:"app-artword-up"},this.props.children):null):D.a.createElement("div",{style:s,className:p.join(" "),dangerouslySetInnerHTML:{__html:c}})}}]),n}(x.PureComponent);function mn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var vn=(fn=function(e){w()(n,e);var t=mn(n);function n(){return m()(this,n),t.apply(this,arguments)}return g()(n,[{key:"emitChange",value:function(){var e=this.dom.innerHTML;this.props.onChange&&e!==this.lastHtml&&this.props.onChange({target:{value:e}}),this.lastHtml=e}},{key:"shouldComponentUpdate",value:function(e){return e.html!==this.dom.innerHTML}},{key:"componentDidMount",value:function(){$(this.dom).off("paste").on("paste",(function(e){e.preventDefault();var t=e.originalEvent.clipboardData.getData("text/plain");document.execCommand("insertText",!1,t)}))}},{key:"componentWillUnmount",value:function(){$(this.dom).off("paste")}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.html;return D.a.createElement("div",{ref:function(t){return e.dom=t},className:n||"",onInput:this.emitChange,onBlur:this.emitChange,contentEditable:!0,dangerouslySetInnerHTML:{__html:r}})}}]),n}(x.Component),se()(fn.prototype,"emitChange",[be],Object.getOwnPropertyDescriptor(fn.prototype,"emitChange"),fn.prototype),fn),gn=(n(484),n(486),n(490),n(577)),bn=n.n(gn),wn=n(496),kn=n.n(wn);function En(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var On,Sn=function(e){w()(n,e);var t=En(n);function n(e){return m()(this,n),t.call(this,e)}return g()(n,[{key:"render",value:function(){var e=this.props,t=e.value,n=void 0===t?0:t,r=e.onChange,a=e.parser,o=void 0===a?void 0:a,i=e.formatter,s=void 0===i?void 0:i,c=e.name,p=void 0===c?"":c,l=e.min,u=void 0===l?0:l,h=e.max,d=void 0===h?100:h,f=e.step,y=void 0===f?1:f,m=e.size,v=void 0===m?"default":m,g=e.mouseWheelClassName,b=void 0===g?"":g;return D.a.createElement("div",{className:"app-util-sliderinput "+("small"===v?"app-util-sliderinput2":"")},p?D.a.createElement("label",{className:"app-util-sliderinput-name"},p):null,D.a.createElement(kn.a,{onChange:r,tipFormatter:null,min:u,step:y,max:d,value:n}),D.a.createElement(bn.a,{className:b,step:y,size:"small",min:u,max:d,parser:o,formatter:s,value:n||0,onChange:r}))}}]),n}(x.Component),xn=[{name:"快闪",interval:"0.05s",type:"in",animate:"fastShow",time:"0.1s",delay:"0s",count:1,fun:"linear"},{name:"缩小入",interval:"0.05s",type:"in",animate:"smallIn",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"弹入",interval:"0.05s",type:"in",animate:"bounceIn",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"上弹入",interval:"0.05s",type:"in",animate:"bounceInDown",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"左弹入",interval:"0.05s",type:"in",animate:"bounceInLeft",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"右弹入",interval:"0.05s",type:"in",animate:"bounceInRight",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"下弹入",interval:"0.05s",type:"in",animate:"bounceInUp",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"渐显",interval:"0.05s",type:"in",animate:"fadeIn",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"上渐显",interval:"0.05s",type:"in",animate:"fadeInDown",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"上远渐显",interval:"0.05s",type:"in",animate:"fadeInDownBig",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"左渐显",interval:"0.05s",type:"in",animate:"fadeInLeft",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"左远渐显",interval:"0.05s",type:"in",animate:"fadeInLeftBig",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"右渐入",interval:"0.05s",type:"in",animate:"fadeInRight",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"右远渐入",interval:"0.05s",type:"in",animate:"fadeInRightBig",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"下渐入",interval:"0.05s",type:"in",animate:"fadeInUp",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"下远渐入",interval:"0.05s",type:"in",animate:"fadeInUpBig",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"X翻牌",interval:"0.05s",type:"in",animate:"flipInX",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"Y翻牌",interval:"0.05s",type:"in",animate:"flipInY",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"光速入",interval:"0.05s",type:"in",animate:"lightSpeedIn",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"滚入",interval:"0.05s",type:"in",animate:"rotateIn",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"左上滚入",interval:"0.05s",type:"in",animate:"rotateInDownLeft",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"右上滚入",interval:"0.05s",type:"in",animate:"rotateInDownRight",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"左下滚入",interval:"0.05s",type:"in",animate:"rotateInUpLeft",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"右下滚入",interval:"0.05s",type:"in",animate:"rotateInUpRight",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"下滑入",interval:"0.05s",type:"in",animate:"slideInUp",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"上滑入",interval:"0.05s",type:"in",animate:"slideInDown",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"左滑入",interval:"0.05s",type:"in",animate:"slideInLeft",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"右滑入",interval:"0.05s",type:"in",animate:"slideInRight",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"放大",interval:"0.05s",type:"in",animate:"zoomIn",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"从上放大",interval:"0.05s",type:"in",animate:"zoomInDown",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"从左放大",interval:"0.05s",type:"in",animate:"zoomInLeft",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"从右放大",interval:"0.05s",type:"in",animate:"zoomInRight",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"从下放大",interval:"0.05s",type:"in",animate:"zoomInUp",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"左滚入",interval:"0.05s",type:"in",animate:"rollIn",time:"1s",delay:"0s",count:1,fun:"ease"}],Dn=[12,14,16,18,20,22,24,26,28,30,32,34,36,38,42,48,60,72,84,96,108,120,132,144,156,168,180,192,204,216,228,240,252,264,276,288,300,312,324,336,348,360,372,384,396,408,420,432,444,456,468,480,492],Pn=[{name:"默认字体",url:""},{name:"站酷高端黑",url:"/assets/fonts/站酷高端黑.TTF"},{name:"站酷快乐体",url:"/assets/fonts/站酷快乐体.TTF"}],jn=function(e){return new Promise((function(t,n){var r=(Pn.find((function(t){return t.name===e}))||{}).url;if(r){var a=new XMLHttpRequest;a.open("get",r),a.responseType="blob",a.onprogress=function(e){if(e.lengthComputable)e.loaded,e.total},a.onload=function(n){200==n.target.status&&t(e)},a.ontimeout=function(){ke.message.error("请求超时！"),n(!1)},a.send()}else t(e)}))};function Cn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Rn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cn(Object(n),!0).forEach((function(t){C()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function In(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var Nn,Ln=[{type:"3d",name:"3D",colors:["#ffab00","#67490d"]},{type:"kaTong",name:"卡通",colors:["#4e1515"]},{type:"jiaXin",name:"夹心",colors:["#bf2929","#fff"]},{type:"yinYing",name:"阴影",colors:["#3c9df3","#12e686"]},{type:"niHong",name:"霓虹",colors:["#f33c3c"]},{type:"border",name:"边框",colors:["#fff","#3c5ef3"]},{type:"cuoJue",name:"错觉",colors:["#000","#ff1dff","#4affff"]},{type:"jianBian",name:"渐变",colors:["#fff","#1d24ff","#00efff"]},{type:"qieGe",name:"切割",colors:["#9075ff","#e227b1"]},{type:"fire",name:"火焰",colors:["#F00"]},{type:"snow",name:"冰雪",colors:["#9dffff","#98e7ff"]},{type:"louKong",name:"镂空",colors:["#ff7c7c","#de0000"]}],An=(On=function(e){w()(r,e);var t,n=In(r);function r(e){var t;m()(this,r),(t=n.call(this,e)).renderLayer=Q.debounce(t.renderLayerAsyncFlase,100),t.changeText=Q.debounce((function(e){t.props.layer.data.data=e.target.value,t.calibration()}),500);var a=Object(Ee.toJS)(e.layer.data)||{};return t.state={html:a.data,fontFamilySet:a.fontFamilySet||{},style:a.style||{},animate:a.animate,artword:a.artword||{},artwordKey:Q.randomID(),fontLoading:!1},t.unmount=!1,t}return g()(r,[{key:"renderLayerAsyncFlase",value:function(){var e=this,t=this.props.layer,n=this.state,r=n.style,a=n.animate,o=n.artword,i=n.fontFamilySet;Object(Ee.transaction)((function(){t.data.fontFamilySet=Rn({},i),t.data.style=Rn({},r),t.data.animate=a?Rn({},a):"",t.data.artword=Q.cloneDeep(o),e.calibration()}))}},{key:"calibration",value:function(){var e=this;Object(Ee.transaction)((function(){e.props.h5ds.edata.keys=Q.randomID();var t=e.props.h5ds.getLayerDom();t&&(e.editAuto=t.find(".layer-h5ds_text-auto"),e.editAuto&&(e.props.layer.style.height=e.editAuto.height(),window.pubSubEditor.publish("h5ds.initControl"),window.pubSubEditor.publish("h5ds.setHistory")))}))}},{key:"setClassName",value:function(e){var t=["app-ex-h5ds_text-btn"];return e&&t.push("app-active"),t.join(" ")}},{key:"fontWeight",value:function(){var e=this.state.style;"bold"===e.fontWeight?e.fontWeight="normal":e.fontWeight="bold",this.setState({style:e},this.renderLayer)}},{key:"fontStyle",value:function(e){var t=this.state.style;t.fontStyle===e?t.fontStyle="normal":t.fontStyle=e,this.setState({style:t},this.renderLayer)}},{key:"fontDecoration",value:function(e){var t=this.state.style;t.textDecoration===e?t.textDecoration="none":t.textDecoration=e,this.setState({style:t},this.renderLayer)}},{key:"textAlign",value:function(e){var t=this.state.style;t.textAlign===e?t.textAlign="normal":t.textAlign=e,this.setState({style:t},this.renderLayer)}},{key:"setFontSize",value:function(e){var t=this.state.style;t.fontSize=e,this.setState({style:t},this.renderLayer)}},{key:"setFontColor",value:function(e){var t=e.rgb,n=t.r,r=t.g,a=t.b,o=t.a,i=this.state.style;i.color="rgba(".concat(n,",").concat(r,",").concat(a,",").concat(o,")"),this.setState({style:i},this.renderLayer)}},{key:"changeFontSpace",value:function(e){var t=this.state.style;t.letterSpacing=e,this.setState({style:t},this.renderLayerAsyncFlase)}},{key:"changeFontLineHeight",value:function(e){var t=this.state.style;t.lineHeight=e,this.setState({style:t},this.renderLayerAsyncFlase)}},{key:"selectAnimate",value:function(e){for(var t={},n=0;n<xn.length;n++)if(xn[n].animate===e){t=Rn({},xn[n]);break}this.setState({animate:t},this.renderLayerAsyncFlase)}},{key:"loadFontFamily",value:(t=f()(h.a.mark((function e(t){var n=this;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({fontLoading:!0}),e.next=3,jn(t).then((function(e){var t=n.state,r=t.style,a=t.fontFamilySet;r.fontFamily=e,a="默认字体"!==e?Pn.filter((function(t){return t.name===e}))[0]:{name:"默认字体",url:""},n.setState({style:r,fontFamilySet:a,fontLoading:!1},n.renderLayerAsyncFlase)}));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"setAnimate",value:function(e,t){var n=this.state.animate;n[t]="fun"!==t?e+"s":e,this.setState({animate:n},this.renderLayerAsyncFlase)}},{key:"onSwitchAnimate",value:function(e){var t="";e&&(t=Rn({},xn[0])),this.setState({animate:t},this.renderLayer)}},{key:"onSwitchArtWord",value:function(e){var t=null;t=e?Rn({},Ln[0]):{type:"",name:"",colors:[]},this.setState({artword:t},this.renderLayer)}},{key:"selectArtWord",value:function(e){this.props.layer.data.artword=Q.cloneDeep(e),this.setState({artword:Q.cloneDeep(e),artwordKey:Q.randomID()},this.renderLayer)}},{key:"onChangeArtWordSize",value:function(e){var t=this.state.artword;t.size=e,this.setState({artword:t},this.renderLayer)}},{key:"setArtWordColor",value:function(e,t){var n=e.rgb,r=n.r,a=n.g,o=n.b,i=n.a,s="rgba(".concat(r,",").concat(a,",").concat(o,",").concat(i,")"),c=this.state.artword;c.colors[t]=s,this.setState({artword:c},this.renderLayer)}},{key:"loadFontSource",value:function(){var e=this,t=this.state.style,n=t.fontFamily,r=t.fontFamilySet;this.setState({fontLoading:!0}),jn(n).then((function(t){r="默认字体"!==t?Pn.filter((function(e){return e.name===t}))[0]:{name:"默认字体",url:""},e.unmount||e.setState({fontFamilySet:r,fontLoading:!1},e.renderLayerAsyncFlase)}))}},{key:"componentDidMount",value:function(){this.loadFontSource()}},{key:"componentWillUnmount",value:function(){this.unmount=!0}},{key:"render",value:function(){var e=ke.Select.Option,t=this.state.style,n=(t.fontWeight,t.textAlign,t.textDecoration,t.fontStyle,t.color),r=void 0===n?"rgba(0,0,0,1)":n,a=t.fontSize,o=void 0===a?"14px":a,i=(t.lineHeight,t.letterSpacing,t.fontFamily,this.state.animate||{}),s=(i.animate,i.time,i.delay,i.interval,i.fun,this.state.artword);return D.a.createElement("div",{key:this.props.keyid},D.a.createElement(Nt,null,D.a.createElement(vn,{className:"app-ex-h5ds_text-richtext",onChange:this.changeText,html:this.state.html})),D.a.createElement(_t,{name:"字体大小"},D.a.createElement(ke.Select,{key:o,onChange:this.setFontSize,size:"small",value:o||"14px",style:{width:120}},Dn.map((function(t){return D.a.createElement(e,{key:t,value:t+"px"},t,"px")})))),s.type?null:D.a.createElement(_t,{name:"字体颜色"},D.a.createElement(Rt,{onChange:this.setFontColor,color:r})))}}]),r}(x.Component),se()(On.prototype,"renderLayerAsyncFlase",[be],Object.getOwnPropertyDescriptor(On.prototype,"renderLayerAsyncFlase"),On.prototype),se()(On.prototype,"calibration",[be],Object.getOwnPropertyDescriptor(On.prototype,"calibration"),On.prototype),se()(On.prototype,"setClassName",[be],Object.getOwnPropertyDescriptor(On.prototype,"setClassName"),On.prototype),se()(On.prototype,"fontWeight",[be],Object.getOwnPropertyDescriptor(On.prototype,"fontWeight"),On.prototype),se()(On.prototype,"fontStyle",[be],Object.getOwnPropertyDescriptor(On.prototype,"fontStyle"),On.prototype),se()(On.prototype,"fontDecoration",[be],Object.getOwnPropertyDescriptor(On.prototype,"fontDecoration"),On.prototype),se()(On.prototype,"textAlign",[be],Object.getOwnPropertyDescriptor(On.prototype,"textAlign"),On.prototype),se()(On.prototype,"setFontSize",[be],Object.getOwnPropertyDescriptor(On.prototype,"setFontSize"),On.prototype),se()(On.prototype,"setFontColor",[be],Object.getOwnPropertyDescriptor(On.prototype,"setFontColor"),On.prototype),se()(On.prototype,"changeFontSpace",[be],Object.getOwnPropertyDescriptor(On.prototype,"changeFontSpace"),On.prototype),se()(On.prototype,"changeFontLineHeight",[be],Object.getOwnPropertyDescriptor(On.prototype,"changeFontLineHeight"),On.prototype),se()(On.prototype,"selectAnimate",[be],Object.getOwnPropertyDescriptor(On.prototype,"selectAnimate"),On.prototype),se()(On.prototype,"loadFontFamily",[be],Object.getOwnPropertyDescriptor(On.prototype,"loadFontFamily"),On.prototype),se()(On.prototype,"setAnimate",[be],Object.getOwnPropertyDescriptor(On.prototype,"setAnimate"),On.prototype),se()(On.prototype,"onSwitchAnimate",[be],Object.getOwnPropertyDescriptor(On.prototype,"onSwitchAnimate"),On.prototype),se()(On.prototype,"onSwitchArtWord",[be],Object.getOwnPropertyDescriptor(On.prototype,"onSwitchArtWord"),On.prototype),se()(On.prototype,"selectArtWord",[be],Object.getOwnPropertyDescriptor(On.prototype,"selectArtWord"),On.prototype),se()(On.prototype,"onChangeArtWordSize",[be],Object.getOwnPropertyDescriptor(On.prototype,"onChangeArtWordSize"),On.prototype),se()(On.prototype,"setArtWordColor",[be],Object.getOwnPropertyDescriptor(On.prototype,"setArtWordColor"),On.prototype),se()(On.prototype,"loadFontSource",[be],Object.getOwnPropertyDescriptor(On.prototype,"loadFontSource"),On.prototype),On);function _n(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var Tn=(Nn=function(e){w()(n,e);var t=_n(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).state={keys:Q.randomID()},r}return g()(n,[{key:"selectText",value:function(e){if(document.body.createTextRange){var t=document.body.createTextRange();t.moveToElementText(e),t.select()}else if(window.getSelection){var n=window.getSelection(),r=document.createRange();if(!r)return!1;r.selectNodeContents(e),n.removeAllRanges(),n.addRange(r)}else console.error("selectText none")}},{key:"dbclickEvent",value:function(){var e=this;$("#h5dsCanvas").on("dblclick.texteditor",".app-control",(function(t){var n=e.props,r=n.h5ds,a=n.layer;e.$layer=r.getLayerDom(),e.control=$(t.target),e.control.css("z-index","-1"),e.editAuto=e.$layer.find(".layer-h5ds_text-auto"),e.editAuto.html(a.data.data),e.editAuto.attr("contenteditable","true"),e.selectText(e.editAuto[0]),e.editAuto.off("blur").on("blur",(function(t){t.stopPropagation(),Object(Ee.transaction)((function(){var t=e.editAuto.html();e.props.layer.style.height=e.editAuto.height(),e.props.layer.data.data=t,e.props.layer.data.keyid=Q.randomID(),e.props.h5ds.edata.keys=Q.randomID(),$(".app-ex-h5ds_text-richtext")[0]&&$(".app-ex-h5ds_text-richtext").html(t),window.pubSubEditor.publish("h5ds.setHistory")}))})),e.editAuto.off("paste").on("paste",(function(e){e.preventDefault();var t=e.originalEvent.clipboardData.getData("text/plain");document.execCommand("insertText",!1,t)}))}))}},{key:"scaleEvent",value:function(){var e=this,t=this.props,n=t.h5ds,r=t.layer;this.$layer=n.getLayerDom(),this.$layer.on("controlStart.h5ds.text",(function(t,n){e.startHeight=n?n.height:null,e.fontSize=parseInt(r.data.style.fontSize,10),e.layerBox=e.$layer.find(".layer-h5ds_text-auto")})),this.$layer.on("controlResizeTick.h5ds.text",(function(t,n){if(e.moveHeight=n?n.height:null,e.startHeight&&e.moveHeight){var r=e.startHeight/e.moveHeight,a=e.fontSize/r;e.layerBox.css("font-size",(a<12?12:a)+"px")}})),this.$layer.on("controlEnd.h5ds.text",(function(t,n){if(n){e.endHeight=n?n.height:null;var a=e.startHeight/e.endHeight,o=e.fontSize/a;o=parseInt(o<12?12:o,10)+"px",r.data.style.fontSize=o,setTimeout((function(){e.editAuto=e.$layer.find(".layer-h5ds_text-auto"),e.editAuto&&(r.style.height=e.editAuto.height(),window.pubSubEditor.publish("h5ds.setHistory"),e.setState({keys:Q.randomID()}))})),e.editorSetRef.setFontSize(o)}}))}},{key:"componentDidMount",value:function(){this.dbclickEvent(),this.scaleEvent()}},{key:"componentWillUnmount",value:function(){$("#h5dsCanvas").off("dblclick.texteditor"),this.layerBox=null,this.editAuto&&(this.editAuto.removeAttr("contenteditable"),this.editAuto.off("blur"),this.editAuto.off("paste"),this.editAuto.off("input"),this.editAuto=null),this.control&&(this.control.removeAttr("style"),this.control=null),this.$layer&&(this.$layer.off("controlStart.h5ds.text"),this.$layer.off("controlResizeTick.h5ds.text"),this.$layer.off("controlEnd.h5ds.text"),this.$layer=null)}},{key:"render",value:function(){var e=this,t=this.state.keys;return D.a.createElement("div",{className:"app-ex-h5ds_text"},D.a.createElement(An,{ref:function(t){return e.editorSetRef=t},h5ds:this.props.h5ds,keyid:t,app:this.props.app,layer:this.props.layer}))}}]),n}(x.Component),se()(Nn.prototype,"dbclickEvent",[be],Object.getOwnPropertyDescriptor(Nn.prototype,"dbclickEvent"),Nn.prototype),se()(Nn.prototype,"scaleEvent",[be],Object.getOwnPropertyDescriptor(Nn.prototype,"scaleEvent"),Nn.prototype),Nn),zn=function(){function e(){m()(this,e),this.id=null,this.className=null,this.animate=[],this.data={data:"请输入文本内容",fontFamilySet:{name:"默认字体",url:""},style:{letterSpacing:"normal",color:"rgba(0,0,0,1)",textDecoration:"normal",textAlign:"left",fontFamily:"默认字体",fontSize:"18px"},artword:{type:"",name:"",colors:[]},animate:""},this.style={width:132,height:this.setLineHeight(),top:0,left:0},this.estyle={},this.events=[]}return g()(e,[{key:"setLineHeight",value:function(){var e=parseInt(this.data.style.fontSize,10);return e/2+e}}]),e}(),Hn=D.a.createElement("i",{className:"app-ico app-ico-wenben"}),$n=(n(585),{name:"文本",pid:"h5ds_text",version:"1.0.0"});function Wn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Mn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wn(Object(n),!0).forEach((function(t){C()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Bn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var Fn=function(e){w()(n,e);var t=Bn(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).getHtml=function(t,n){var r="";if(t=(t=(t=(t=(t=t.replace(/&nbsp;/g,"⑴")).replace(/&quot;/g,"⑵")).replace(/&amp;/g,"⑶")).replace(/&lt;/g,"⑷")).replace(/&gt;/g,"⑸"),n){var a=0,o=!1;t.split("").forEach((function(t){if("<"===t&&(o=!0),o)r+=t;else{var i=parseFloat(n.delay)+parseFloat(n.interval)*a;a++,r+='<span class="animated" style="animation: '.concat(n.animate," ").concat(n.time," ").concat(n.fun," ").concat(i,"s ").concat(n.count,' normal forwards running;\n        opacity: 0">').concat(e.filterHtml(t),"</span>")}">"===t&&(o=!1)}))}else{var i=!1;t.split("").forEach((function(t){"<"===t&&(i=!0),r+=i?t:"<span>".concat(e.filterHtml(t),"</span>"),">"===t&&(i=!1)}))}return r},e}return g()(n,[{key:"filterHtml",value:function(e){switch(e){case" ":case"⑴":e="&nbsp;";break;case"⑵":e="&quot;";break;case"⑶":e="&amp;";break;case"⑷":e="&lt;";break;case"⑸":e="&gt;"}return e}},{key:"render",value:function(){var e=this.props.layer.data,t=e.style,n=e.keyid,r=void 0===n?"":n,a=e.data,o=void 0===a?"":a,i=e.artword,s=void 0===i?{}:i,c=e.animate,p=e.fontFamilySet,l=void 0===p?{}:p,u=this.getHtml(o,c),h="@font-face {\n      font-family: ".concat(l.name,";\n      src: url(").concat(l.url,");\n    }");return s.type&&delete t.color,D.a.createElement("div",{className:"layer-h5ds_text-inner"},D.a.createElement("div",{className:"layer-h5ds_text-box",key:r},s.type?D.a.createElement("div",{className:"layer-h5ds_text-auto",style:Mn({},t)},D.a.createElement(yn,oe()({shtml:u},s))):D.a.createElement("div",{className:"layer-h5ds_text-auto",style:Mn({},t),dangerouslySetInnerHTML:{__html:u}}),l.url?D.a.createElement("style",null,h):null))}}]),n}(x.Component);window.pubSubLayer||(window.pubSubLayer=new I.a,window.pubSubLayer.publish=window.pubSubLayer.publishSync);window.pubSubLayer;function Vn(e){return e.map((function(e){switch(e.type){case"img":e.pid="h5ds_img",e.name="图片",e.version="1.0.0";var t=e.data,n=t.crop,r=t.src;e.data={naturalWidth:200,naturalHeight:150,crop:n,src:r};break;case"etext":e.pid="h5ds_text",e.name="文本",e.version="1.0.0";break;case"map":e.pid="app-map",e.name="地图",e.version="1.0.0",e.data.title=e.data.name,delete e.data.infoshow,delete e.data.info;break;case"shape":e.pid="h5ds_shape",e.name="形状";break;case"input":case"submit":var a=e.estyle.backgroundColor;e.pid="h5ds_shape",e.name="形状",e.estyle={},e.version="1.0.0",e.data={shape:"path4",style:{fill:a},transform:"scale(1, 1)"};break;case"sound":e.pid="h5ds_sound",e.name="音频",e.data.icon="",e.version="1.0.0",e.data.autoplay=!0,e.data.loop=!1;break;case"effectcss":e.pid="app-css-effect",e.name="css特效",e.version="1.0.0",e.data={type:"snow",set:{img:"http://cdn.h5ds.com/static/images/snow.png"}};break;case"combin":e.pid="h5ds_combin",e.name="合并层",e.layers&&(e.version="1.0.0",e.events=[],e.data=e.layers,delete e.layers,delete e.color,delete e.eid,Vn(e.data))}return"形状"===e.name&&(e.pid="h5ds_shape"),e.version="1.0.0",e.events=[],delete e.color,delete e.eid,e})),e}var Gn=function(){function e(t){m()(this,e),this.progress=null,t&&(this.manifest=this.setSource(t)),this.sources=t}var t;return g()(e,[{key:"imgLazy",value:function(e){return new Promise((function(t,n){var r=new Image;r.src=e,r.onload=function(){t(r)},r.onerror=function(){console.error("图片加载失败",r),n(r)}}))}},{key:"soundLazy",value:function(e){return new Promise((function(t,n){var r=new Audio(e);r.onloadedmetadata=function(){t(r)},r.onerror=function(){console.error("sound加载失败",e),n(e)},r.src=e}))}},{key:"jsLazy",value:function(e,t){return new Promise((function(n,r){if(t&&document.getElementById(t))n(!0);else{var a=document.createElement("script");a.type="text/javascript",a.charset="utf-8",a.async="async",a.id=t,a.src=e,document.head.appendChild(a),a.onload=function(){n(a)},a.onerror=function(){console.error("js加载失败",e),r(e)}}}))}},{key:"cssLazy",value:(t=f()(h.a.mark((function e(t,n){var r,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",!1);case 2:if(!n||!document.getElementById(n)){e.next=5;break}return e.abrupt("return");case 5:r=document.getElementsByTagName("head")[0],(a=document.createElement("link")).type="text/css",a.rel="stylesheet",a.id=n,a.href=t,r.appendChild(a);case 12:case"end":return e.stop()}}),e)}))),function(e,n){return t.apply(this,arguments)})},{key:"load",value:function(){var e=this,t=this.manifest;return new Promise(function(){var n=f()(h.a.mark((function n(r,a){var o,i,s,c;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=[],i=[],s=h.a.mark((function n(r){var a,s,c,p;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:a=t[r],s=a.src,c=a.id,p=a.type,n.t0=p,n.next="image"===n.t0?4:"js"===n.t0?7:"sound"===n.t0?10:"css"===n.t0?13:15;break;case 4:return n.next=6,e.imgLazy(s).then((function(){i.push({src:s,id:c,type:p}),e.progress&&e.progress({src:s,id:c,type:p,success:!0,loaded:(r+1)/t.length})})).catch((function(){o.push({src:s,id:c,type:p}),e.progress&&e.progress({src:s,id:c,type:p,success:!1,loaded:(r+1)/t.length})}));case 6:return n.abrupt("break",15);case 7:return n.next=9,e.jsLazy(s,c).then((function(){i.push({src:s,id:c,type:p}),e.progress&&e.progress({src:s,id:c,type:p,success:!0,loaded:(r+1)/t.length})})).catch((function(){o.push({src:s,id:c,type:p}),e.progress&&e.progress({src:s,id:c,type:p,success:!1,loaded:(r+1)/t.length})}));case 9:return n.abrupt("break",15);case 10:return n.next=12,e.soundLazy(s).then((function(){i.push({src:s,id:c,type:p}),e.progress&&e.progress({src:s,id:c,type:p,success:!0,loaded:(r+1)/t.length})})).catch((function(){o.push({src:s,id:c,type:p}),e.progress&&e.progress({src:s,id:c,type:p,success:!1,loaded:(r+1)/t.length})}));case 12:return n.abrupt("break",15);case 13:return e.cssLazy(s,c),n.abrupt("break",15);case 15:case"end":return n.stop()}}),n)})),c=0;case 4:if(!(c<t.length)){n.next=9;break}return n.delegateYield(s(c),"t0",6);case 6:c++,n.next=4;break;case 9:e.complete&&e.complete({error:o,success:i}),i.length===t.length?(e.success&&e.success(),r({error:o,success:i})):(e.error&&e.error(),a({error:o,success:i}));case 11:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())}},{key:"on",value:function(e,t){switch(e){case"progress":this.progress=t;break;case"error":this.error=t;break;case"complete":this.complete=t;break;case"success":this.success=t}}},{key:"setSource",value:function(e){if(e){var t=e.map((function(e,t){var n="*",r=e.replace(/.+\.(.+)/,"$1");return-1!==["jpg","gif","png","jpeg"].indexOf(r)?n="image":-1!==["mp3","wav","ogg","acc","webm"].indexOf(r)?n="sound":-1!==["js","es"].indexOf(r)?n="js":-1!==["css"].indexOf(r)&&(n="css"),{src:e,id:"source_"+t,type:n}}));return this.manifest=t,t}}}]),e}(),Un=n(182);function Yn(){return Jn.apply(this,arguments)}function Jn(){return(Jn=f()(h.a.mark((function e(){var t,n=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.length>0&&void 0!==n[0]?n[0]:l,z()(Object.values(t)).forEach((function(e){if(e.config)for(var t in e.config)e[t]=e.config[t];else console.error("插件必须包括config文件，具体配置查看官方文档doc.h5ds.com",e);Object(Un.mountPlugin)(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function qn(){return Xn.apply(this,arguments)}function Xn(){return(Xn=f()(h.a.mark((function e(){var t,n,r,a,o,i,s,c,p,l=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=l.length>0&&void 0!==l[0]?l[0]:[],n=l.length>1&&void 0!==l[1]?l[1]:"",r=l.length>2&&void 0!==l[2]?l[2]:"layer",a=new Gn,o=0;o<t.length;o++)(i=t[o])&&a.cssLazy("".concat(n,"/plugins/").concat(i,"/").concat(r,"/style.css"),"css_".concat(i));s=0;case 6:if(!(s<t.length)){e.next=16;break}if(!(c=t[s])){e.next=13;break}return p="".concat(n,"/plugins/").concat(c,"/").concat(r,"/index.js"),e.next=12,a.jsLazy(p,"js_".concat(c));case 12:window.pubSubLayer&&window.pubSubLayer.publish("h5ds.load.plugins",{count:t.length,index:s+1,progress:(s+1)/t.length,name:p,type:"plugin"});case 13:s++,e.next=6;break;case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Kn(){return Qn.apply(this,arguments)}function Qn(){return(Qn=f()(h.a.mark((function e(){var t,n,r,a,o,i,s,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],n=window.H5DS_GLOBAL.plugins,r=void 0===n?{}:n,Object.keys(window.H5DS_GLOBAL.plugins),z()(Object.values(r)).forEach((function(e){if(e.config){for(var n in e.config)e[n]=e.config[n];t=[].concat(z()(t),z()(e.scripts||[]))}else console.error("插件必须包括config文件，具体配置查看官方文档doc.h5ds.com",e)})),t=Array.from(new Set(t)).filter((function(e){return e})),a=new Gn,o=0;case 8:if(!(o<t.length)){e.next=18;break}return i=t[o],e.next=12,a.jsLazy(i,i);case 12:s={count:t.length,index:o+1,progress:(o+1)/t.length,name:i,type:"script"},window.pubSubLayer&&window.pubSubLayer.publish("h5ds.load.scripts",s),window.pubSubEditor&&window.pubSubEditor.publish("h5ds.load.scripts",s);case 15:o++,e.next=8;break;case 18:window.H5DS_GLOBAL.plugins=r,window.H5DS_GLOBAL.scripts=t,c={count:t.length,index:t.length,progress:1,name:"",type:"script"},window.pubSubLayer&&window.pubSubLayer.publish("h5ds.load.plugins",c),window.pubSubEditor&&window.pubSubEditor.publish("h5ds.load.plugins",c);case 23:case"end":return e.stop()}}),e)})))).apply(this,arguments)}new(function(){function e(){m()(this,e)}return g()(e,[{key:"getPid",value:function(e,t){var n=this;e&&e.forEach((function(e){t.push(e.pid),"h5ds_combin"===e.pid&&n.getPid(e.data,t)}))}},{key:"getPidByPageData",value:function(e){var t=[];return this.getPid(e.layers,t),(t=(t=Array.from(new Set(t))).filter((function(e){return!["h5ds_combin","h5ds_img","h5ds_shape","h5ds_sound","h5ds_text"].includes(e)}))).filter((function(e){return e}))}},{key:"getPidByData",value:function(e){var t=this,n=[],r=e.pages,a=void 0===r?[]:r,o=e.fixeds,i=void 0===o?[]:o,s=e.popups,c=void 0===s?[]:s;return[].concat(z()(a),z()(i),z()(c)).forEach((function(e){t.getPid(e.layers,n)})),(n=(n=Array.from(new Set(n))).filter((function(e){return!["h5ds_combin","h5ds_img","h5ds_shape","h5ds_sound","h5ds_text"].includes(e)}))).filter((function(e){return e}))}}]),e}());var Zn,er=n(587),tr=n.n(er),nr=(new(function(){function e(){m()(this,e),this.baseData={},this.reportUrl=location.href}return g()(e,[{key:"setReportUrl",value:function(e){this.reportUrl=e}},{key:"setUid",value:function(e){this.reportUrl.uid=e}},{key:"setAppId",value:function(e){this.baseData.appId=e}},{key:"doReport",value:function(e,t){if(!e)throw new Error("请设置上报地址");t=Object.assign({},t,this._getBaseData(),this.baseData),window.navigator.sendBeacon?this._doReportBySendBeacon(e,t):this._doReportByImg(e,t)}},{key:"_data2QueryString",value:function(e){var t=tr()("");return t.set("query",e),t.href.split("?")[1]}},{key:"_getBaseData",value:function(){return{nl:navigator.language,np:navigator.platform,nje:navigator.javaEnabled(),nmtp:navigator.maxTouchPoints,nce:navigator.cookieEnabled,nd:navigator.doNotTrack,ndm:navigator.deviceMemory,ndc:navigator.hardwareConcurrency,sr:"".concat(screen.width,"*").concat(screen.height),scd:screen.colorDepth,dc:document.charset||document.characterSet,dr:document.referrer,t:Date.now()}}},{key:"_makeRndString",value:function(){return Math.random().toString(16)}},{key:"_doReportByImg",value:function(e,t){var n="".concat(e,"?").concat(this._data2QueryString(t)),r="report_img_".concat(this._makeRndString()),a=window[r]=new Image;a.onload=a.onerror=function(){window[r]=null},a.src=n}},{key:"_doReportBySendBeacon",value:function(e,t){var n=new FormData;Object.keys(t).forEach((function(e){return n.append(e,t[e])})),window.navigator.sendBeacon(e,n)}},{key:"sendPageView",value:function(){var e=location.pathname;this.doReport(this.reportUrl,{path:e})}}]),e}()),n(590),function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;m()(this,e),this.set=Object.assign({gap:5},t),this.$lines=n||$(".app-adsorb-line"),this.$outbox=r||$("#h5dsCanvasApp"),this.lines={xt:this.$lines.eq(0),xc:this.$lines.eq(1),xb:this.$lines.eq(2),yl:this.$lines.eq(3),yc:this.$lines.eq(4),yr:this.$lines.eq(5)},this.scale=parseFloat($(".app-canvas-box").transform("scale"))||1,this.canvasRect=this.$outbox[0].getBoundingClientRect()}return g()(e,[{key:"correct",value:function(e){var t=this,n=[];return e.each((function(e,r){var a=$(r).transform("rotate"),o=$(r).find(".app-adsorb-layer-item");if(a&&!o[0]){var i=r.getBoundingClientRect(),s=i.top,c=i.left,p=i.right,l=i.bottom,u=i.width,h=i.height;$(r).append('<div class="app-adsorb-layer-item" style="\n        left: '.concat(-(p-c-r.offsetWidth)/2,"px;\n        top: ").concat(-(l-s-r.offsetHeight)/2,"px;\n        width: ").concat(u,"px;\n        height: ").concat(h,"px;\n        transform: rotate(-").concat(a,"deg) scale(").concat(1/t.scale,');\n        "></div>')),n.push($(r).find(".app-adsorb-layer-item")[0])}else o[0]?n.push(o[0]):($(r).append('<div class="app-default-layer-item" style="\n        width: '.concat(r.offsetWidth,"px;\n        height: ").concat(r.offsetHeight,'px;"></div>')),n.push(r))})),n}},{key:"clear",value:function(){$(".app-adsorb-layer-item").remove(),$(".app-default-layer-item").remove()}},{key:"check",value:function(e,t){var n=this,r=e[0].getBoundingClientRect();this.uncheck(),t.forEach((function(t){t.classList.remove("app-adsorb-line-active");var a=n.canvasRect;if(t!==e[0]){var o=e.find(".app-adsorb-layer-item");if(!o[0]||t!==o[0]){var i=t.getBoundingClientRect(),s=i.top,c=i.height,p=i.bottom,l=i.left,u=i.width,h=i.right,d=r.width/2,f=u/2,y=r.height/2,m=c/2,v={top:[{type:"xt-top",isNearly:n._isNearly(r.top,s),lineNode:n.lines.xt,lineValue:s,dragValue:s-a.top},{type:"xt-bottom",isNearly:n._isNearly(r.bottom,s),lineNode:n.lines.xt,lineValue:s,dragValue:s-r.height-a.top},{type:"xc",isNearly:n._isNearly(r.top+y,s+m),lineNode:n.lines.xc,lineValue:s+m,dragValue:s+m-y-a.top},{type:"xb-top",isNearly:n._isNearly(r.bottom,p),lineNode:n.lines.xb,lineValue:p,dragValue:p-r.height-(a.bottom-a.height)},{type:"xb-bottom",isNearly:n._isNearly(r.top,p),lineNode:n.lines.xb,lineValue:p,dragValue:p-a.top}],left:[{type:"yl-left",isNearly:n._isNearly(r.left,l),lineNode:n.lines.yl,lineValue:l,dragValue:l-a.left},{type:"yl-right",isNearly:n._isNearly(r.right,l),lineNode:n.lines.yl,lineValue:l,dragValue:l-r.width-a.left},{type:"yc",isNearly:n._isNearly(r.left+d,l+f),lineNode:n.lines.yc,lineValue:l+f,dragValue:l+f-d-a.left},{type:"yr-left",isNearly:n._isNearly(r.right,h),lineNode:n.lines.yr,lineValue:h,dragValue:h-r.width-(a.right-a.width)},{type:"yr-right",isNearly:n._isNearly(r.left,h),lineNode:n.lines.yr,lineValue:h,dragValue:h-(a.right-a.width)}]},g=function(r){v[r].forEach((function(a){if(a.isNearly){if(t.classList.add("app-adsorb-line-active"),e.find(".app-adsorb-layer-item")[0]){var o=0;o="left"===r?(e.find(".app-adsorb-layer-item").width()-e.width()*n.scale)/2:(e.find(".app-adsorb-layer-item").height()-e.height()*n.scale)/2,e.css(r,"".concat((a.dragValue+o)/n.scale,"px"))}else e.css(r,"".concat(a.dragValue/n.scale,"px"));a.lineNode.css(r,"".concat(a.lineValue,"px")),a.lineNode.show()}}))};for(var b in v)g(b)}}}))}},{key:"uncheck",value:function(){this.$lines.hide(),$(".app-adsorb-line-active").removeClass("app-adsorb-line-active")}},{key:"_isNearly",value:function(e,t){return Math.abs(e-t)<=this.set.gap}}]),e}());function rr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var ar,or,ir=Object(P.b)("h5ds")(Zn=Object(P.c)(Zn=function(e){w()(n,e);var t=rr(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).state={lines:{xt:null,xc:null,xb:null,yl:null,yc:null,yr:null}},r}return g()(n,[{key:"componentDidMount",value:function(){var e=this;window.pubSubEditor.subscribe("h5ds.control.absorb.start",(function(){e.adsorb=new nr,e.layersTarget=e.props.h5ds.getPageLayerDom(),e.layersTarget=e.adsorb.correct(e.layersTarget),e.layersTarget=[].concat(z()(e.layersTarget),[$("#h5dsCanvasApp")[0]],z()($(".app-ruler-guides"))),e.thisTarget=e.props.h5ds.getLayerDom()})),window.pubSubEditor.subscribe("h5ds.control.absorb.move",(function(){e.adsorb.check(e.thisTarget,e.layersTarget)})),window.pubSubEditor.subscribe("h5ds.control.absorb.end",(function(){e.adsorb.uncheck(),e.adsorb.clear()}))}},{key:"componentWillUnmount",value:function(){window.pubSubEditor.unsubscribe("h5ds.control.absorb.start"),window.pubSubEditor.unsubscribe("h5ds.control.absorb.move"),window.pubSubEditor.unsubscribe("h5ds.control.absorb.end")}},{key:"render",value:function(){var e=this.state.lines;return D.a.createElement("div",{className:"app-adsorb-lines"},Object.keys(e).map((function(e,t){var n=null;return n="x"===e[0]?{width:"100%",height:1,left:0}:{width:1,height:"100%",top:0},D.a.createElement("div",{className:"app-adsorb-line",key:t,style:n})})))}}]),n}(x.Component))||Zn)||Zn;n(592),n(594);function sr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var cr,pr,lr=Object(P.b)("h5ds")(ar=Object(P.c)((or=function(e){w()(n,e);var t=sr(n);function n(e){return m()(this,n),t.call(this,e)}return g()(n,[{key:"setPageHei",value:function(e){e.stopPropagation();var t=this.props.h5ds,n=t.edata,r=(0,t.getPage)();r.style.height||(r.style.height=Se.appHeight);var a=e.pageY,o=r.style.height,i=n.phoneScale,s=$(".app-js-setsize"),c=$(".app-js-setpage-height"),p="phone"===Se.type?Se.appHeight:0;$(document).on("mousemove.h5ds.setPageHei",(function(e){(o=parseInt(r.style.height+(e.pageY-a)/i,10))<p&&(o=p),s.height(o),c.html(o)})).on("mouseup.h5ds.setPageHei",(function(){Object(Ee.transaction)((function(){r.style.height=o,n.pageSize.height=r.style.height,n.keys=Q.randomID(),window.pubSubEditor.publish("h5ds.setHistory"),$(document).off("mousemove.h5ds.setPageHei mouseup.h5ds.setPageHei")}))}))}},{key:"render",value:function(){var e=this.props.height,t=this.props.h5ds.edata;return D.a.createElement("div",{className:"app-setpage-height"},D.a.createElement("span",{key:e,className:"app-setpage-px"},D.a.createElement("span",{className:"app-js-setpage-height"},e),"px [缩放：",t.phoneScale,"]"),D.a.createElement("a",{onMouseDown:this.setPageHei,className:"app-js-setpage app-setpage-height-btn"},D.a.createElement("i",{className:"app-ico app-ico-shangxiawen"})))}}]),n}(x.Component),se()(or.prototype,"setPageHei",[be],Object.getOwnPropertyDescriptor(or.prototype,"setPageHei"),or.prototype),ar=or))||ar)||ar;function ur(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var hr,dr,fr=Object(P.b)("h5ds")(cr=Object(P.c)((pr=function(e){w()(n,e);var t=ur(n);function n(e){return m()(this,n),t.call(this,e)}return g()(n,[{key:"setPageWidth",value:function(e){e.stopPropagation();var t=this.props.h5ds,n=t.edata,r=(0,t.getPage)();r.style.width||(r.style.width=Se.appWidth);var a=e.pageX,o=r.style.width,i=r.style.width,s=n.phoneScale||1,c=$(".app-js-setsize"),p=$(".app-js-setpage-width"),l=0;switch(Se.type){case"phone":l=Se.appWidth;break;case"pc":l=0;break;case"horizontal-phone":case"ppt":l=Se.appWidth}$(document).on("mousemove.h5ds.setPageWidth",(function(e){(i=parseInt(o+(e.pageX-a)/s,10))<l&&(i=l),c.css({width:i}),p.html(i+"px")})).on("mouseup.h5ds.setPageWidth",(function(){Object(Ee.transaction)((function(){r.style.width=i,n.pageSize.width=i,n.keys=Q.randomID(),window.pubSubEditor.publish("h5ds.setHistory"),$(document).off("mousemove.h5ds.setPageWidth mouseup.h5ds.setPageWidth")}))}))}},{key:"componentDidMount",value:function(){$(this.btn).on("mousedown",this.setPageWidth)}},{key:"componentWillUnmount",value:function(){$(this.btn).off("mousedown")}},{key:"render",value:function(){var e=this,t=this.props.width;return D.a.createElement("div",{className:"app-setpage-width"},D.a.createElement("span",{key:t,className:"app-setpage-px app-js-setpage-width"},t,"px"),D.a.createElement("a",{ref:function(t){return e.btn=t},className:"app-js-setpage app-setpage-width-btn"},D.a.createElement("i",{className:"app-ico app-ico-shangxiawen"})))}}]),n}(x.Component),se()(pr.prototype,"setPageWidth",[be],Object.getOwnPropertyDescriptor(pr.prototype,"setPageWidth"),pr.prototype),cr=pr))||cr)||cr;function yr(e,t,n){$("#h5dsCanvas").off("mousedown.h5ds.group").on("mousedown.h5ds.group",".app-control",(function(r){if(n.selectGroup){r.stopPropagation();var a={},o=e();n.selectGroup.forEach((function(e){a[e]={x:parseInt(o[e].style.left,10),y:parseInt(o[e].style.top,10)}}));var i=t();$(document).on("mousemove.h5ds.group",(function(e){e.stopPropagation();var t=e.pageX-r.pageX,o=e.pageY-r.pageY;n.selectGroup.forEach((function(e){i.eq(e).css({left:a[e].x+t/n.phoneScale,top:a[e].y+o/n.phoneScale})}))})).on("mouseup.h5ds.group",(function(e){var t=e.pageX-r.pageX,i=e.pageY-r.pageY;Object(Ee.transaction)((function(){n.selectGroup.forEach((function(e){o[e]&&(o[e].style.left=a[e].x+t/n.phoneScale,o[e].style.top=a[e].y+i/n.phoneScale)}))})),$(document).off("mousemove.h5ds.group mouseup.h5ds.group"),window.pubSubEditor.publish("h5ds.setHistory")}))}}))}function mr(e,t){var n=e.edata;$("#h5dsCanvas").off("mousedown.h5ds.layerGroup").on("mousedown.h5ds.layerGroup",(function(r){if(!($(r.target).closest(".app-ruler")[0]||$(r.target).closest(".app-canvas-navigator")[0]||$(r.target).closest(".app-js-setpage")[0]||n.selectGroup||null!==n.selectLayer)){var a=[];e.getPageDom().children(".app-swiper-layers-box").children(".app-swiper-layers").children(".layer").each((function(){var e=$(this),t={left:e.offset().left,top:e.offset().top,width:e.width(),height:e.height(),dom:e};t.center={x:t.left+t.width/2,y:t.top+t.height/2},e.hasClass("layer-temporary-lock")||e.closest(".layer-combinbox")[0]||a.push(t)})),$(".layer-group-select")[0]||$("body").append('<div class="layer-group-select"></div>');var o,i,s,c,p=$(".layer-group-select");$(document).on("mousemove.h5ds.layerGroup",(function(e){o=Math.abs(e.pageX-r.pageX),i=Math.abs(e.pageY-r.pageY),c=e.pageX>r.pageX?r.pageX:e.pageX,s=e.pageY>r.pageY?r.pageY:e.pageY,p.css({top:s,left:c,width:o,height:i,display:o+i===0?"none":"block"}),a.forEach((function(e){var t=e.center,n=t.x,r=t.y;n>c&&n<c+o&&r>s&&r<s+i?e.dom.find(".app-control")[0]||e.dom.append('<div class="app-control">\n                    <span class="app-control-top"></span>\n                    <span class="app-control-left"></span>\n                    <span class="app-control-right"></span>\n                    <span class="app-control-bottom"></span>\n                    <span class="app-control-topleft"></span>\n                    <span class="app-control-topright"></span>\n                    <span class="app-control-bottomleft"></span>\n                    <span class="app-control-bottomright"></span>\n                    <span class="app-control-center"></span>\n                </div>'):e.dom.find(".app-control").remove()}))})).on("mouseup.h5ds.layerGroup",(function(){var n=e.getPageDom().find(".app-control");n.length>1?t(function(e){var t=[];return e.getPageDom().find(".app-control").each((function(){var e=$(this).closest(".layer");t.push(e.index())})),t}(e)):1===n.length&&n.closest(".layer").trigger("click"),a=null,$(document).off("mousemove.h5ds.layerGroup"),$(document).off("mouseup.h5ds.layerGroup"),p.remove()}))}}))}function vr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function gr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vr(Object(n),!0).forEach((function(t){C()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function br(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var wr,kr=Object(P.b)("h5ds","scope")(hr=Object(P.c)((dr=function(e){w()(n,e);var t=br(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).layer=e.h5ds.getLayer(),r}return g()(n,[{key:"initControlCallback",value:function(){var e=this,t=this.props.h5ds;this.$nowlayer=t.getLayerDom();var n=t.getPageDom().find(".app-control");if(n[0]&&(n.remove(),n=null),this.$nowlayer)if(this.$nowlayer[0]){this.layer=t.getLayer();var r=this.props.scope.pluginsKey[this.layer.pid];if(r){var a=r.editorConfig||{};this.$nowlayer.control({lockWideHigh:this.layer.set.lockWideHigh,setHeight:!1!==a.height,setWidth:!1!==a.width,movex:!1!==a.x,movey:!1!==a.y,rotate:!1!==a.rotate,autosize:!0,fixedsize:!0}),this.$nowlayer.off("controlStart.h5ds.canvas").on("controlStart.h5ds.canvas",(function(t,n){if(!n)return!1;e.$elementInner||(e.$elementInner=e.$nowlayer.children(".element").children(".element-flip").children());var r=e.$elementInner.width(),a=e.$elementInner.height();e.startWidth=e.$nowlayer.width(),e.startHeight=e.$nowlayer.height(),e.startScale=[e.startWidth/r,e.startHeight/a]})),this.$nowlayer.off("controlResizeTick.h5ds.canvas").on("controlResizeTick.h5ds.canvas",(function(t,n){if(!n)return!1;["h5ds_img","h5ds_combin"].includes(e.layer.pid)&&e.$elementInner.css({transform:"scale(".concat(n.width/e.startWidth*e.startScale[0],", ").concat(n.height/e.startHeight*e.startScale[1],")")})})),this.$nowlayer.off("change.h5ds.canvas").on("change.h5ds.canvas",(function(t,n){if(e.tickData&&(e.tickData=null),e.$elementInner&&(e.$elementInner=null),!n)return!1;Object(Ee.transaction)((function(){if(!e.layer)return null;for(var t in n)switch(t){case"left":e.layer.style.left=n[t];break;case"top":e.layer.style.top=n[t];break;case"width":e.layer.style.width=n[t];break;case"height":e.layer.style.height=n[t];break;case"transform":e.layer.style.transform=n.transform}e.props.h5ds.edata.keys=Q.randomID()})),window.pubSubEditor.publish("h5ds.setHistory")}))}else console.error("插件异常",this.layer.pid)}else console.warn("未选择layer");else console.warn("未选择layer")}},{key:"initGroupEvent",value:function(){mr(this.props.h5ds,(function(e){Object(Ee.transaction)((function(){t.selectGroup=e,t.setType="group"}))}));var e=this.props.h5ds,t=e.edata,n=e.getPageLayerDom;yr(e.getLayers,n,t)}},{key:"initControlEvent",value:function(){var e=this;$(document).on("mousedown.h5ds.destoryControl",(function(e){!$(e.target).closest(".layer")[0]&&$(e.target).closest("#h5dsCanvas")[0]&&window.pubSubEditor.publish("h5ds.destoryControl")})),window.pubSubEditor.subscribe("h5ds.destoryControl",(function(t){var n=e.props.h5ds.edata,r=n.selectType,a=n.pageNum,o=$("#h5dsCanvasApp").find(".app-control");o[0]&&(o.remove(),o=null),Object(Ee.transaction)((function(){n.setType="page",n.selectGroup=!1,n.selectLayer=null,t&&(a=t.pageNum,r=t.selectType),Q.isEmpty(a)||e.props.h5ds.setPage(a,r)}))})),window.pubSubEditor.subscribe("h5ds.initControl",(function(){e.initControlCallback()}))}},{key:"initLayerControl",value:function(e,t){t.stopPropagation(),t.nativeEvent.stopImmediatePropagation();var n=this.props.h5ds;t&&t.ctrlKey?Object(Ee.transaction)((function(){var t,r,a;n.edata.selectGroup||(n.edata.selectGroup=[],n.getPageDom().find(".app-control")[0]&&n.edata.selectGroup.push(n.edata.selectLayer));-1===n.edata.selectGroup.indexOf(e)?n.edata.selectGroup.push(e):n.edata.selectGroup.splice(n.edata.selectGroup.findIndex((function(t){return t===e})),1),n.edata.selectGroup=z()(new Set(n.edata.selectGroup)),n.edata.selectGroup.length>1&&(n.edata.selectLayer=null,n.edata.setType="group"),t=n.getPageDom,r=n.edata.selectGroup,(a=t()).find(".app-control").remove(),r.forEach((function(e){var t=a.children(".app-swiper-layers-box").children(".app-swiper-layers").children(".layer").eq(e);t.find(".app-control")[0]||t.append('<div class="app-control">\n    <span class="app-control-top"></span>\n    <span class="app-control-left"></span>\n    <span class="app-control-right"></span>\n    <span class="app-control-bottom"></span>\n    <span class="app-control-topleft"></span>\n    <span class="app-control-topright"></span>\n    <span class="app-control-bottomleft"></span>\n    <span class="app-control-bottomright"></span>\n    <span class="app-control-center"></span>\n</div>')})),yr(n.getLayers,n.getPageLayerDom,n.edata)})):n.edata.selectGroup&&Q.isEmpty(n.edata.selectLayer)&&$(t.currentTarget).find(".app-control")[0]||e!==n.edata.selectLayer&&(n.edata.selectGroup=null,n.setLayer(e))}},{key:"setPageStyle",value:function(e){var t=this.props.h5ds.edata,n=t.selectType,r=t.selectFixed,a={},o=this.props.h5ds.getPage();if(o){switch(n){case"popups":"popups"===e?a.display="block":a.pointerEvents="none";break;case"fixeds":"popups"===e&&(a.display="none"),e+r==="fixedUp0"||e+r==="fixedDown1"?(a.width="100%",a.height="100%"):a.pointerEvents="none";break;case"pages":"popups"===e?a.display="none":"pages"===e||(a.pointerEvents="none")}return Object.assign(a,o.style||{})}console.warn("未找到page")}},{key:"componentDidMount",value:function(){this.initControlEvent(),this.initGroupEvent()}},{key:"componentWillUnmount",value:function(){window.pubSubEditor.unsubscribe("h5ds.initControl"),window.pubSubEditor.unsubscribe("h5ds.destoryControl"),$(document).off("mousedown.h5ds.destoryControl"),$("#h5dsCanvas").off("mousedown.h5ds.group"),$("#h5dsCanvas").off("mousedown.h5ds.layerGroup"),this.$nowlayer&&this.$nowlayer.off("change.h5ds.canvas controlResizeTick.h5ds.canvas controlStart.h5ds.canvas")}},{key:"render",value:function(){var e=this.props.h5ds,t=e.edata,n=e.getPage,r=e.renderPageList,a=this.props,o=a.plugins,i=a.pageData;return r(),t.keys,D.a.createElement("div",{className:"app-pages-app",key:t.canvasAnimate},"popups"===t.selectType&&D.a.createElement("div",{className:"app-fixed-view app-js-setsize",id:"h5dsPageViewPopup",style:gr({},this.setPageStyle("popups"))},D.a.createElement(Be,{initControl:this.initLayerControl,plugins:o,isRenderThis:!0,data:n("popups"),renderIn:je.RENDER_IN_CANVAS})),D.a.createElement("div",{className:"app-fixed-view app-js-setsize",id:"h5dsPageViewFixedUp",style:gr({},this.setPageStyle("fixedUp"))},D.a.createElement(We,{initControl:this.initLayerControl,plugins:o,isRenderThis:!0,data:n("fixeds",0),renderIn:je.RENDER_IN_CANVAS})),D.a.createElement("div",{className:"app-fixed-view app-js-setsize",id:"h5dsPageViewFixedDown",style:gr({},this.setPageStyle("fixedDown"))},D.a.createElement(We,{initControl:this.initLayerControl,plugins:o,isRenderThis:!0,data:n("fixeds",1),renderIn:je.RENDER_IN_CANVAS})),D.a.createElement("div",{className:"app-page-view app-js-setsize",id:"h5dsPageView",style:gr({},this.setPageStyle("pages"))},i&&"popups"!==t.selectType&&D.a.createElement(He,{isRenderThis:!0,initControl:this.initLayerControl,plugins:o,data:i,renderIn:je.RENDER_IN_CANVAS})))}}]),n}(x.Component),se()(dr.prototype,"initControlCallback",[be],Object.getOwnPropertyDescriptor(dr.prototype,"initControlCallback"),dr.prototype),se()(dr.prototype,"initGroupEvent",[be],Object.getOwnPropertyDescriptor(dr.prototype,"initGroupEvent"),dr.prototype),se()(dr.prototype,"initControlEvent",[be],Object.getOwnPropertyDescriptor(dr.prototype,"initControlEvent"),dr.prototype),se()(dr.prototype,"initLayerControl",[be],Object.getOwnPropertyDescriptor(dr.prototype,"initLayerControl"),dr.prototype),se()(dr.prototype,"setPageStyle",[be],Object.getOwnPropertyDescriptor(dr.prototype,"setPageStyle"),dr.prototype),hr=dr))||hr)||hr;n(596);function Er(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var Or,Sr=Object(P.b)("h5ds")(wr=Object(P.c)(wr=function(e){w()(n,e);var t=Er(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state={show:!1},e}return g()(n,[{key:"componentDidMount",value:function(){var e=this;window.pubSubEditor.subscribe("h5ds.show.grid",(function(){e.setState({show:!e.state.show})}))}},{key:"componentWillUnmount",value:function(){window.pubSubEditor.unsubscribe("h5ds.show.grid")}},{key:"render",value:function(){var e=this.state.show,t=this.props,n=t.width,r=t.height,a=this.props.h5ds.edata,o=a.gridSize,i=a.gridAdsorb,s=["app-grid","app-js-grid"];return e&&s.push("app-grid-show"),D.a.createElement("div",{className:s.join(" "),"data-adsorb":i,"data-size":o},D.a.createElement("ul",{className:"app-grid-row"},Array(Math.ceil(parseInt(r,10)/o)).fill(1).map((function(e,t){return D.a.createElement("li",{key:t,style:{top:o*t}})}))),D.a.createElement("ul",{className:"app-grid-col"},Array(Math.ceil(parseInt(n,10)/o)).fill(1).map((function(e,t){return D.a.createElement("li",{key:t,style:{left:o*t}})}))))}}]),n}(x.Component))||wr)||wr;function xr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Dr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xr(Object(n),!0).forEach((function(t){C()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Pr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var jr,Cr,Rr=Object(P.b)("h5ds","scope")(Or=Object(P.c)(Or=function(e){w()(n,e);var t=Pr(n);function n(){return m()(this,n),t.apply(this,arguments)}return g()(n,[{key:"componentDidMount",value:function(){var e=this;$(window).on("resize.ruler",(function(){e.props.h5ds.setCanvasSize()}))}},{key:"componentWillUnmount",value:function(){$(window).off("resize.ruler")}},{key:"render",value:function(){var e=this.props.h5ds,t=e.data,n=e.edata,r=e.getPage,a=n.phoneScale,o=n.canvasHeight,i=n.canvasWidth,s=t.style,c=(s.width,s.height,pe()(s,["width","height"])),p=r("pages",n.selectPage),l={};if(!p)return console.error("page不存在:",n.selectPage),null;Object.assign(l,Dr({},p.style));var u={pluginsKey:this.props.scope.pluginsKey,scripts:this.props.scope.scripts},h=(i-p.style.width*a)/2,d=(o-p.style.height*a)/2,f=null,y=null;switch(Se.appType){case"phone":y=D.a.createElement(lr,{height:l.height});break;case"pc":f=D.a.createElement(fr,{width:l.width}),y=D.a.createElement(lr,{height:l.height})}return D.a.createElement("div",{className:"app-center",style:{height:o,width:i},onDragStart:function(e){e.preventDefault()}},D.a.createElement("div",{style:{height:o,width:i},className:"app-canvas"+(n.banAnimate?" app-ban-animate":""),id:"h5dsCanvas"},D.a.createElement("div",{className:"app-canvas-realsize",style:{left:h,top:d,width:p.style.width*a,height:p.style.height*a}},D.a.createElement("div",{className:"app-canvas-box app-js-canvas",style:Object.assign(Dr({},c),{transform:"scale(".concat(n.phoneScale,") translate3d(0,0,0)")})},"phone"===Se.appType&&D.a.createElement("div",{className:"app-canvas-lines",style:{width:Se.appWidth,height:l.height}},D.a.createElement("div",{className:"app-canvas-lines-iphone678"}),D.a.createElement("div",{style:{top:(l.height-640)/2<0?(l.height-640)/2:0},className:"app-canvas-lines-iphoneX"})),D.a.createElement("div",{className:"app-canvas-preview app-canvas-app app-js-setsize",id:"h5dsCanvasApp",style:Dr({},l)},D.a.createElement(Sr,{width:Se.appWidth,height:l.height}),y,f,D.a.createElement(kr,{plugins:u,pageData:p})),D.a.createElement("div",{className:"app-canvas-border"})))))}}]),n}(x.Component))||Or)||Or;n(598),n(600);function Ir(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Nr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ir(Object(n),!0).forEach((function(t){C()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ir(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Lr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var Ar,_r=Object(P.b)("h5ds","scope")(jr=Object(P.c)((Cr=function(e){w()(n,e);var t=Lr(n);function n(){return m()(this,n),t.apply(this,arguments)}return g()(n,[{key:"showSourceImgs",value:function(){window.pubSubEditor.publish("h5ds.img.modal.show",{callback:this.changeImage})}},{key:"changeImage",value:function(e){var t=this;Object(Ee.transaction)((function(){t.props.h5ds.data.img=e,t.props.h5ds.edata.keys=Q.randomID(),window.pubSubEditor.publish("h5ds.setHistory")}))}},{key:"onCropOk",value:function(e){var t=this,n=this.props.uploadSet;e.src&&(n?$.ajax({type:"post",url:n.action,headers:Nr({},n.headers),data:{content:e.base64.split(",")[1]}}).done((function(e){e.path?t.changeImage(e.path):console.error("数据返回格式错误： {path: 'xxxx'}")})):console.error("图片裁剪需要配置 uploadBase64 接口参数！"))}},{key:"render",value:function(){var e=this.props.h5ds.data.img;return D.a.createElement("div",{className:"app-util-background"},D.a.createElement("h1",{className:"app-util-background-title"},"H5主图:"),D.a.createElement("div",{className:"app-util-background-img"},D.a.createElement(ut,{cropSet:null,onClickNullImage:this.showSourceImgs,onChangeImage:this.showSourceImgs,onCropBase64:this.onCropOk,src:e})))}}]),n}(x.Component),se()(Cr.prototype,"showSourceImgs",[be],Object.getOwnPropertyDescriptor(Cr.prototype,"showSourceImgs"),Cr.prototype),se()(Cr.prototype,"changeImage",[be],Object.getOwnPropertyDescriptor(Cr.prototype,"changeImage"),Cr.prototype),se()(Cr.prototype,"onCropOk",[be],Object.getOwnPropertyDescriptor(Cr.prototype,"onCropOk"),Cr.prototype),jr=Cr))||jr)||jr;n(602);function Tr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tr(Object(n),!0).forEach((function(t){C()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Hr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var $r,Wr,Mr=(Ar=function(e){w()(n,e);var t=Hr(n);function n(e){var r;m()(this,n),r=t.call(this,e);var a=e.data||{},o=a.backgroundGlobal,i=void 0!==o&&o,s=a.backgroundColor,c=void 0===s?"rgba(255,255,255,1)":s,p=a.backgroundImage,l=void 0===p?"":p,u=a.backgroundImageCrop,h=void 0===u?"{}":u,d=a.backgroundRepeat,f=void 0===d?"no-repeat":d,y=a.backgroundSize,v=void 0===y?"initial":y;return c=et(c),r.state={backgroundColor:et(c),backgroundRepeat:f,backgroundImageCrop:h,backgroundGlobal:i,backgroundSize:v,backgroundImage:l},r.eventId=Ze.randomID(),r}return g()(n,[{key:"onChange",value:function(){this.props.onChange&&this.props.onChange(zr({},this.state))}},{key:"changeImage",value:function(e){this.setState({backgroundImage:"url(".concat(e,")")},this.onChange)}},{key:"showSourceImgs",value:function(){window.pubSubEditor&&window.pubSubEditor.publish("h5ds.img.modal.show",{callback:this.changeImage})}},{key:"onCropOk",value:function(e){var t=this,n=this.props.uploadSet;e.src?n?$.ajax({type:"post",url:n.action,headers:zr({},n.headers),data:{content:e.base64.split(",")[1]}}).done((function(e){e.path?t.setState({backgroundImage:"url(".concat(e.path,")")},t.onChange):console.error("数据返回格式错误： {path: 'xxxx'}")})):console.error("图片裁剪需要配置 uploadBase64 接口参数！"):this.setState({backgroundImage:""},this.onChange)}},{key:"sliderDo",value:function(e,t){this.setState(C()({},t,e),this.onChange)}},{key:"changeColor",value:function(e){var t=e.rgb,n=t.r,r=t.g,a=t.b,o=t.a;this.setState({backgroundColor:"rgba(".concat(n,",").concat(r,",").concat(a,",").concat(o,")")},this.onChange)}},{key:"changeBackgroundGlobal",value:function(e){this.setState({backgroundGlobal:e},this.onChange)}},{key:"render",value:function(){ke.Radio.Group,ke.Radio.Button;var e=this.state,t=(e.backgroundColor,e.backgroundRepeat,e.backgroundGlobal,e.backgroundImage,e.backgroundSize,this.props);t.title,t.colorTitle,t.setBackgroundGlobal;return D.a.createElement("div",{className:"app-util-background"})}}]),n}(x.Component),se()(Ar.prototype,"onChange",[Je],Object.getOwnPropertyDescriptor(Ar.prototype,"onChange"),Ar.prototype),se()(Ar.prototype,"changeImage",[Je],Object.getOwnPropertyDescriptor(Ar.prototype,"changeImage"),Ar.prototype),se()(Ar.prototype,"showSourceImgs",[Je],Object.getOwnPropertyDescriptor(Ar.prototype,"showSourceImgs"),Ar.prototype),se()(Ar.prototype,"onCropOk",[Je],Object.getOwnPropertyDescriptor(Ar.prototype,"onCropOk"),Ar.prototype),se()(Ar.prototype,"sliderDo",[Je],Object.getOwnPropertyDescriptor(Ar.prototype,"sliderDo"),Ar.prototype),se()(Ar.prototype,"changeColor",[Je],Object.getOwnPropertyDescriptor(Ar.prototype,"changeColor"),Ar.prototype),se()(Ar.prototype,"changeBackgroundGlobal",[Je],Object.getOwnPropertyDescriptor(Ar.prototype,"changeBackgroundGlobal"),Ar.prototype),Ar);function Br(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Br(Object(n),!0).forEach((function(t){C()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Br(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Vr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var Gr,Ur,Yr=Object(P.b)("h5ds","scope")($r=Object(P.c)((Wr=function(e){w()(n,e);var t=Vr(n);function n(e){var r;m()(this,n),(r=t.call(this,e)).syncProxyData=Q.debounce((function(e,t){r.appData[t]=e,r.props.h5ds.edata.keys=Q.randomID(),window.pubSubEditor.publish("h5ds.setHistory")}),300),r.syncSlider=Q.debounce((function(){r.appData.slider=Fr({},r.state.slider),window.pubSubEditor.publish("h5ds.setHistory")}),500);var a=e.h5ds.data;r.appData=a;var o=a.desc,i=a.name,s=a.loading,c=void 0===s?"":s,p=a.set,l=void 0===p?{}:p,u=a.type,h=void 0===u?"pc":u,d=a.slider,f=void 0===d?{}:d,y=a.style,v=void 0===y?{}:y,g=v.width,b=v.height,w=v.backgroundImageCrop,k=void 0===w?"{}":w,E=v.backgroundImage,O=void 0===E?"":E,S=v.backgroundRepeat,x=void 0===S?"no-repeat":S,D=v.backgroundSize,P=void 0===D?"initial":D,j=v.backgroundColor,C=void 0===j?"":j;return r.state={desc:o,name:i,loading:c,set:Fr({},l),type:h,slider:Fr({},f),width:g,height:b,backgroundImageCrop:k,backgroundImage:O,backgroundRepeat:x,backgroundSize:P,backgroundColor:C},r}return g()(n,[{key:"changeVal",value:function(e,t){var n=this.state;n[t]=e,this.setState(Fr({},n)),this.syncProxyData(e,t)}},{key:"selectSilder",value:function(e,t){var n=this.state.slider;n.animate=t,this.setState({slider:n}),this.appData.slider.animate=t,window.pubSubEditor.publish("h5ds.setHistory")}},{key:"backGroundChange",value:function(e){var t=this;this.setState(Fr({},e)),Object(Ee.transaction)((function(){for(var n in e){var r=e[n];void 0===t.appData.style[n]?Object(Ee.extendObservable)(t.appData.style,C()({},n,r)):t.appData.style[n]=r}t.props.h5ds.edata.keys=Q.randomID(),window.pubSubEditor.publish("h5ds.setHistory")}))}},{key:"switchDo",value:function(e){var t=this.state.slider;t.autoplay=e,this.setState({slider:t},this.syncSlider)}},{key:"onChangeTime",value:function(e){var t=this.state.slider;t.time=e,this.setState({slider:t},this.syncSlider)}},{key:"changeEffect",value:function(e){var t=this.state.slider;t.effect=e.target.value,this.setState({slider:t},this.syncSlider)}},{key:"onChangeSpeed",value:function(e){var t=this.state.slider;t.speed=e,this.setState({slider:t},this.syncSlider)}},{key:"changeDirection",value:function(e){var t=this.state.slider;t.direction=e.target.value,this.setState({slider:t},this.syncSlider)}},{key:"componentWillReact",value:function(){var e=this.appData,t=e.name,n=e.desc,r=e.img;this.setState({name:t,desc:n,img:r})}},{key:"render",value:function(){var e=this,t=this.state,n=t.desc,r=t.name,a=t.slider,o=pe()(t,["desc","name","slider"]),i=ke.Tabs.TabPane,s=ke.Input.TextArea,c=a.autoplay,p=a.time,l=a.effect,u=void 0===l?"slide":l,h=a.speed,d=void 0===h?.5:h,f=a.direction,y=void 0===f?"vertical":f;return this.appData.name,this.appData.desc,D.a.createElement("div",{className:"app-appset"},D.a.createElement(ke.Tabs,{size:"small",defaultActiveKey:"1",className:"app-basic-tabs"},D.a.createElement(i,{key:"1",tab:"分享"},D.a.createElement(_r,null),D.a.createElement(_t,{className:"app-appset-item",name:"H5标题"},D.a.createElement(ke.Input,{value:r,onChange:function(t){return e.changeVal(t.target.value,"name")}})),D.a.createElement(_t,{className:"app-appset-item",name:"H5描述"},D.a.createElement(s,{rows:6,value:n,onChange:function(t){return e.changeVal(t.target.value,"desc")}}))),D.a.createElement(i,{key:"2",tab:"背景"},D.a.createElement(Mr,{uploadSet:this.props.scope.options.uploadBase64,onChange:this.backGroundChange,data:o})),D.a.createElement(i,{key:"3",tab:"翻页"},D.a.createElement("div",{className:"app-appset-slider"},D.a.createElement(_t,{name:"翻页动画"},D.a.createElement(ke.Radio.Group,{onChange:this.changeEffect,value:u,buttonStyle:"solid"},D.a.createElement(ke.Radio.Button,{value:"slide"},"位移"),D.a.createElement(ke.Radio.Button,{value:"fade"},"淡入"),D.a.createElement(ke.Radio.Button,{value:"coverflow"},"3d流"),D.a.createElement(ke.Radio.Button,{value:"flip"},"3d翻转"))),D.a.createElement(Sn,{name:"动画速度",onChange:this.onChangeSpeed,tipFormatter:null,step:.1,min:0,max:10,value:d}),D.a.createElement(_t,{name:"切换方向"},D.a.createElement(ke.Radio.Group,{onChange:this.changeDirection,defaultValue:y,buttonStyle:"solid"},D.a.createElement(ke.Radio.Button,{value:"vertical"},"纵向滑动"),D.a.createElement(ke.Radio.Button,{value:"horizontal"},"横向滑动"))),D.a.createElement(_t,{name:"自动播放"},D.a.createElement(ke.Switch,{value:c,onChange:this.switchDo})),c&&D.a.createElement(Sn,{name:"切换时间",onChange:this.onChangeTime,tipFormatter:null,step:.1,min:0,max:100,value:p})))))}}]),n}(x.Component),se()(Wr.prototype,"changeVal",[be],Object.getOwnPropertyDescriptor(Wr.prototype,"changeVal"),Wr.prototype),se()(Wr.prototype,"selectSilder",[be],Object.getOwnPropertyDescriptor(Wr.prototype,"selectSilder"),Wr.prototype),se()(Wr.prototype,"backGroundChange",[be],Object.getOwnPropertyDescriptor(Wr.prototype,"backGroundChange"),Wr.prototype),se()(Wr.prototype,"switchDo",[be],Object.getOwnPropertyDescriptor(Wr.prototype,"switchDo"),Wr.prototype),se()(Wr.prototype,"onChangeTime",[be],Object.getOwnPropertyDescriptor(Wr.prototype,"onChangeTime"),Wr.prototype),se()(Wr.prototype,"changeEffect",[be],Object.getOwnPropertyDescriptor(Wr.prototype,"changeEffect"),Wr.prototype),se()(Wr.prototype,"onChangeSpeed",[be],Object.getOwnPropertyDescriptor(Wr.prototype,"onChangeSpeed"),Wr.prototype),se()(Wr.prototype,"changeDirection",[be],Object.getOwnPropertyDescriptor(Wr.prototype,"changeDirection"),Wr.prototype),$r=Wr))||$r)||$r;n(604),n(606);function Jr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var qr;Object(P.b)("h5ds")(Gr=Object(P.c)((Ur=function(e){w()(n,e);var t=Jr(n);function n(e){var r;m()(this,n),(r=t.call(this,e)).layer=r.props.h5ds.getLayer();var a=Object(Ee.toJS)(r.layer.animate);return r.state={animate:a,active:null},r.keys=Q.randomID(),r}return g()(n,[{key:"resetDelay",value:function(e){var t=null;return e.forEach((function(e,n){if(0!==n){var r=t,a=r.duration,o=void 0===a?0:a,i=r.delay,s=void 0===i?0:i,c=r.count,p=void 0===c?0:c,l=ye.getAnimation(e.style).delay;p===1/0&&(p=1),l>=(s=o*p+s)&&(s=l),e.style=ye.setAnimation(e.style,{delay:s})}t=ye.getAnimation(e.style)})),e}},{key:"setActive",value:function(e){this.props.h5ds.edata.animateListShow=!0,this.setState({active:e})}},{key:"animateType",value:function(e){switch(e){case"in":e="进入";break;case"out":e="离开";break;default:e="强调"}return e}},{key:"setLayer",value:function(){var e=this,t=this.state.animate;Object(Ee.transaction)((function(){t[0]&&"in"===t[0].type?e.layer.estyle.opacity=0:e.layer.estyle.opacity=1,e.layer.animate=Object(Ee.toJS)(t),e.props.h5ds.edata.banAnimate=!1,e.props.h5ds.edata.canvasAnimate=Q.randomID(),window.pubSubEditor.publish("h5ds.setHistory")})),setTimeout((function(){window.pubSubEditor.publish("h5ds.initControl")}))}},{key:"delAnimate",value:function(e,t){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation();var n=this.state.animate;n.splice(t,1),this.resetDelay(n),this.setState({animate:n,active:null},this.setLayer),this.props.h5ds.edata.animateListShow=!1}},{key:"addAnimate",value:function(){var e=this,t="fadeIn",n="渐变进入",r="in",a=1,o=0,i=1,s="ease",c=this.state.animate;c.push({name:n,type:r,style:"".concat(t," ").concat(a,"s ").concat(s," ").concat(o,"s ").concat(i," normal forwards running")}),this.resetDelay(c),this.setState({animate:c},(function(){e.setActive(c.length-1)}),this.setLayer)}},{key:"onChange",value:function(e,t,n){var r=this.state,a=r.animate,o=a[r.active];if(o){var i=ye.getAnimation(o.style),s=i.name,c=i.duration,p=i.delay,l=i.timing,u=i.count;switch(t){case"duration":n?c+=e:c=e,c<0&&(c=0);break;case"delay":n?p+=e:p=e,p<0&&(p=0);break;case"count":n?u+=e:u=e,u<1&&(u=1);break;case"timing":n?l+=e:l=e,l<0&&(l=0)}c=Q.toFixed(c,1),o.style="".concat(s," ").concat(c,"s ").concat(l," ").concat(Q.toFixed(p,1),"s ").concat(u===1/0?"infinite":u," normal forwards running"),this.resetDelay(a),this.setState({animate:a},this.setLayer)}}},{key:"componentDidMount",value:function(){var e=this;window.pubSubEditor.subscribe("h5ds.animateList.add",(function(t){var n=e.state,r=n.animate,a=r[n.active];if(a){var o=ye.getAnimation(a.style),i=o.duration,s=o.delay,c=o.timing,p=o.count;a.name=t.name,a.type=t.type,p=p||t.count,a.style="".concat(t.animate," ").concat(i||t.time,"s ").concat(t.fun||c," ").concat(s||t.delay,"s ").concat(p===1/0?"infinite":p," normal forwards running"),a.style,e.resetDelay(r),e.setState({animate:r},e.setLayer)}})),$("#h5dsUniqAnimateSetList").on("uniqend",(function(t,n){if(n){e.keys=Q.randomID();var r=e.state.animate;Q.exchageArrayElem(r,n.to,n.from),e.resetDelay(r),e.setState({active:null,animate:r},e.setLayer)}})),$(document).on("mousewheel.h5ds.AnimateSet",".app-scroll-AnimateSet",(function(t){t.preventDefault();var n=$(t.target).attr("data-key"),r=null;r="count"===n?t.originalEvent.deltaY<0?-1:1:t.originalEvent.deltaY<0?-.1:.1,e.onChange(r,n,!0)}))}},{key:"componentWillUnmount",value:function(){this.props.h5ds.edata.animateListShow=!1,window.pubSubEditor.unsubscribe("h5ds.animateList.add"),$("#h5dsUniqAnimateSetList").off("uniqend"),$(document).off("mousewheel.h5ds.AnimateSet")}},{key:"render",value:function(){var e=this;if(!this.layer)return null;var t=this.state,n=t.active,r=t.animate;return this.layer.animate,D.a.createElement("div",{className:"app-basic-animateset"},D.a.createElement("div",{className:"app-basic-animateset-list"},D.a.createElement("ul",{className:"app-uniqlist",id:"h5dsUniqAnimateSetList"},r.map((function(t,r){var a=["app-basic-animateset-item"];n===r&&a.push("app-basic-animateset-active");var o=t.name,i=t.type,s=t.style,c=ye.getAnimation(s),p=c.duration,l=c.timing,u=c.delay,h=c.count;return h=Q.isEmpty(h)?1:h,D.a.createElement("li",{onClick:function(){return e.setActive(r)},className:a.join(" "),key:r+e.keys},D.a.createElement("a",{onClick:function(t){return e.delAnimate(t,r)},className:"app-basic-animateset-btndel"},D.a.createElement(ke.Icon,{type:"close",theme:"outlined"})),D.a.createElement(Nt,{span:2},D.a.createElement(_t,{name:"动画名称:"},o||"-")),D.a.createElement(Nt,{span:2},D.a.createElement(_t,{name:"动画类型:"},e.animateType(i)||"-")),D.a.createElement(Nt,{span:2},D.a.createElement(_t,{name:"持续时间:"},D.a.createElement(ke.InputNumber,{className:"app-scroll-AnimateSet","data-key":"duration",size:"small",step:.1,min:0,max:1/0,value:Q.isEmpty(p)?0:p,onChange:function(t){return e.onChange(t,"duration")}}))),D.a.createElement(Nt,{span:2},D.a.createElement(_t,{name:"延迟时间:"},D.a.createElement(ke.InputNumber,{className:"app-scroll-AnimateSet","data-key":"delay",size:"small",step:.1,min:0,max:1/0,value:Q.isEmpty(u)?0:u,onChange:function(t){return e.onChange(t,"delay")}}))),D.a.createElement(Nt,{span:2},D.a.createElement(_t,{name:"重复次数:"},D.a.createElement(ke.Select,{onChange:function(t){return e.onChange(t,"count")},style:{width:70},size:"small",value:h},new Array(20).fill(1).map((function(e,t){return D.a.createElement(ke.Select.Option,{value:t+1,key:t},t+1)})),D.a.createElement(ke.Select.Option,{value:1/0,key:"无限"},"无限")))),D.a.createElement(Nt,{span:2},D.a.createElement(_t,{name:"缓动函数:"},D.a.createElement(ke.Select,{size:"small",onChange:function(t){return e.onChange(t,"timing")},value:l,style:{width:78},placeholder:"缓动函数"},D.a.createElement(ke.Select.Option,{value:"ease"},"默认"),D.a.createElement(ke.Select.Option,{value:"linear"},"匀速"),D.a.createElement(ke.Select.Option,{value:"ease-in"},"加速"),D.a.createElement(ke.Select.Option,{value:"ease-out"},"减速"),D.a.createElement(ke.Select.Option,{value:"ease-in-out"},"起始慢")))))}))),D.a.createElement(ke.Button,{className:"app-basic-animateset-addbtn",onClick:this.addAnimate,type:"primary",icon:"plus"},"添加动画")))}}]),n}(x.Component),se()(Ur.prototype,"resetDelay",[be],Object.getOwnPropertyDescriptor(Ur.prototype,"resetDelay"),Ur.prototype),se()(Ur.prototype,"setActive",[be],Object.getOwnPropertyDescriptor(Ur.prototype,"setActive"),Ur.prototype),se()(Ur.prototype,"animateType",[be],Object.getOwnPropertyDescriptor(Ur.prototype,"animateType"),Ur.prototype),se()(Ur.prototype,"setLayer",[be],Object.getOwnPropertyDescriptor(Ur.prototype,"setLayer"),Ur.prototype),se()(Ur.prototype,"delAnimate",[be],Object.getOwnPropertyDescriptor(Ur.prototype,"delAnimate"),Ur.prototype),se()(Ur.prototype,"addAnimate",[be],Object.getOwnPropertyDescriptor(Ur.prototype,"addAnimate"),Ur.prototype),se()(Ur.prototype,"onChange",[be],Object.getOwnPropertyDescriptor(Ur.prototype,"onChange"),Ur.prototype),Gr=Ur))||Gr),n(608),n(610),n(612);function Xr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var Kr,Qr,Zr=(qr=function(e){w()(n,e);var t=Xr(n);function n(){return m()(this,n),t.apply(this,arguments)}return g()(n,[{key:"ok",value:function(){var e=!0;this.props.ok&&(e=this.props.ok()),!0!==e&&void 0!==e||this.props.close()}},{key:"clear",value:function(){var e=this.props,t=e.layer,n=e.id,r=e.clear,a=e.close;t.events&&t.events.splice(t.events.findIndex((function(e){return e.id===n})),1),r&&r(),a()}},{key:"render",value:function(){return D.a.createElement("div",null,D.a.createElement("div",null,D.a.createElement("a",{onClick:this.ok,className:"app-close-event"},D.a.createElement("i",{className:"app-ico app-ico-jia"})," 确定"),D.a.createElement("a",{onClick:this.clear,className:"app-clear-event"},D.a.createElement("i",{className:"app-ico app-ico-icodel"})," 删除事件")),D.a.createElement("div",{className:"app-event-set-box"},D.a.createElement("div",{className:"app-eventbox"},D.a.createElement("h3",{className:"app-event-title"},"交互名称：",this.props.name),D.a.createElement("div",{className:"app-event-links"},this.props.children),D.a.createElement("div",{className:"app-event-tips"},D.a.createElement("h3",{className:"app-event-title"},"交互说明："),D.a.createElement("div",{className:"app-eventbox-content"},this.props.describe)))))}}]),n}(x.Component),se()(qr.prototype,"ok",[be],Object.getOwnPropertyDescriptor(qr.prototype,"ok"),qr.prototype),se()(qr.prototype,"clear",[be],Object.getOwnPropertyDescriptor(qr.prototype,"clear"),qr.prototype),qr);function ea(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var ta,na,ra={EventEditor:Object(P.b)("h5ds")(Kr=Object(P.c)((Qr=function(e){w()(n,e);var t=ea(n);function n(e){var r;m()(this,n),(r=t.call(this,e)).layer=e.h5ds.getLayer();var a=Object(Ee.toJS)(r.props.eventData).eventParam;return r.state={eventName:a.eventName,value:a.value},r}return g()(n,[{key:"changeText",value:function(e){this.setState({val:e.target.value})}},{key:"ok",value:function(){var e=this,t=this.state,n=t.value,r=t.eventName;if(!r||Q.isEmpty(n))return ke.message.error("请设置eventName和value参数"),!1;Object(Ee.transaction)((function(){e.props.eventData.eventParam.value=n,e.props.eventData.eventParam.eventName=r,window.pubSubEditor.publish("h5ds.setHistory")}))}},{key:"onChangeRadio",value:function(e){this.setState({eventName:e.target.value})}},{key:"setValue",value:function(e){var t=this.state.value;(t=t.split(",").filter((function(e){return e}))).includes(e.keyid)?t.splice(t.indexOf(e.keyid),1):t.push(e.keyid),this.setState({value:t.join(",")})}},{key:"setCustomEventName",value:function(e){this.setState({value:e.target.value})}},{key:"ReactEdit",value:function(e,t){var n=this,r=null;switch(e){case"h5ds_show_modal":var a=this.props.h5ds.getPages("popups")||[];t=t.split(",").filter((function(e){return e})),r=D.a.createElement("div",{className:"app-event-click-content"},D.a.createElement("h1",null,"请选择要显示或者隐藏的弹窗"),D.a.createElement("ul",{className:"app-event-click-modals"},a.length?a.map((function(e,r){return D.a.createElement("li",{onClick:function(){return n.setValue(e)},className:t.includes(e.keyid)?"active":"",key:e.keyid},"【",r,"】",e.name)})):D.a.createElement("div",null,"暂无弹窗")));break;case"h5ds_show_hide_layer":var o=this.props.h5ds.getLayers()||[];t=t.split(",").filter((function(e){return e})),r=D.a.createElement("div",{className:"app-event-click-content"},D.a.createElement("h1",null,"请选择要显示或者隐藏的图层"),D.a.createElement("ul",{className:"app-event-click-layers"},o.length?o.map((function(e,r){return D.a.createElement("li",{onClick:function(){return n.setValue(e)},className:t.includes(e.keyid)?"active":"",key:e.keyid},"【",r,"】",e.name)})):D.a.createElement("div",null,"暂无图层")));break;case"h5ds_custom_event_name":r=D.a.createElement("div",{className:"app-event-click-content"},D.a.createElement("h1",null,"请设置自定义事件名称"),D.a.createElement(ke.Input,{onChange:this.setCustomEventName,value:t}))}return r}},{key:"render",value:function(){var e=this.state,t=e.value,n=e.eventName,r=ke.Radio.Button,a=ke.Radio.Group;return D.a.createElement(Zr,{layer:this.layer,id:this.props.id,close:this.props.close,name:"点击事件",describe:"点击事件是指用户点击后会触发的事件，自定义事件会主动触发pubSub.publish(eventName)事件。",ok:this.ok},D.a.createElement("div",{className:"app-event-click"},D.a.createElement(a,{value:n,onChange:this.onChangeRadio,size:"small"},D.a.createElement(r,{value:"h5ds_show_modal"},"显/隐弹窗"),D.a.createElement(r,{value:"h5ds_show_hide_layer"},"显/隐图层"),D.a.createElement(r,{value:"h5ds_custom_event_name"},"自定义事件")),this.ReactEdit(n,t)))}}]),n}(x.Component),se()(Qr.prototype,"changeText",[be],Object.getOwnPropertyDescriptor(Qr.prototype,"changeText"),Qr.prototype),se()(Qr.prototype,"ok",[be],Object.getOwnPropertyDescriptor(Qr.prototype,"ok"),Qr.prototype),se()(Qr.prototype,"onChangeRadio",[be],Object.getOwnPropertyDescriptor(Qr.prototype,"onChangeRadio"),Qr.prototype),se()(Qr.prototype,"setValue",[be],Object.getOwnPropertyDescriptor(Qr.prototype,"setValue"),Qr.prototype),se()(Qr.prototype,"setCustomEventName",[be],Object.getOwnPropertyDescriptor(Qr.prototype,"setCustomEventName"),Qr.prototype),se()(Qr.prototype,"ReactEdit",[be],Object.getOwnPropertyDescriptor(Qr.prototype,"ReactEdit"),Qr.prototype),Kr=Qr))||Kr)||Kr,name:"点击事件",eventId:"h5ds_event_click",eventParam:{value:"",eventName:""},icon:D.a.createElement("i",{className:"app-ico app-ico-lianjie"})};n(614);function aa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function oa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var ia,sa,ca={EventEditor:Object(P.b)("h5ds")(ta=Object(P.c)((na=function(e){w()(n,e);var t=oa(n);function n(e){var r;m()(this,n),(r=t.call(this,e)).layer=e.h5ds.getLayer();var a=Object(Ee.toJS)(r.props.eventData);return r.state={value:Object(Ee.toJS)(a.eventParam.value)},r}return g()(n,[{key:"changeVal",value:function(e,t){var n=this.state.value;n[t]=e,this.setState({value:n})}},{key:"ok",value:function(){var e=this.state.value;return this.props.eventData.eventParam.value=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?aa(Object(n),!0).forEach((function(t){C()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):aa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e),!0}},{key:"render",value:function(){var e=this,t=this.state.value;return D.a.createElement(Zr,{layer:this.layer,id:this.props.id,close:this.props.close,name:"拖拽事件",describe:"设置拖拽的范围",ok:this.ok,clear:this.clear},D.a.createElement(_t,{name:"上移距离"},D.a.createElement(ke.InputNumber,{value:t.top,onChange:function(t){return e.changeVal(t,"top")}})),D.a.createElement(_t,{name:"下移距离"},D.a.createElement(ke.InputNumber,{value:t.bottom,onChange:function(t){return e.changeVal(t,"bottom")}})),D.a.createElement(_t,{name:"左移距离"},D.a.createElement(ke.InputNumber,{value:t.left,onChange:function(t){return e.changeVal(t,"left")}})),D.a.createElement(_t,{name:"右移距离"},D.a.createElement(ke.InputNumber,{value:t.right,onChange:function(t){return e.changeVal(t,"right")}})))}}]),n}(x.Component),se()(na.prototype,"changeVal",[be],Object.getOwnPropertyDescriptor(na.prototype,"changeVal"),na.prototype),se()(na.prototype,"ok",[be],Object.getOwnPropertyDescriptor(na.prototype,"ok"),na.prototype),ta=na))||ta)||ta,name:"拖拽",eventId:"h5ds_event_drag",eventParam:{value:{top:100,left:100,right:100,bottom:100,outbox:!1}},icon:D.a.createElement("i",{className:"app-ico app-ico-uibutton"})};n(616);function pa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var la,ua,ha={EventEditor:Object(P.b)("h5ds")(ia=Object(P.c)((sa=function(e){w()(n,e);var t=pa(n);function n(e){var r;m()(this,n),(r=t.call(this,e)).layer=e.h5ds.getLayer();var a=Object(Ee.toJS)(r.props.eventData);return r.state={value:a.eventParam.value},r}return g()(n,[{key:"changeText",value:function(e){this.setState({value:e.target.value})}},{key:"ok",value:function(){var e=this.state.value;return Q.isUrl(e)?(this.props.eventData.eventParam.value=e,!0):(ke.message.error("url格式不正确，格式示例：http://www.h5ds.com"),!1)}},{key:"render",value:function(){var e=this.state.value;return D.a.createElement(Zr,{layer:this.layer,id:this.props.id,close:this.props.close,name:"超链接",describe:"在输入框中输入要跳转到的链接地址就可以了",ok:this.ok,clear:this.clear},D.a.createElement("div",{className:"app-event-links-txt"},D.a.createElement("textarea",{style:{width:"100%"},placeholder:"请输入带http的链接地址",onChange:this.changeText,value:e})))}}]),n}(x.Component),se()(sa.prototype,"changeText",[be],Object.getOwnPropertyDescriptor(sa.prototype,"changeText"),sa.prototype),se()(sa.prototype,"ok",[be],Object.getOwnPropertyDescriptor(sa.prototype,"ok"),sa.prototype),ia=sa))||ia)||ia,name:"超链接",eventId:"h5ds_event_link",eventParam:{value:""},icon:D.a.createElement("i",{className:"app-ico app-ico-lianjie"})};n(618);function da(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var fa,ya,ma={EventEditor:Object(P.b)("h5ds")(la=Object(P.c)((ua=function(e){w()(n,e);var t=da(n);function n(e){var r;m()(this,n),(r=t.call(this,e)).layer=e.h5ds.getLayer();var a=Object(Ee.toJS)(r.props.eventData);return r.state={value:a.eventParam.value},r}return g()(n,[{key:"changeText",value:function(e){this.setState({value:e.target.value})}},{key:"ok",value:function(){var e=this.state.value;return Q.isPhoneNum(e)?(this.props.eventData.eventParam.value=e,!0):(ke.message.error("电话格式不正确，格式示例：13866688800"),!1)}},{key:"render",value:function(){var e=this.state.value;return D.a.createElement(Zr,{layer:this.layer,id:this.props.id,close:this.props.close,name:"发短信",describe:"在输入框中输入电话号码即可",ok:this.ok,clear:this.clear},D.a.createElement("div",{className:"app-event-links-txt"},D.a.createElement("input",{placeholder:"请输入电话号码",onChange:this.changeText,value:e})))}}]),n}(x.Component),se()(ua.prototype,"changeText",[be],Object.getOwnPropertyDescriptor(ua.prototype,"changeText"),ua.prototype),se()(ua.prototype,"ok",[be],Object.getOwnPropertyDescriptor(ua.prototype,"ok"),ua.prototype),la=ua))||la)||la,name:"发短信",eventId:"h5ds_event_msg",eventParam:{value:""},icon:D.a.createElement("i",{className:"app-ico app-ico-duanxin"})};n(620);function va(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var ga,ba,wa={EventEditor:Object(P.b)("h5ds")(fa=Object(P.c)((ya=function(e){w()(n,e);var t=va(n);function n(e){var r;m()(this,n),(r=t.call(this,e)).layer=e.h5ds.getLayer();var a=Object(Ee.toJS)(r.props.eventData);return r.state={value:a.eventParam.value},r}return g()(n,[{key:"changeText",value:function(e){this.setState({value:e.target.value})}},{key:"ok",value:function(){var e=this.state.value;return Q.isPhoneNum(e)?(this.props.eventData.eventParam.value=e,!0):(ke.message.error("电话格式不正确，格式示例：13866688800"),!1)}},{key:"render",value:function(){var e=this.state.value;return D.a.createElement(Zr,{layer:this.layer,id:this.props.id,close:this.props.close,name:"打电话",describe:"在输入框中输入电话号码即可",ok:this.ok,clear:this.clear},D.a.createElement("div",{className:"app-event-links-txt"},D.a.createElement("input",{placeholder:"请输入电话号码",onChange:this.changeText,value:e})))}}]),n}(x.Component),se()(ya.prototype,"changeText",[be],Object.getOwnPropertyDescriptor(ya.prototype,"changeText"),ya.prototype),se()(ya.prototype,"ok",[be],Object.getOwnPropertyDescriptor(ya.prototype,"ok"),ya.prototype),fa=ya))||fa)||fa,name:"打电话",eventId:"h5ds_event_tel",eventParam:{value:""},icon:D.a.createElement("i",{className:"app-ico app-ico-shoujidadianhua"})};n(622);function ka(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var Ea,Oa,Sa=[ra,ha,ca,ma,wa,{EventEditor:Object(P.b)("h5ds")(ga=Object(P.c)((ba=function(e){w()(n,e);var t=ka(n);function n(e){var r;m()(this,n),(r=t.call(this,e)).layer=e.h5ds.getLayer();var a=Object(Ee.toJS)(r.props.eventData);return r.state={value:a.eventParam.value},r}return g()(n,[{key:"changeVal",value:function(e){this.setState({value:e})}},{key:"ok",value:function(){var e=this.state.value;return Q.isEmpty(e)?(ke.message.error("请选择要跳转的页面"),!1):(this.props.eventData.eventParam.value=e,window.pubSubEditor.publish("h5ds.setHistory"),!0)}},{key:"render",value:function(){var e=this,t=this.state.value,n=this.props.h5ds.data.pages;return D.a.createElement(Zr,{layer:this.layer,id:this.props.id,close:this.props.close,name:"跳转页面",describe:"选择一个要跳转的页面，点击会触发交互效果，跳转到指定的页面",ok:this.ok,clear:this.clear},D.a.createElement("div",{className:"app-uebox-topages"},D.a.createElement("h4",null,"请选择您要跳转的页面："),D.a.createElement("ul",{id:"ueBoxToPage"},n.map((function(n,r){return D.a.createElement("li",{key:r,onClick:function(t){return e.changeVal(r)},title:n.name,className:parseInt(t,10)===r?"active":""},D.a.createElement("span",{className:"num"},r+1),D.a.createElement("span",{className:"name"},n.name))})))))}}]),n}(x.Component),se()(ba.prototype,"changeVal",[be],Object.getOwnPropertyDescriptor(ba.prototype,"changeVal"),ba.prototype),se()(ba.prototype,"ok",[be],Object.getOwnPropertyDescriptor(ba.prototype,"ok"),ba.prototype),ga=ba))||ga)||ga,name:"跳页面",eventId:"h5ds_event_topage",eventParam:{value:""},icon:D.a.createElement("i",{className:"app-ico app-ico-tiaozhuan"})}];function xa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var Da,Pa;Object(P.b)("h5ds")(Ea=Object(P.c)((Oa=function(e){w()(n,e);var t=xa(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).state={eventId:null,selectId:null},r}return g()(n,[{key:"addEvent",value:function(){this.props.h5ds.edata.eventListShow=!0}},{key:"closePanel",value:function(){window.pubSubEditor.publish("h5ds.setHistory"),this.setState({eventId:null})}},{key:"clickHandler",value:function(e,t){this.setState({eventId:e,selectId:t})}},{key:"componentWillUnmount",value:function(){this.props.h5ds.edata.eventListShow=!1}},{key:"render",value:function(){var e=this;this.layer=this.props.h5ds.getLayer();var t=this.state,n=t.eventId,r=t.selectId;if(!this.layer)return null;var a=this.layer.events,o=void 0===a?[]:a,i=(Sa.find((function(e){return e.eventId===n}))||{}).EventEditor;return D.a.createElement("div",{className:"app-event"},D.a.createElement("div",{className:"app-event-list"},D.a.createElement("ul",null,o.map((function(t){var n=t.eventId,r=t.id,a=t.name;return D.a.createElement("li",{onClick:function(){return e.clickHandler(n,r)},key:r,className:"app-event"},D.a.createElement("p",null,D.a.createElement("span",null,"事件名称："),a),D.a.createElement("p",null,D.a.createElement("a",null,"【点击设置参数】")))}))),this.props.h5ds.edata.eventListShow?null:D.a.createElement(ke.Button,{className:"app-basic-animateset-addbtn",onClick:this.addEvent,type:"primary",icon:"plus"},"添加事件")),D.a.createElement("div",{className:"app-event-set "+(n?"app-event-show":"app-event-hide")},i?D.a.createElement(i,{eventData:o.find((function(e){return e.id===r})),id:r,close:this.closePanel}):null))}}]),n}(x.Component),se()(Oa.prototype,"addEvent",[be],Object.getOwnPropertyDescriptor(Oa.prototype,"addEvent"),Oa.prototype),se()(Oa.prototype,"closePanel",[be],Object.getOwnPropertyDescriptor(Oa.prototype,"closePanel"),Oa.prototype),se()(Oa.prototype,"clickHandler",[be],Object.getOwnPropertyDescriptor(Oa.prototype,"clickHandler"),Oa.prototype),Ea=Oa))||Ea),n(624);function ja(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var Ca,Ra;Object(P.b)("h5ds","scope")(Da=Object(P.c)((Pa=function(e){w()(n,e);var t=ja(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).layer=e.h5ds.getLayer(),r.state={checked:!!r.layer.adsorb,active:"app-adsorbset-".concat(r.layer.adsorb)},r}return g()(n,[{key:"onChange",value:function(e){this.setState({checked:e}),this.layer.adsorb=""}},{key:"setAdsorb",value:function(e){this.setState({active:e}),this.layer.adsorb=e.replace("app-adsorbset-","")}},{key:"render",value:function(){var e=this,t=this.state,n=t.checked,r=t.active,a=(this.props.scope.pluginsKey[this.layer.pid]||{}).editorConfig,o=void 0===a?{}:a;return D.a.createElement("div",{className:"app-adsorbset"},!1!==o.adsorb&&D.a.createElement(_t,{name:"外框吸附"},D.a.createElement(ke.Switch,{checked:n,onChange:this.onChange}),n?D.a.createElement(D.a.Fragment,null,D.a.createElement("div",{className:"app-adsorbset-tips"},"外框吸附说明：吸附效果会根据整个视图区域进行定位，选择一个相对的对齐点"),D.a.createElement("div",{className:"app-adsorbset-dots"},["app-adsorbset-top-left","app-adsorbset-top-center","app-adsorbset-top-right","app-adsorbset-left-center","app-adsorbset-right-center","app-adsorbset-bottom-left","app-adsorbset-bottom-center","app-adsorbset-bottom-right"].map((function(t){var n=[t];return t===r&&n.push("app-adsorbset-active"),D.a.createElement("a",{onClick:function(){return e.setAdsorb(t)},key:t,className:n.join(" ")})})))):null))}}]),n}(x.Component),se()(Pa.prototype,"onChange",[be],Object.getOwnPropertyDescriptor(Pa.prototype,"onChange"),Pa.prototype),se()(Pa.prototype,"setAdsorb",[be],Object.getOwnPropertyDescriptor(Pa.prototype,"setAdsorb"),Pa.prototype),Da=Pa))||Da),n(626);function Ia(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var Na,La;Object(P.b)("h5ds","scope")(Ca=Object(P.c)((Ra=function(e){w()(n,e);var t=Ia(n);function n(e){var r;m()(this,n),(r=t.call(this,e)).layer=e.h5ds.getLayer();var a=r.layer.style,o=a.width,i=a.height,s=a.top,c=a.left;return r.state={width:o,height:i,top:s,left:c,id:r.layer.id,className:r.layer.className},r.aspectRatio=i?o/i:1,r}return g()(n,[{key:"setLayer",value:function(){var e=this,t=this.state,n=t.id,r=t.className,a=pe()(t,["id","className"]),o=this.props.h5ds.edata;Object(Ee.transaction)((function(){var t=e.layer.style;e.layer.id=n,e.layer.className=r,["width","height","top","left"].forEach((function(e){t[e]=a[e]})),o.keys=Q.randomID(),window.pubSubEditor.publish("h5ds.setHistory")})),this.isInnerChange=!1}},{key:"lockWideHighFormatValue",value:function(e,t){if(!["width","height"].includes(t))return e;if(this.layer.set.lockWideHigh){var n=this.state,r=n.width,a=n.height;return"width"===t?(r=e,a=parseInt(r/this.aspectRatio,10)):(a=e,r=parseInt(a*this.aspectRatio,10)),this.setState({width:r,height:a},this.setLayer),"break"}return e}},{key:"onChange",value:function(e,t){this.isInnerChange=!0,"break"!==this.lockWideHighFormatValue(e,t)&&this.setState(C()({},t,e),this.setLayer)}},{key:"mouseWheelVal",value:function(e,t){this.isInnerChange=!0,"break"!==this.lockWideHighFormatValue(this.state[e]+t,e)&&this.setState(C()({},e,this.state[e]+t),this.setLayer)}},{key:"flipLayer",value:function(e){var t=this,n=this.layer.style.flip,r=void 0===n?[1,1]:n,a=A()(r,2),o=a[0],i=void 0===o?1:o,s=a[1],c=void 0===s?1:s;"left-right"===e?i=1===parseInt(i,10)?-1:1:c=1===parseInt(c,10)?-1:1,Object(Ee.transaction)((function(){t.layer.style.flip=[i,c],t.props.h5ds.edata.keys=Q.randomID(),window.pubSubEditor.publish("h5ds.setHistory")}))}},{key:"setLockWideHigh",value:function(){var e=this;Object(Ee.transaction)((function(){if(e.layer.set.lockWideHigh=!e.layer.set.lockWideHigh,e.layer.set.lockWideHigh){var t=e.state,n=t.width,r=t.height;e.aspectRatio=r?n/r:1}e.props.h5ds.edata.keys=Q.randomID(),e.props.h5ds.setControlLockWideHigh(e.layer.set.lockWideHigh),window.pubSubEditor.publish("h5ds.setHistory")}))}},{key:"componentDidMount",value:function(){var e=this,t=this.props.scope.pluginsKey;window.pubSubEditor.subscribe("h5ds.shortcuts_y",(function(n){var r=e.layer,a=r.style,o=r.pid,i=(t[o]||{}).editorConfig;!1!==(void 0===i?{}:i).y&&e.onChange((a.top||0)+n,"top")})),window.pubSubEditor.subscribe("h5ds.shortcuts_x",(function(n){var r=e.layer,a=r.style,o=r.pid,i=(t[o]||{}).editorConfig;!1!==(void 0===i?{}:i).x&&e.onChange((a.left||0)+n,"left")})),$(document).on("mousewheel.h5ds.basicSet",".app-scroll-BasicSet",(function(t){t.stopPropagation();var n=$(t.target).attr("data-key");e.mouseWheelVal(n,t.originalEvent.deltaY<0?-1:1)}))}},{key:"componentWillUnmount",value:function(){$(document).off("mousewheel.h5ds.basicSet"),window.pubSubEditor.unsubscribe("h5ds.shortcuts_y"),window.pubSubEditor.unsubscribe("h5ds.shortcuts_x")}},{key:"componentWillReact",value:function(){if(!this.isInnerChange){var e=this.layer.style,t=e.width,n=e.height,r=e.top,a=e.left,o=this.layer,i=o.id,s=o.className;this.setState({width:t,height:n,top:r,left:a,id:i,className:s})}}},{key:"render",value:function(){var e=this;if(!this.layer)return null;this.layer.id,this.layer.className,this.layer.style.top,this.layer.style.left,this.layer.style.width,this.layer.style.height;var t=(this.props.scope.pluginsKey[this.layer.pid]||{}).editorConfig,n=void 0===t?{}:t,r=this.state,a=r.width,o=r.height,i=r.left,s=r.top,c=r.id,p=r.className;return D.a.createElement("div",{className:"app-baiscset"},D.a.createElement(Nt,{span:2},D.a.createElement(_t,{name:"ID"},D.a.createElement(ke.Input,{size:"small",type:"text",onChange:function(t){return e.onChange(t.target.value,"id")},placeholder:"id名字",value:c}))),D.a.createElement(Nt,{span:2},D.a.createElement(_t,{name:"class"},D.a.createElement(ke.Input,{size:"small",type:"text",onChange:function(t){return e.onChange(t.target.value,"className")},placeholder:"class名字",value:p}))),!1!==n.left&&D.a.createElement(Nt,{span:2},D.a.createElement(_t,{name:"x坐标"},D.a.createElement(ke.InputNumber,{className:"app-scroll-BasicSet","data-key":"left",size:"small",min:-1/0,max:1/0,placeholder:"x坐标",value:i,onChange:function(t){return e.onChange(t,"left")}}))),!1!==n.top&&D.a.createElement(Nt,{span:2},D.a.createElement(_t,{name:"y坐标"},D.a.createElement(ke.InputNumber,{className:"app-scroll-BasicSet","data-key":"top",size:"small",min:-1/0,max:1/0,placeholder:"y坐标",value:s,onChange:function(t){return e.onChange(t,"top")}}))),!1!==n.width&&D.a.createElement(Nt,{span:2},D.a.createElement(_t,{name:"宽度"},D.a.createElement(ke.InputNumber,{className:"app-scroll-BasicSet","data-key":"width",size:"small",min:0,max:1/0,placeholder:"宽",value:a,onChange:function(t){return e.onChange(t,"width")}}),D.a.createElement("i",{onClick:this.setLockWideHigh,className:["app-chain-width-height app-ico app-ico-chain",this.layer.set.lockWideHigh?"app-chain-width-height-active":""].join(" ")}))),!1!==n.height&&D.a.createElement(Nt,{span:2},D.a.createElement(_t,{name:"高度"},D.a.createElement(ke.InputNumber,{className:"app-scroll-BasicSet","data-key":"height",size:"small",min:0,max:1/0,placeholder:"高",value:o,onChange:function(t){return e.onChange(t,"height")}}))),!1!==n.flip&&D.a.createElement(Nt,null,D.a.createElement(_t,{className:"app-layer-flip",name:"翻转"},D.a.createElement("a",{className:"",onClick:function(){return e.flipLayer("left-right")}},"左右翻转"),"  ",D.a.createElement("a",{onClick:function(){return e.flipLayer("up-down")}},"上下翻转"))))}}]),n}(x.Component),se()(Ra.prototype,"setLayer",[be],Object.getOwnPropertyDescriptor(Ra.prototype,"setLayer"),Ra.prototype),se()(Ra.prototype,"lockWideHighFormatValue",[be],Object.getOwnPropertyDescriptor(Ra.prototype,"lockWideHighFormatValue"),Ra.prototype),se()(Ra.prototype,"onChange",[be],Object.getOwnPropertyDescriptor(Ra.prototype,"onChange"),Ra.prototype),se()(Ra.prototype,"mouseWheelVal",[be],Object.getOwnPropertyDescriptor(Ra.prototype,"mouseWheelVal"),Ra.prototype),se()(Ra.prototype,"setLockWideHigh",[be],Object.getOwnPropertyDescriptor(Ra.prototype,"setLockWideHigh"),Ra.prototype),Ca=Ra))||Ca),n(628);function Aa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var _a,Ta,za=Object(P.b)("h5ds")(Na=Object(P.c)((La=function(e){w()(n,e);var t=Aa(n);function n(e){var r;m()(this,n),(r=t.call(this,e)).setLayer=Q.debounce((function(){var e=r.state,t=e.bsize,n=void 0===t?2:t,a=e.btype,o=void 0===a?"solid":a,i=e.bcolor,s=void 0===i?"rgba(0,0,0,1)":i,c=r.layer.estyle,p=r.props.h5ds.edata;Object(Ee.transaction)((function(){Q.isEmpty(c.border)?Object(Ee.extendObservable)(c,{border:"".concat(n,"px ").concat(o," ").concat(s)}):c.border=ye.setBorder(c.border,{size:n,type:o,color:s}),p.keys=Q.randomID(),window.pubSubEditor.publish("h5ds.setHistory")}))}),300),r.layer=e.h5ds.getLayer();var a=r.layer.estyle,o=ye.getBorder(a.border),i=o.size,s=void 0===i?0:i,c=o.type,p=o.color;return r.state={bsize:s,btype:c,bcolor:p},r}return g()(n,[{key:"switchBorder",value:function(e){e?this.setState({bsize:2,btype:"solid",bcolor:"rgba(0,0,0,1)"},this.setLayer):this.setState({bsize:0,btype:"solid",bcolor:"rgba(0,0,0,1)"},this.setLayer)}},{key:"changeBorderType",value:function(e){this.setState({btype:e},this.setLayer)}},{key:"changeBorderSize",value:function(e){this.setState({bsize:e},this.setLayer)}},{key:"setBorderColor",value:function(e){var t=e.rgb,n=t.r,r=t.g,a=t.b,o=t.a,i=void 0===o?1:o;this.setState({bcolor:"rgba(".concat(n,",").concat(r,",").concat(a,",").concat(i,")")},this.setLayer)}},{key:"componentDidMount",value:function(){var e=this;$(".app-scroll-SetBorder").on("mousewheel.h5ds.SetBorder",(function(t){t.preventDefault();var n=t.originalEvent.deltaY<0?-1:1;(n=e.state.bsize+n)<0&&(n=0),e.setState({bsize:n},e.setLayer)}))}},{key:"componentWillUnmount",value:function(){$(".app-scroll-SetBorder").off("mousewheel.h5ds.SetBorder")}},{key:"render",value:function(){var e=ke.Select.Option,t=this.state,n=t.bsize,r=void 0===n?0:n,a=t.btype,o=t.bcolor;return D.a.createElement("div",null,D.a.createElement(Nt,{span:1},D.a.createElement(_t,{name:"开启边框"},D.a.createElement(ke.Switch,{onChange:this.switchBorder,checked:!!r}))),r?D.a.createElement("div",null,D.a.createElement(Nt,{span:1},D.a.createElement(_t,{name:"边框类型"},D.a.createElement(ke.Select,{size:"small",onChange:this.changeBorderType,value:a||"",style:{width:100},placeholder:"下拉选择"},D.a.createElement(e,{value:"solid"},"实线"),D.a.createElement(e,{value:"double"},"双线"),D.a.createElement(e,{value:"dashed"},"虚线"),D.a.createElement(e,{value:"dotted"},"点线")))),D.a.createElement(Nt,{span:2},D.a.createElement(_t,{name:"边框大小"},D.a.createElement(ke.InputNumber,{className:"app-scroll-SetBorder",size:"small",min:1,max:1e4,value:r,onChange:this.changeBorderSize}))),D.a.createElement(Nt,{span:2},D.a.createElement(_t,{name:"边框颜色"},D.a.createElement(Rt,{onChange:this.setBorderColor,color:o})))):null)}}]),n}(x.Component),se()(La.prototype,"switchBorder",[be],Object.getOwnPropertyDescriptor(La.prototype,"switchBorder"),La.prototype),se()(La.prototype,"changeBorderType",[be],Object.getOwnPropertyDescriptor(La.prototype,"changeBorderType"),La.prototype),se()(La.prototype,"changeBorderSize",[be],Object.getOwnPropertyDescriptor(La.prototype,"changeBorderSize"),La.prototype),se()(La.prototype,"setBorderColor",[be],Object.getOwnPropertyDescriptor(La.prototype,"setBorderColor"),La.prototype),Na=La))||Na)||Na;function Ha(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var $a,Wa,Ma=Object(P.b)("h5ds")(_a=Object(P.c)((Ta=function(e){w()(n,e);var t=Ha(n);function n(e){var r;m()(this,n),(r=t.call(this,e)).setLayer=Q.debounce((function(){var e=r.state.borderRadius,t=r.layer.estyle;Object(Ee.transaction)((function(){void 0===t.borderRadius?Object(Ee.extendObservable)(t,{borderRadius:e}):t.borderRadius=e,r.props.h5ds.edata.keys=Q.randomID(),window.pubSubEditor.publish("h5ds.setHistory")})),r.isInnerChange=!1}),500),r.layer=e.h5ds.getLayer(),r.element=e.h5ds.getLayerDom().find(".element");var a=r.layer.estyle.borderRadius||0;return r.state={borderRadius:a},r}return g()(n,[{key:"componentWillReact",value:function(){if(!this.isInnerChange){var e=this.layer.estyle.borderRadius;this.setState({borderRadius:e})}}},{key:"sliderChange",value:function(e){this.isInnerChange=!0,this.element.css("border-radius",e+"px"),this.setState({borderRadius:e},this.setLayer)}},{key:"componentDidMount",value:function(){var e=this;$(".app-scroll-SetBorderRadius").on("mousewheel.h5ds.SetBorderRadius",(function(t){t.preventDefault(),e.isInnerChange=!0;var n=t.originalEvent.deltaY<0?-1:1;(n=e.state.borderRadius+n)<0&&(n=0),e.setState({borderRadius:n},e.setLayer)}))}},{key:"componentWillUnmount",value:function(){$(".app-scroll-SetBorderRadius").off("mousewheel.h5ds.SetBorderRadius")}},{key:"render",value:function(){var e=this.state.borderRadius;return this.layer.estyle.borderRadius,D.a.createElement(_t,{name:"设置圆角"},D.a.createElement(Sn,{mouseWheelClassName:"app-scroll-SetBorderRadius",onChange:this.sliderChange,value:e,min:0,max:1e3}))}}]),n}(x.Component),se()(Ta.prototype,"sliderChange",[be],Object.getOwnPropertyDescriptor(Ta.prototype,"sliderChange"),Ta.prototype),_a=Ta))||_a)||_a;function Ba(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var Fa,Va,Ga=Object(P.b)("h5ds")($a=Object(P.c)((Wa=function(e){w()(n,e);var t=Ba(n);function n(e){var r;m()(this,n),(r=t.call(this,e)).setLayer=Q.debounce((function(){var e=r.state,t=e.bsize,n=e.bcolor,a=void 0===n?"rgba(0,0,0,1)":n,o=r.layer.estyle,i=r.props.h5ds.edata;Object(Ee.transaction)((function(){Q.isEmpty(o.boxShadow)?Object(Ee.extendObservable)(o,{boxShadow:"0 0 ".concat(t,"px ").concat(a)}):o.boxShadow=ye.setBoxshadow(o.border,{size:t,color:a}),null===t&&(o.boxShadow="none"),i.keys=Q.randomID(),window.pubSubEditor.publish("h5ds.setHistory")}))}),500),r.layer=e.h5ds.getLayer();var a=r.layer.estyle,o=ye.getBoxshadow(a.boxShadow),i=o.size,s=void 0===i?null:i,c=o.color;return r.state={bsize:s,bcolor:c},r}return g()(n,[{key:"sliderChange",value:function(e){var t=this.state.bcolor,n=void 0===t?"rgba(0,0,0,1)":t,r=this.layer.estyle,a=ye.setBoxshadow(r.border,{size:e,color:n});this.props.h5ds.getLayerDom().find(".element").css("box-shadow",a),this.setState({bsize:e},this.setLayer)}},{key:"switchDo",value:function(e){e?this.setState({bsize:2,bcolor:"rgba(0,0,0,1)"},this.setLayer):this.setState({bsize:null},this.setLayer)}},{key:"setColor",value:function(e){var t=e.rgb,n=t.r,r=t.g,a=t.b,o=t.a,i=void 0===o?1:o;this.setState({bcolor:"rgba(".concat(n,",").concat(r,",").concat(a,",").concat(i,")")},this.setLayer)}},{key:"componentDidMount",value:function(){var e=this;$(".app-scroll-SetBoxShadow").on("mousewheel.h5ds.SetBoxShadow",(function(t){t.preventDefault();var n=t.originalEvent.deltaY<0?-1:1;(n=e.state.bsize+n)<0?n=0:n>100&&(n=100),e.setState({bsize:n},e.setLayer)}))}},{key:"componentWillUnmount",value:function(){$(".app-scroll-SetBoxShadow").off("mousewheel.h5ds.SetBoxShadow")}},{key:"render",value:function(){var e=this.state,t=e.bsize,n=e.bcolor;return D.a.createElement("div",null,D.a.createElement(Nt,null,D.a.createElement(_t,{name:"开启阴影"},D.a.createElement(ke.Switch,{onChange:this.switchDo,checked:!!t}))),null!==t?D.a.createElement(D.a.Fragment,null,D.a.createElement(_t,{name:"阴影设置"},D.a.createElement(Sn,{mouseWheelClassName:"app-scroll-SetBoxShadow",onChange:this.sliderChange,value:t,min:0,max:100})),D.a.createElement(_t,{name:"阴影颜色"},D.a.createElement(Rt,{onChange:this.setColor,color:n}))):null)}}]),n}(x.Component),se()(Wa.prototype,"sliderChange",[be],Object.getOwnPropertyDescriptor(Wa.prototype,"sliderChange"),Wa.prototype),se()(Wa.prototype,"switchDo",[be],Object.getOwnPropertyDescriptor(Wa.prototype,"switchDo"),Wa.prototype),se()(Wa.prototype,"setColor",[be],Object.getOwnPropertyDescriptor(Wa.prototype,"setColor"),Wa.prototype),$a=Wa))||$a)||$a;function Ua(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var Ya,Ja,qa=Object(P.b)("h5ds")(Fa=Object(P.c)((Va=function(e){w()(n,e);var t=Ua(n);function n(e){var r;m()(this,n),(r=t.call(this,e)).setLayer=Q.debounce((function(){var e=r.state.backgroundColor,t=r.layer.estyle;Object(Ee.transaction)((function(){void 0===t.backgroundColor?Object(Ee.extendObservable)(t,{backgroundColor:e}):t.backgroundColor=e,r.props.h5ds.edata.keys=Q.randomID(),window.pubSubEditor.publish("h5ds.setHistory")}))}),200),r.layer=e.h5ds.getLayer();var a=r.layer.estyle.backgroundColor,o=void 0===a?"rgba(0,0,0,1)":a;return r.state={backgroundColor:o},r}return g()(n,[{key:"changeColor",value:function(e){var t=e.rgb,n=t.r,r=t.g,a=t.b,o=t.a;this.setState({backgroundColor:"rgba(".concat(n,",").concat(r,",").concat(a,",").concat(o,")")},this.setLayer)}},{key:"render",value:function(){var e=this.state.backgroundColor;return this.layer.estyle.backgroundColor,D.a.createElement(Nt,{span:1},D.a.createElement(Ht,{title:"背景颜色",color:e,onChange:this.changeColor}))}}]),n}(x.Component),se()(Va.prototype,"changeColor",[be],Object.getOwnPropertyDescriptor(Va.prototype,"changeColor"),Va.prototype),Fa=Va))||Fa)||Fa;function Xa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var Ka,Qa=Object(P.b)("h5ds")(Ya=Object(P.c)((Ja=function(e){w()(n,e);var t=Xa(n);function n(e){var r;m()(this,n),(r=t.call(this,e)).layer=e.h5ds.getLayer();var a=r.layer.style.display||"block";return r.state={hide:"none"===a},r}return g()(n,[{key:"setLayer",value:function(){var e=this,t=this.state.hide,n=this.layer.style,r="block";t&&(r="none"),Object(Ee.transaction)((function(){void 0===n.display?Object(Ee.extendObservable)(n,{display:r}):n.display=r,e.props.h5ds.edata.keys=Q.randomID(),window.pubSubEditor.publish("h5ds.setHistory")}))}},{key:"changeColor",value:function(e){this.setState({hide:e},this.setLayer)}},{key:"render",value:function(){var e=this.state.hide;return this.layer.style.display,D.a.createElement(Nt,{span:1},D.a.createElement(_t,{name:"隐藏元素"},D.a.createElement(ke.Switch,{onChange:this.changeColor,checked:e})))}}]),n}(x.Component),se()(Ja.prototype,"setLayer",[be],Object.getOwnPropertyDescriptor(Ja.prototype,"setLayer"),Ja.prototype),se()(Ja.prototype,"changeColor",[be],Object.getOwnPropertyDescriptor(Ja.prototype,"changeColor"),Ja.prototype),Ya=Ja))||Ya)||Ya;function Za(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var eo,to,no=Object(P.b)("h5ds")(Ka=Object(P.c)(Ka=function(e){w()(n,e);var t=Za(n);function n(e){var r;m()(this,n),(r=t.call(this,e)).setLayer=Q.debounce((function(){var e=r.state.opacity,t=r.layer.style;Object(Ee.transaction)((function(){void 0===t.opacity?Object(Ee.extendObservable)(t,{opacity:e}):t.opacity=e,r.props.h5ds.edata.keys=Q.randomID(),window.pubSubEditor.publish("h5ds.setHistory")}))}),500),r.sliderChange=function(e){r.layerdom.css("opacity",e),r.setState({opacity:e},r.setLayer)},r.layer=e.h5ds.getLayer(),r.layerdom=e.h5ds.getLayerDom();var a=r.layer.style.opacity||1;return r.state={opacity:a},r}return g()(n,[{key:"componentDidMount",value:function(){var e=this;$(".app-scroll-SetOpacity").on("mousewheel.h5ds.SetOpacity",(function(t){t.preventDefault();var n=t.originalEvent.deltaY<0?-.1:.1;(n=e.state.opacity+n)<0?n=0:n>1&&(n=1),e.setState({opacity:n},e.setLayer)}))}},{key:"componentWillUnmount",value:function(){$(".app-scroll-SetOpacity").off("mousewheel.h5ds.SetOpacity")}},{key:"render",value:function(){var e=this.state.opacity;return this.layer.style.opacity,D.a.createElement(_t,{name:"透明度"},D.a.createElement(Sn,{mouseWheelClassName:"app-scroll-SetOpacity",onChange:this.sliderChange,value:e,step:.1,min:0,max:1}))}}]),n}(x.Component))||Ka)||Ka;function ro(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var ao,oo=Object(P.b)("h5ds")(eo=Object(P.c)((to=function(e){w()(n,e);var t=ro(n);function n(e){var r;m()(this,n),(r=t.call(this,e)).setLayer=Q.debounce((function(){var e=r.state.rotate,t=r.layer.style,n=ye.setTransform(t.transform,{rotate:e});Object(Ee.transaction)((function(){t.transform=n,r.props.h5ds.edata.keys=Q.randomID(),window.pubSubEditor.publish("h5ds.setHistory")})),r.isInnerChange=!1}),500),r.layer=e.h5ds.getLayer(),r.layerdom=e.h5ds.getLayerDom();var a=ye.getTransform(r.layer.style.transform);return r.state={rotate:a.rotate},r}return g()(n,[{key:"componentWillReact",value:function(){if(!this.isInnerChange){var e=ye.getTransform(this.layer.style.transform);this.setState({rotate:e.rotate})}}},{key:"sliderChange",value:function(e){this.isInnerChange=!0;var t=ye.setTransform(this.layer.style.transform,{rotate:e});this.layerdom.css("transform",t),this.setState({rotate:e},this.setLayer)}},{key:"componentDidMount",value:function(){var e=this;$(".app-scroll-SetRotate").on("mousewheel.h5ds.SetRotate",(function(t){t.preventDefault(),e.isInnerChange=!0;var n=t.originalEvent.deltaY<0?-1:1;(n=e.state.rotate+n)<0?n=0:n>360&&(n=360),e.setState({rotate:n},e.setLayer)}))}},{key:"componentWillUnmount",value:function(){$(".app-scroll-SetRotate").off("mousewheel.h5ds.SetRotate")}},{key:"render",value:function(){var e=this.state.rotate;return this.layer.style.transform,D.a.createElement(_t,{name:"旋转角度"},D.a.createElement(Sn,{mouseWheelClassName:"app-scroll-SetRotate",onChange:this.sliderChange,value:e,min:0,max:360}))}}]),n}(x.Component),se()(to.prototype,"sliderChange",[be],Object.getOwnPropertyDescriptor(to.prototype,"sliderChange"),to.prototype),eo=to))||eo)||eo;function io(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var so,co;Object(P.b)("h5ds","scope")(ao=Object(P.c)(ao=function(e){w()(n,e);var t=io(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).layer=e.h5ds.getLayer(),r}return g()(n,[{key:"render",value:function(){if(!this.layer)return null;var e=(this.props.scope.pluginsKey[this.layer.pid]||{}).editorConfig,t=void 0===e?{}:e;return D.a.createElement("div",{className:"app-layout-moreset"},!1!==t.rotate&&D.a.createElement(oo,null),!1!==t.borderRadius&&D.a.createElement(Ma,null),!1!==t.opacity&&D.a.createElement(no,null),!1!==t.backgroundColor&&D.a.createElement(qa,null),!1!==t.hide&&D.a.createElement(Qa,null),!1!==t.shadow&&D.a.createElement(Ga,null),!1!==t.border&&D.a.createElement(za,null))}}]),n}(x.Component))||ao);function po(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var lo,uo,ho=Object(P.b)("h5ds","scope")(so=Object(P.c)((co=function(e){w()(n,e);var t=po(n);function n(){return m()(this,n),t.apply(this,arguments)}return g()(n,[{key:"doRender",value:function(){var e=null,t=this.props.h5ds.getLayer(),n=this.props.scope.pluginsKey[t.pid];return n?e=n.Editor||null:ke.message.error("无".concat(t.name,":").concat(t.pid,"图层！")),e}},{key:"render",value:function(){var e=this.props.h5ds.getLayer();if(!e)return null;var t=this.doRender();return D.a.createElement("div",{key:e.keyid},t?D.a.createElement(t,{scope:this.props.scope,h5ds:this.props.h5ds,layer:e}):null)}}]),n}(x.Component),se()(co.prototype,"doRender",[be],Object.getOwnPropertyDescriptor(co.prototype,"doRender"),co.prototype),so=co))||so)||so;function fo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var yo,mo,vo=Object(P.b)("h5ds","scope")(lo=Object(P.c)((uo=function(e){w()(n,e);var t=fo(n);function n(){return m()(this,n),t.apply(this,arguments)}return g()(n,[{key:"changeTabs",value:function(){var e=this;Object(Ee.transaction)((function(){e.props.h5ds.edata.eventListShow=!1,e.props.h5ds.edata.animateListShow=!1}))}},{key:"render",value:function(){var e=this.props.h5ds,t=e.edata.selectlayerKeys,n=e.getLayer();if(!n)return null;(this.props.scope.pluginsKey[n.pid]||{}).editorConfig,ke.Tabs.TabPane;return D.a.createElement("div",{className:"app-layerset"},D.a.createElement("div",{className:"app-layerset-tabsbox"},D.a.createElement(ho,{key:t+"1"})))}}]),n}(x.Component),se()(uo.prototype,"changeTabs",[be],Object.getOwnPropertyDescriptor(uo.prototype,"changeTabs"),uo.prototype),lo=uo))||lo)||lo;n(630);function go(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var wo,ko=Object(P.b)("h5ds","scope")(yo=Object(P.c)((mo=function(e){w()(n,e);var t=bo(n);function n(e){var r;m()(this,n),(r=t.call(this,e)).setInfo=Q.debounce((function(){var e=r.state,t=e.id,n=e.name,a=e.desc,o=e.className,i="id, class 必须是字母或者下划线开头，且必须由字母，数字，或者下划线组成！";(!t||/^[_a-z][_a-z0-9]+/i.test(t))&&(!o||/^[_a-z][_a-z0-9]+/i.test(o))?Object(Ee.transaction)((function(){r.page.id=t,r.page.className=o,r.page.name=n,r.page.desc=a,r.props.h5ds.edata.pageListKeys=Q.randomID(),window.pubSubEditor.publish("h5ds.setHistory")})):ke.message.error(i)}),500),r.page=e.h5ds.getPage()||{};var a=r.page.style||{},o=a.backgroundImage,i=void 0===o?"":o,s=a.backgroundGlobal,c=void 0!==s&&s,p=a.backgroundRepeat,l=void 0===p?"no-repeat":p,u=a.backgroundSize,h=void 0===u?"initial":u,d=a.backgroundColor,f=void 0===d?"":d,y=a.backgroundImageCrop,v=void 0===y?"{}":y,g=Object(Ee.toJS)(r.page.slider)||{animate:1,autoplay:!1,lock:!1,time:5},b=r.page,w=b.name,k=b.id,E=b.className,O=b.desc;return r.state={name:w,id:k,className:E,desc:O,backgroundImageCrop:v,backgroundImage:i,backgroundRepeat:l,backgroundSize:h,backgroundColor:f,backgroundGlobal:c,slider:g},r}return g()(n,[{key:"switchDo",value:function(e,t){var n=this.state.slider;n[t]=e,this.setState({slider:n}),this.page.slider=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?go(Object(n),!0).forEach((function(t){C()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):go(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n),window.pubSubEditor.publish("h5ds.setHistory")}},{key:"backGroundChange",value:function(e){var t=this.props.h5ds,n=t.getPage();Object(Ee.transaction)((function(){for(var r in e){var a=e[r];void 0===n.style[r]?Object(Ee.extendObservable)(n.style,C()({},r,a)):n.style[r]=a}t.edata.keys=Q.randomID(),window.pubSubEditor.publish("h5ds.setHistory")}))}},{key:"onChangeSize",value:function(e,t){var n=this;Object(Ee.transaction)((function(){var r=n.props.h5ds.data;"appWidth"===t?(r.style.width=e,r.pages.forEach((function(t){t.style.width=e}))):"pageHeigt"===t&&(n.page.style.height=e,"pc"===r.type&&(r.style.height=e)),window.pubSubEditor.publish("h5ds.setHistory")}))}},{key:"changeVal",value:function(e,t){this.setState(C()({},t,e),this.setInfo)}},{key:"render",value:function(){var e=this;if(this.page=this.props.h5ds.getPage(),this.page){var t=this.state,n=t.slider,r=t.name,a=(t.id,t.className,t.desc,pe()(t,["slider","name","id","className","desc"]),ke.Tabs.TabPane);n.lock,n.autoplay,n.time,n.showScroll,ke.Input.TextArea;return D.a.createElement("div",{className:"app-pageset"},D.a.createElement(ke.Tabs,{defaultActiveKey:"1",className:"app-basic-tabs"},D.a.createElement(a,{key:"1",tab:"页面样式"},D.a.createElement(Nt,{span:1},D.a.createElement(_t,{name:"页面名字"},D.a.createElement(ke.Input,{size:"small",value:r,onChange:function(t){return e.changeVal(t.target.value,"name")}}))))))}return D.a.createElement("div",{className:"app-pageset-null"},"未选中任何页面")}}]),n}(x.Component),se()(mo.prototype,"switchDo",[be],Object.getOwnPropertyDescriptor(mo.prototype,"switchDo"),mo.prototype),se()(mo.prototype,"backGroundChange",[be],Object.getOwnPropertyDescriptor(mo.prototype,"backGroundChange"),mo.prototype),se()(mo.prototype,"onChangeSize",[be],Object.getOwnPropertyDescriptor(mo.prototype,"onChangeSize"),mo.prototype),se()(mo.prototype,"changeVal",[be],Object.getOwnPropertyDescriptor(mo.prototype,"changeVal"),mo.prototype),yo=mo))||yo)||yo;function Eo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var Oo,So=Object(P.b)("h5ds")(wo=Object(P.c)(wo=function(e){w()(n,e);var t=Eo(n);function n(){return m()(this,n),t.apply(this,arguments)}return g()(n,[{key:"render",value:function(){var e=this.props.h5ds.edata,t=e.setType,n=e.selectType,r=e.selectFixed,a=e.selectPage,o=e.selectPopup,i=null;switch(t){case"layer":i=D.a.createElement(vo,null);break;case"page":i=D.a.createElement(ko,{key:n+r+a+o});break;case"app":i=D.a.createElement(Yr,null)}return D.a.createElement("div",{className:"app-editarea app-js-setting"},i)}}]),n}(x.Component))||wo)||wo;n(632),n(634);function xo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var Do,Po;Oo=function(e){w()(n,e);var t=xo(n);function n(){return m()(this,n),t.apply(this,arguments)}return g()(n,[{key:"onClick",value:function(e){this.props.onClick&&this.props.onClick(e,this.data)}},{key:"render",value:function(){this.data=this.props.data;var e=this.props.data,t=e.pid,n=e.name,r=void 0===n?"未命名":n,a=e.version,o=void 0===a?"1.0.0":a,i=e.icon;return D.a.createElement("div",{className:"app-plugin-item"},D.a.createElement("div",{onClick:this.onClick,className:"app-plugin-span app-plugin-pic"},i||D.a.createElement("i",{className:"app-ico app-ico-domnode"})),D.a.createElement("div",{className:"app-plugin-span app-plugin-info"},D.a.createElement("h1",{onClick:this.onClick},r),D.a.createElement("p",null,D.a.createElement("em",null,"version:")," ",o),D.a.createElement("p",null,D.a.createElement("a",{href:t,target:"_blank",rel:"noopener noreferrer"},"插件详情"))))}}]),n}(x.Component),se()(Oo.prototype,"onClick",[be],Object.getOwnPropertyDescriptor(Oo.prototype,"onClick"),Oo.prototype);function jo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Co(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jo(Object(n),!0).forEach((function(t){C()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ro(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var Io=Object(P.b)("h5ds","scope")(Do=Object(P.c)((Po=function(e){w()(n,e);var t=Ro(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).state={visible:!1,width:window.innerWidth,layerMenus:[]},r.eventId=Q.randomID(),r}return g()(n,[{key:"addLayer",value:function(e){window.pubSubEditor.publish("h5ds.destoryControl"),this.setState({visible:!1});for(var t=this.props.h5ds,n=this.props.scope.pluginsKey,r=arguments.length,a=new Array(r>1?r-1:0),o=1;o<r;o++)a[o-1]=arguments[o];var i=t.getJsonByPid.apply(t,[n,e].concat(a)),s=!!n[e]&&n[e].selectIcon;if("h5ds_shape"!==i.pid){var c=t.addLayerGetCenterPosition(i),p=c.left,l=c.top;i.style.left=p,i.style.top=l}var u=function(){t.addLayer(i),t.edata.keys=Q.randomID(),t.setLayer(0)};void 0===s?u():s instanceof Promise?s(Co({pid:e},this.props)).then((function(){u()})).fail((function(e){console.warn("layer添加错误",e),ke.message.error("添加layer错误！")})):s(Co({pid:e},this.props))}},{key:"initLayerMenusData",value:function(){var e=[];this.props.scope.plugins.forEach((function(t){var n=t.name,r=t.icon,a=t.pid;"h5ds_combin"!==a&&e.push({name:n,icon:r,pid:a})})),this.setState({layerMenus:e})}},{key:"showModal",value:function(){this.setState({visible:!0})}},{key:"closeModal",value:function(){this.setState({visible:!1})}},{key:"componentDidMount",value:function(){var e=this;this.initLayerMenusData(),$(window).on("resize.h5ds.layermenu",(function(){e.setState({width:window.innerWidth})}))}},{key:"componentWillUnmount",value:function(){$(window).off("resize.h5ds.layermenu")}},{key:"render",value:function(){var e=this,t=this.state,n=(t.visible,t.layerMenus),r=t.width;return D.a.createElement("div",{className:"app-layermenu-inner app-js-layermenu"},D.a.createElement("ul",{className:"app-layermenu-moreuse"},r>1e3?n.map((function(t,n){return n>5?null:D.a.createElement("li",{key:n,className:"fun",onClick:function(){return e.addLayer(t.pid)}},D.a.createElement("a",null,t.icon||D.a.createElement("i",{className:"app-ico app-ico-domnode"}),D.a.createElement("span",null,t.name)))})):null))}}]),n}(x.Component),se()(Po.prototype,"addLayer",[be],Object.getOwnPropertyDescriptor(Po.prototype,"addLayer"),Po.prototype),se()(Po.prototype,"initLayerMenusData",[be],Object.getOwnPropertyDescriptor(Po.prototype,"initLayerMenusData"),Po.prototype),se()(Po.prototype,"showModal",[be],Object.getOwnPropertyDescriptor(Po.prototype,"showModal"),Po.prototype),se()(Po.prototype,"closeModal",[be],Object.getOwnPropertyDescriptor(Po.prototype,"closeModal"),Po.prototype),Do=Po))||Do)||Do;n(636),n(638),n(640);function No(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Lo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?No(Object(n),!0).forEach((function(t){C()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):No(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ao(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var _o,To=function(e){w()(n,e);var t=Ao(n);function n(){return m()(this,n),t.apply(this,arguments)}return g()(n,[{key:"render",value:function(){var e=this.props,t=e.data,n=e.transformStyle,r=e.plugins,a=e.renderIn,o=e.scale,i=e.setPageStyle,s=A()(t.fixeds,2),c=s[0],p=s[1];return D.a.createElement("div",{className:"app-fixeds"},[c,p].map((function(e,s){var c=null;0===s&&((e=Q.toJS(e)).style.height=p.style.height);var l=i(e),u=l.innerStyle,h=l.boxStyle,d=l.adsorbTopBottom,f=l.adsorbLeftRight;return 0===s?(c="h5dsFixedsUp",u.height=0):c="h5dsFixedsDown",D.a.createElement("div",{key:c,id:c},D.a.createElement("div",{className:"app-swiper-page"},D.a.createElement("div",{className:"app-pages-box",style:h},D.a.createElement("div",{style:Lo(Lo({},u),n),className:"app-swiper-pageinner"},D.a.createElement(We,{adsorbSet:{scale:o,adsorbTopBottom:d,adsorbLeftRight:f},plugins:r,appData:t,data:e,renderIn:a})))))})))}}]),n}(x.Component);function zo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ho(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zo(Object(n),!0).forEach((function(t){C()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var Wo=(_o=function(e){w()(n,e);var t=$o(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).data=e.data,r.pagesLen=r.data.pages.length,r.state={offset:0,slides:[],realIndex:0},r.id="h5ds_swiper_".concat(Q.randomID()),r}return g()(n,[{key:"slideTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.swiperInstance.slideTo(e,t)}},{key:"updateSwiper",value:function(){this.swiperInstance.updateSize(),this.swiperInstance.updateSlides(),this.slideTo(0)}},{key:"slideChangeTransitionEnd",value:function(){var e=this.swiperInstance.snapIndex;this.swiperInstance.h5dsRealIndex=e;var t=this.renderExternal,n=t.slides,r=t.offset;JSON.stringify({realIndex:this.state.realIndex,slides:this.state.slides,offset:this.state.offset})!==JSON.stringify({realIndex:e,slides:n,offset:r})&&this.setState({realIndex:e,slides:n,offset:r})}},{key:"slideNext",value:function(){this.swiperInstance&&this.swiperInstance.slideNext()}},{key:"slidePrev",value:function(){this.swiperInstance&&this.swiperInstance.slidePrev()}},{key:"newSwiper",value:function(){var e=this,t=this.data.slider,n=t.time,r=t.effect,a=t.autoplay,o=t.speed,i=void 0===o?.5:o,s=t.direction,c=void 0===s?"vertical":s;a&&(a={delay:1e3*n,disableOnInteraction:!1}),this.offset=$("#".concat(this.id)).height();var p=new Array(this.pagesLen).fill(1).map((function(e,t){return t}));this.swiperInstance=new Swiper("#".concat(this.id),{loop:!1,virtual:{slides:p,cache:!1,renderExternal:function(t){var n=t.slides,r=t.offset;e.renderExternal||e.setState({slides:n,offset:r}),e.renderExternal={slides:n,offset:r}}},speed:1e3*i,autoplay:a,roundLengths:!0,direction:c,effect:r,mousewheel:!1,noSwipingClass:"app-swiper-stop-swiping",watchOverflow:!0}),this.swiperInstance.h5dsRealIndex=0,this.swiperInstance.on("transitionEnd",this.slideChangeTransitionEnd),window.swiperInstance=this.swiperInstance}},{key:"componentDidUpdate",value:function(e,t){this.props.style.height!==e.style.height&&this.pageRef&&this.pageRef.swiperLangPage&&this.pageRef.swiperLangPage.update()}},{key:"componentDidMount",value:function(){this.newSwiper()}},{key:"componentWillUnmount",value:function(){this.swiperInstance.destroy(),window.swiperInstance=void 0}},{key:"render",value:function(){var e=this,t=this.props,n=t.data,r=t.plugins,a=t.style,o=t.renderIn,i=t.scale,s=t.setPageStyle,c=this.props.transformStyle,p=this.state,l=p.realIndex,u=p.slides,h=p.offset,d=n.pages,f=Object.assign({},Ho({},n.style),Ho({},a)),y=n.slider.direction,m=void 0===y?"vertical":y;return D.a.createElement("div",{id:this.id,className:"app-pages swiper-container",style:Ho({},f)},D.a.createElement("div",{className:"swiper-wrapper"},u.map((function(t,a){var p,u=d[t],f=s(u),y=f.innerStyle,v=f.boxStyle,g=f.className,b=f.isLangPage,w=f.adsorbTopBottom,k=f.adsorbLeftRight;g=[g];var E=["app-pages-box","swiper-container"],O="keyid_"+u.keyid+"_".concat(t);b&&E.push("app-swiper-page-scroll"),l-t==0?g.push("swiper-slide-active"):l-t>0?g.push("swiper-slide-prev app-swiper-ban-animate"):g.push("swiper-slide-next app-swiper-ban-animate"),u.slider.lock&&g.push("app-swiper-stop-swiping");var S={};return b&&"pc"===n.type&&(S.right=-(window.innerWidth-u.style.width)/2+2),D.a.createElement("div",{id:u.id,className:g.join(" "),key:O,"data-keyid":u.keyid,"data-swiper-slide-index":t,style:(p={},C()(p,"horizontal"===m?"left":"top","".concat(h,"px")),C()(p,"transform","rotateX(0deg) rotateY(0deg) translate3d(0px, 0px, 0px)"),p)},D.a.createElement("div",{className:E.join(" "),style:v},D.a.createElement("div",{id:O,style:Object.assign(y,c),className:["app-swiper-pageinner",b?"swiper-container":""].join(" ")},D.a.createElement(He,{adsorbSet:{scale:i,adsorbTopBottom:w,adsorbLeftRight:k},ref:function(n){l===t&&(e.pageRef=n)},index:t,keyid:O,scrollSet:l-t,realIndex:l,isLangPage:b,isRenderThis:l===t,plugins:r,appData:n,data:u,renderIn:o}),b?D.a.createElement("div",{style:S,className:["".concat(O,"_swiper-scrollbar"),"swiper-scrollbar",u.slider.showScroll?"":"swiper-scrollbar-hideScroll"].join(" ")}):null)))}))),D.a.createElement("div",{className:"swiper-pagination"}))}}]),n}(x.Component),se()(_o.prototype,"slideTo",[be],Object.getOwnPropertyDescriptor(_o.prototype,"slideTo"),_o.prototype),se()(_o.prototype,"updateSwiper",[be],Object.getOwnPropertyDescriptor(_o.prototype,"updateSwiper"),_o.prototype),se()(_o.prototype,"slideChangeTransitionEnd",[be],Object.getOwnPropertyDescriptor(_o.prototype,"slideChangeTransitionEnd"),_o.prototype),se()(_o.prototype,"slideNext",[be],Object.getOwnPropertyDescriptor(_o.prototype,"slideNext"),_o.prototype),se()(_o.prototype,"slidePrev",[be],Object.getOwnPropertyDescriptor(_o.prototype,"slidePrev"),_o.prototype),se()(_o.prototype,"newSwiper",[be],Object.getOwnPropertyDescriptor(_o.prototype,"newSwiper"),_o.prototype),_o);function Mo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Bo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mo(Object(n),!0).forEach((function(t){C()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Fo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var Vo,Go,Uo,Yo=function(e){w()(n,e);var t=Fo(n);function n(){return m()(this,n),t.apply(this,arguments)}return g()(n,[{key:"render",value:function(){var e=this.props,t=e.data,n=e.transformStyle,r=e.plugins,a=e.renderIn,o=e.scale,i=e.setPageStyle;return D.a.createElement("div",{className:"app-popups",id:"h5dsPopups"},t.popups.map((function(e,s){var c=i(e),p=c.innerStyle,l=c.boxStyle,u=c.adsorbTopBottom,h=c.adsorbLeftRight,d="app-swiper-page";return e.className&&(d+=" ".concat(e.className)),D.a.createElement("div",{id:e.id,className:d,key:e.keyid,"data-keyid":e.keyid,style:{transform:"rotateX(0deg) rotateY(0deg) translate3d(0px, 0px, 0px)",width:window.innerWidth,height:window.innerHeight}},D.a.createElement("div",{className:"app-pages-box",style:l},D.a.createElement("div",{style:Bo(Bo({},p),n),className:"app-swiper-pageinner"},D.a.createElement(Be,{plugins:r,data:e,appData:t,renderIn:a,adsorbSet:{scale:o,adsorbTopBottom:u,adsorbLeftRight:h}}))))})))}}]),n}(x.Component);function Jo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var qo,Xo,Ko=(Uo=Go=function(e){w()(n,e);var t=Jo(n);function n(e){var r;m()(this,n),(r=t.call(this,e)).data=JSON.parse(JSON.stringify(e.data));var a=r.props.style,o=a.width,i=a.height,s=1;switch(r.props.data.type){case"pc":s=1;break;case"ppt":s=window.innerHeight/720>window.innerWidth/1280?window.innerWidth/1280:window.innerHeight/720;break;case"horizontal-phone":s=o>i?i/320:o/320;break;default:s=o/320}return r.scale=r.props.scale||s,r}return g()(n,[{key:"setPageStyle",value:function(e){var t=this.props,n=t.style,r=t.data,a=e.style.height*this.scale,o=e.style.width*this.scale,i=n.height<a;a>n.height&&(a=n.height);var s=0,c=!1;n.height>=a?s=(n.height-a)/2:c=!0,e.slider&&e.slider.lock&&(c=!0);var p=e.style,l=p.backgroundColor,u=p.backgroundImage,h=p.backgroundSize,d=p.backgroundRepeat,f=p.backgroundGlobal,y=p.width,m={backgroundColor:l};f&&Object.assign(m,{backgroundImage:u,backgroundSize:h,backgroundRepeat:d});var v=Object.assign({},{width:y,height:a/this.scale},{top:s});"horizontal-phone"===r.type?(v.top=(n.height-e.style.height)/2,v.left=(n.width-e.style.width)/2):"ppt"===r.type&&(v.top=0,v.left=0);var g="app-swiper-page swiper-slide";return c&&(g+=" app-swiper-page-lange"),e.className&&(g+=" ".concat(e.className)),{className:g,boxStyle:m,innerStyle:v,noSwiper:c,isLangPage:i,adsorbTopBottom:s,adsorbLeftRight:(n.width-o)/2}}},{key:"updateSwiper",value:function(){this.swiperRef&&this.swiperRef.updateSwiper()}},{key:"slideNext",value:function(){this.swiperRef&&this.swiperRef.slideNext()}},{key:"slidePrev",value:function(){this.swiperRef&&this.swiperRef.slidePrev()}},{key:"slideTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.swiperRef&&this.swiperRef.slideTo(e,t)}},{key:"componentDidMount",value:function(){var e=this;this.swiperInstance=this.swiperRef.swiperInstance,window.pubSubLayer.subscribe("h5ds.layerEvent.topage",(function(t){e.slideTo(t.value,500)})),this.props.appId&&(window.VIEW_APP_APPID=this.props.appId)}},{key:"componentWillUnmount",value:function(){window.VIEW_APP_APPID=void 0,window.pubSubLayer.unsubscribe("h5ds.layerEvent.topage")}},{key:"render",value:function(){var e=this,t=this.data,n=this.props,r=n.renderIn,a=n.style,o=n.plugins,i={transform:"scale(".concat(this.scale,")"),transformOrigin:"0 0"},s=this.setPageStyle,c=1;"pc"===t.type&&a.width<t.style.width&&(c=a.width/t.style.width,a.width=t.style.width,a.height=a.height/c);var p={width:a.width,height:a.height,transform:"scale(".concat(c,")")},l=t.slider.direction,u=void 0===l?"vertical":l;"horizontal-phone"===t.type?i=a.width<a.height?{transform:"scale(".concat(this.scale,") rotate(").concat("vertical"===u?90:-90,"deg)"),transformOrigin:"center"}:{transform:"scale(".concat(this.scale,")"),transformOrigin:"center",left:0}:"ppt"===t.type&&(i=Object.assign(i,{transformOrigin:"0 0",top:"50%",left:"50%",margin:0,transform:"scale(".concat(this.scale,")  translate(-50%, -50%)")}),Object.assign(p,{transform:"scale(1)"}));var h=["app-preview","app-preview-".concat(t.type)];return D.a.createElement("div",{className:h.join(" "),style:p},"ppt"===t.type?D.a.createElement("div",{className:"app-ppt-btn"},D.a.createElement("a",{className:"app-ppt-prev",onClick:this.slidePrev}),D.a.createElement("a",{className:"app-ppt-next",onClick:this.slideNext})):null,D.a.createElement(D.a.Fragment,null,D.a.createElement(Wo,oe()({ref:function(t){return e.swiperRef=t}},{data:t,transformStyle:i,renderIn:r,plugins:o,style:a,scale:this.scale,setPageStyle:s})),D.a.createElement(To,{data:t,transformStyle:i,renderIn:r,plugins:o,style:a,scale:this.scale,setPageStyle:s}),D.a.createElement(Yo,{data:t,transformStyle:i,renderIn:r,plugins:o,style:a,scale:this.scale,setPageStyle:s})))}}]),n}(x.Component),Go.defaultProps={style:{width:window.innerWidth,height:window.innerHeight}},Vo=Uo,se()(Vo.prototype,"setPageStyle",[be],Object.getOwnPropertyDescriptor(Vo.prototype,"setPageStyle"),Vo.prototype),se()(Vo.prototype,"updateSwiper",[be],Object.getOwnPropertyDescriptor(Vo.prototype,"updateSwiper"),Vo.prototype),se()(Vo.prototype,"slideNext",[be],Object.getOwnPropertyDescriptor(Vo.prototype,"slideNext"),Vo.prototype),se()(Vo.prototype,"slidePrev",[be],Object.getOwnPropertyDescriptor(Vo.prototype,"slidePrev"),Vo.prototype),se()(Vo.prototype,"slideTo",[be],Object.getOwnPropertyDescriptor(Vo.prototype,"slideTo"),Vo.prototype),Vo);function Qo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var Zo,ei=Object(P.b)("h5ds","scope")(qo=Object(P.c)((Xo=function(e){w()(n,e);var t=Qo(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state={url:"",keys:+new Date,isTemporaryUrl:!1},e}return g()(n,[{key:"reRender",value:function(){this.setState({keys:+new Date})}},{key:"publishApp",value:function(){var e=this;this.props.publishApp().then((function(t){var n=e.props.scope.options,r=n.publishHost,a=void 0===r?"":r,o=n.publishParam;if(!n.noServer){var i="".concat(a,"?appId=").concat(t);if(o)for(var s in o)i+="&".concat(s,"=").concat(o[s]);e.setState({url:i,isTemporaryUrl:!1})}}))}},{key:"componentDidMount",value:function(){var e=this;window.addEventListener("resize",this.reRender),"ppt"===this.props.data.type&&setTimeout((function(){e.H5SwiperRef.updateSwiper()}),500);var t=this.props.scope.options,n=t.getPrivewToken,r=t.publishHost,a=t.publishParam,o=t.noServer;if(n){if(o)return;this.props.saveApp().then((function(){n(e.props.appId).then((function(t){var n="".concat(r,"?appId=").concat(e.props.appId,"&auth=").concat(t);if(a)for(var o in a)n+="&".concat(o,"=").concat(a[o]);e.setState({url:n,isTemporaryUrl:!0})}))}))}else console.warn("没有设置临时二维码接口：getPrivewToken")}},{key:"componentWillUnmount",value:function(){this.reRender&&window.removeEventListener("resize",this.reRender)}},{key:"render",value:function(){var e=this,t={width:window.innerWidth,height:window.innerHeight},n=this.props.scope,r=n.pluginsKey,a=n.scripts;return D.a.createElement("div",{className:"app-pc-preview"},D.a.createElement("div",{className:"app-pc-preview-bodyer"},D.a.createElement(Ko,{ref:function(t){return e.H5SwiperRef=t},style:t,plugins:{pluginsKey:r,scripts:a},data:this.props.data,renderIn:je.RENDER_IN_PREVIEW})),D.a.createElement("div",{className:"app-pc-preview-down"},D.a.createElement(ke.Button,{type:"primary",loading:!this.state.url,icon:"qrcode"},this.state.url?D.a.createElement("a",{href:this.state.url,rel:"noopener noreferrer",target:"_blank"},this.state.isTemporaryUrl?"临时URL":"正式URL"):"loading..."),this.props.scope.options.downApp?D.a.createElement(this.props.scope.options.downApp,{appId:this.props.scope.options.appId}):D.a.createElement(ke.Button,{onClick:this.props.downCode,type:"primary",icon:"download"},"下载源码"),D.a.createElement(ke.Button,{onClick:this.props.close,type:"primary",icon:"gateway"},"继续编辑"),this.props.scope.options.AsTemplate?D.a.createElement(this.props.scope.options.AsTemplate,{appId:this.props.scope.options.appId,data:JSON.stringify(this.props.h5ds.data)}):D.a.createElement(ke.Button,{onClick:this.publishApp,type:"primary",icon:"check-circle"},"确认发布")))}}]),n}(x.Component),se()(Xo.prototype,"reRender",[be],Object.getOwnPropertyDescriptor(Xo.prototype,"reRender"),Xo.prototype),se()(Xo.prototype,"publishApp",[be],Object.getOwnPropertyDescriptor(Xo.prototype,"publishApp"),Xo.prototype),qo=Xo))||qo)||qo;function ti(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var ni,ri,ai=(Zo=function(e){w()(n,e);var t=ti(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state={page:0},e}return g()(n,[{key:"prevPage",value:function(){this.props.H5SwiperRef.slidePrev()}},{key:"nextPage",value:function(){this.props.H5SwiperRef.slideNext()}},{key:"componentDidMount",value:function(){var e=this,t=this.props.H5SwiperRef;t&&t.swiperInstance.on("transitionEnd",(function(){e.setState({page:t.swiperInstance.h5dsRealIndex})}))}},{key:"render",value:function(){var e=this.props.pageLength,t=this.state.page;return D.a.createElement("div",{className:"app-phone-preview-pagebutton"},D.a.createElement("a",{onClick:this.prevPage,className:"app-phone-preview-prev"},"上一页"),D.a.createElement("span",null,t+1,"/",e),D.a.createElement("a",{onClick:this.nextPage,className:"app-phone-preview-next"},"下一页"))}}]),n}(x.Component),se()(Zo.prototype,"prevPage",[be],Object.getOwnPropertyDescriptor(Zo.prototype,"prevPage"),Zo.prototype),se()(Zo.prototype,"nextPage",[be],Object.getOwnPropertyDescriptor(Zo.prototype,"nextPage"),Zo.prototype),Zo),oi=n(642),ii=n.n(oi);function si(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var ci,pi,li=Object(P.b)("h5ds","scope")(ni=Object(P.c)((ri=function(e){w()(n,e);var t=si(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).state={keys:Q.randomID(),viewType:"iphone6",url:"",isTemporaryQrcode:!1,style:{width:320,height:514}},r.H5SwiperRef=null,r.isTemplate=Q.getUrlQuery("isTemplate"),r}return g()(n,[{key:"changeViewType",value:function(e){this.setState({viewType:e.target.value,style:{width:320,height:"iphoneX"===e.target.value?640:514}},this.H5SwiperRef.updateSwiper)}},{key:"changeMainImg",value:function(){var e=this;window.pubSubEditor.publish("h5ds.img.modal.show",{callback:function(t){e.props.data.img=t}})}},{key:"changeName",value:function(e){this.props.data.name=e.target.value}},{key:"changeDesc",value:function(e){this.props.data.desc=e.target.value}},{key:"publishApp",value:function(){var e=this;this.props.publishApp().then((function(t){var n=e.props.scope.options,r=n.publishHost,a=n.publishParam;if(!n.noServer){var o="".concat(r,"?").concat(e.isTemplate?"templateId":"appId","=").concat(t);if(a)for(var i in a)o+="&".concat(i,"=").concat(a[i]);e.setState({url:o,isTemporaryQrcode:!1})}}))}},{key:"componentDidMount",value:function(){var e=this,t=this.props.scope.options,n=t.getPrivewToken,r=t.publishHost,a=void 0===r?"":r,o=t.publishParam,i=t.noServer;n?this.props.saveApp().then((function(){n(e.props.appId).then((function(t){if(!i){var n="".concat(a,"?").concat(e.isTemplate?"templateId":"appId","=").concat(e.props.appId,"&auth=").concat(t);if(o)for(var r in o)n+="&".concat(r,"=").concat(o[r]);e.setState({url:n,isTemporaryQrcode:!0})}}))})):console.warn("没有设置临时二维码接口：getPrivewToken"),this.settime=setTimeout((function(){e.setState({keys:Q.randomID()})}),500)}},{key:"componentWillUnmount",value:function(){this.settime&&clearTimeout(this.settime)}},{key:"render",value:function(){var e=this,t=this.state,n=t.style,r=t.isTemporaryQrcode,a=(t.keys,ke.Input.TextArea),o=this.props.data,i=this.props.scope.pluginsKey;return D.a.createElement("div",{className:"app-phone-preview"},D.a.createElement("div",{className:"app-phone-preview-box"},D.a.createElement("div",{className:"app-phone-preview-content"},D.a.createElement("div",{className:"app-phone-preview-view"},D.a.createElement("div",{className:"app-phone-preview-header"},D.a.createElement(ke.Radio.Group,{onChange:this.changeViewType,defaultValue:"iphone6",buttonStyle:"solid"},D.a.createElement(ke.Radio.Button,{value:"iphone6"},"iphone6"),D.a.createElement(ke.Radio.Button,{value:"iphoneX"},"iphoneX"))),this.H5SwiperRef?D.a.createElement(ai,{H5SwiperRef:this.H5SwiperRef,pageLength:o.pages.length}):null,D.a.createElement("div",{id:"app-phone-preview-bodyer",style:{left:0},className:"app-phone-preview-bodyer"},D.a.createElement(Ko,{ref:function(t){return e.H5SwiperRef=t},style:n,plugins:{pluginsKey:i},data:o,appId:this.props.appId,renderIn:je.RENDER_IN_PREVIEW}))),D.a.createElement("div",{className:"app-phone-preview-info"},D.a.createElement("div",{className:"app-phone-preview-wx clearfix"},D.a.createElement("div",{className:"app-phone-preview-img",onClick:this.changeMainImg},D.a.createElement("img",{src:o.img,alt:""})),D.a.createElement("div",{className:"app-phone-preview-title"},D.a.createElement(ke.Input,{onChange:this.changeName,value:o.name})),D.a.createElement("div",{className:"app-phone-preview-desc"},D.a.createElement(a,{onChange:this.changeDesc,style:{height:118},value:o.desc,rows:4}))),D.a.createElement("div",{className:"app-phone-preview-wx clearfix"},D.a.createElement("div",{className:"app-phone-preview-img"},this.state.url&&D.a.createElement(ii.a,{fgColor:"rgba(0,0,0,1)",bgColor:"rgba(255,255,255,1)",size:160,level:"M",value:this.state.url})),D.a.createElement("div",{className:"app-phone-preview-desc"},D.a.createElement(a,{style:{height:160},rows:4,value:this.state.url}))),D.a.createElement("div",{className:"app-phone-preview-down"},D.a.createElement(ke.Alert,{message:r?"以上为临时二维码和链接，10分钟有效，发布后生成永久二维码和链接":"以上为正式二维码和链接，永久有效",type:r?"warning":"success"}),D.a.createElement("br",null),this.props.scope.options.downApp?D.a.createElement(this.props.scope.options.downApp,{appId:this.props.scope.options.appId}):D.a.createElement(ke.Button,{onClick:this.props.downCode,type:"primary",icon:"download"},"下载源码"),"  ",D.a.createElement(ke.Button,{onClick:this.props.close,type:"primary",icon:"gateway"},"继续编辑"),"  ",this.props.scope.options.AsTemplate?D.a.createElement(this.props.scope.options.AsTemplate,{appId:this.props.scope.options.appId,data:JSON.stringify(this.props.h5ds.data)}):D.a.createElement(ke.Button,{onClick:this.publishApp,type:"primary",icon:"check-circle"},"确认发布"))))))}}]),n}(x.Component),se()(ri.prototype,"changeViewType",[be],Object.getOwnPropertyDescriptor(ri.prototype,"changeViewType"),ri.prototype),se()(ri.prototype,"changeMainImg",[be],Object.getOwnPropertyDescriptor(ri.prototype,"changeMainImg"),ri.prototype),se()(ri.prototype,"changeName",[be],Object.getOwnPropertyDescriptor(ri.prototype,"changeName"),ri.prototype),se()(ri.prototype,"changeDesc",[be],Object.getOwnPropertyDescriptor(ri.prototype,"changeDesc"),ri.prototype),se()(ri.prototype,"publishApp",[be],Object.getOwnPropertyDescriptor(ri.prototype,"publishApp"),ri.prototype),ni=ri))||ni)||ni;function ui(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var hi,di;Object(P.b)("h5ds","scope")(ci=Object(P.c)((pi=function(e){w()(n,e);var t=ui(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state={loading:!1,show:!1},e}return g()(n,[{key:"modalShow",value:function(){this.setState({show:!0})}},{key:"onClose",value:function(){this.setState({show:!1})}},{key:"saveApp",value:function(){var e=this;this.setState({loading:!0});var t=this.props.scope.options,n=t.saveApp,r=t.appId,a=this.props.h5ds.data;return a.plugins=ge.getPidByData(a),new Promise((function(t,o){try{n({plugins:z()(a.plugins),updateTime:+new Date,appId:r,data:Object(Ee.toJS)(a)}).then((function(){e.setState({loading:!1}),t()}))}catch(e){console.error(e),ke.message.error("请传入props.saveApp 方法，且必须是一个Promise对象"),o()}}))}},{key:"downCode",value:function(){var e=this.props.h5ds.data;e.plugins=ge.getPidByData(e),Q.saveShareContent('<!DOCTYPE html>\n<html>\n  <head lang="zh-cn">\n    <meta charset="utf-8" />\n    <meta http-equiv="X-UA-Compatible" content="IE=edge" />\n    <meta name="description" content="" />\n    <meta name="keywords" content="" />\n    <meta\n      name="viewport"\n      content="width=device-width,initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"\n    />\n    <title>H5DS5.0</title>\n    <meta name="renderer" content="webkit" />\n    \x3c!-- No Baidu Siteapp--\x3e\n    <meta http-equiv="Cache-Control" content="no-siteapp" />\n    <meta name="apple-mobile-web-app-title" content="yes" />\n    <meta name="apple-mobile-web-app-capable" content="yes" />\n    <meta name="apple-mobile-web-app-status-bar-style" content="black" />\n    <meta http-equiv="Cache-Control" content="no-siteapp" />\n    <meta name="x5-fullscreen" content="true" />\n    <meta name="x5-orientation" content="portrait" />\n    <meta name="x5-page-mode" content="app" />\n    \x3c!--uc浏览器--\x3e\n    <meta name="screen-orientation" content="portrait" />\n    <meta name="format-detection" content="telephone=no" />\n    <meta name="format-detection" content="email=no" />\n    <link rel="shortcut icon" href="/assets/images/favicon.ico" />\n    <link href="http://cdn.h5ds.com/lib/plugins/swiper.min.css" rel="stylesheet"/>\n    <link href="http://cdn.h5ds.com/umd/swiper/h5ds.preview.5.0.11.css" rel="stylesheet"/>\n    <script src="http://cdn.h5ds.com/lib/plugins/swiper.min.js"><\/script>\n    <script src="http://cdn.h5ds.com/lib/plugins/jquery.min.js"><\/script>\n    <script src="http://cdn.h5ds.com/lib/plugins/h5ds.vendor.preview.min.js"><\/script>\n    <script src="http://cdn.h5ds.com/umd/swiper/h5ds.preview.5.0.11.js"><\/script>\n    <script>\n      window.Component = React.Component;\n    <\/script>\n    <style>\n      body {\n        position: fixed;\n        width: 100%;\n        height: 100%;\n        top: 0;\n        left: 0;\n        overflow: hidden;\n      }\n    </style>\n  </head>\n\n  <body>\n    <div id="app-APP"></div>\n  </body>\n  <script>\n    var h5dsData = {{__html}};\n    $(function() {\n      h5dsPreview({\n        id: "app-APP",\n        data: h5dsData,\n        pluginsHost: \'http://cdn.h5ds.com\'\n      });\n    });\n  <\/script>\n</html>\n'.replace("{{__html}}","".concat(JSON.stringify(e),";")),"preivew.html")}},{key:"publishApp",value:function(){var e=this.props.h5ds.data;e.plugins=ge.getPidByData(e);var t=this.props.scope.options,n=t.publishApp,r=t.appId,a=t.noServer;try{return n({plugins:z()(e.plugins),updateTime:+new Date,appId:r,data:Object(Ee.toJS)(e)}).then((function(){return a?(ke.Modal.error({title:"错误提示",content:"该版本没有服务端代码，因此不可以生成二维码和链接！您可以下载源码！"}),!1):r}))}catch(e){console.error(e),ke.message.error("请配置发布props.publishApp，且必须是一个Promise对象")}}},{key:"render",value:function(){var e=this.state,t=e.loading,n=e.show,r=this.props.h5ds.data;return D.a.createElement("div",{className:"app-publish"},D.a.createElement("a",{className:"app-btn-min",onClick:this.saveApp},t?D.a.createElement("span",null,D.a.createElement(ke.Icon,{type:"loading"})," 保存中"):D.a.createElement("span",null,D.a.createElement("i",{className:"app-ico app-ico-baocun"})," 保存")),"  ",D.a.createElement("a",{onClick:this.modalShow,className:"app-btn-min app-js-publish"},D.a.createElement("i",{className:"app-ico app-ico-fabu"})," 预览/发布"),D.a.createElement(wt,{className:"app-modal-source",forceRender:!0,show:n,close:this.onClose},["pc","ppt"].includes(r.type)?D.a.createElement(ei,{downCode:this.downCode,appId:this.props.scope.options.appId,publishApp:this.publishApp,close:this.onClose,scope:this.props.scope,saveApp:this.saveApp,data:r}):D.a.createElement(li,{downCode:this.downCode,appId:this.props.scope.options.appId,publishApp:this.publishApp,close:this.onClose,scope:this.props.scope,saveApp:this.saveApp,data:r})))}}]),n}(x.Component),se()(pi.prototype,"modalShow",[be],Object.getOwnPropertyDescriptor(pi.prototype,"modalShow"),pi.prototype),se()(pi.prototype,"onClose",[be],Object.getOwnPropertyDescriptor(pi.prototype,"onClose"),pi.prototype),se()(pi.prototype,"saveApp",[be],Object.getOwnPropertyDescriptor(pi.prototype,"saveApp"),pi.prototype),se()(pi.prototype,"downCode",[be],Object.getOwnPropertyDescriptor(pi.prototype,"downCode"),pi.prototype),se()(pi.prototype,"publishApp",[be],Object.getOwnPropertyDescriptor(pi.prototype,"publishApp"),pi.prototype),ci=pi))||ci);function fi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var yi,mi,vi=Object(P.b)("h5ds","scope")(hi=Object(P.c)((di=function(e){w()(n,e);var t=fi(n);function n(){return m()(this,n),t.apply(this,arguments)}return g()(n,[{key:"clears",value:function(){Q.clearStorage("H5DS_APP_DATA"),Q.clearStorage("H5DS_APP_EDATA"),Q.clearStorage("H5DS_APP_ID"),window.location.reload()}},{key:"setApp",value:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),window.pubSubEditor.publish("h5ds.destoryControl"),this.props.h5ds.setType("app")}},{key:"help",value:function(){$.helps({show:!0,data:[{dom:".app-js-h5set",content:"【整体设置】点击此处设置H5页面的整体内容：背景，主图，介绍, 背景音乐，加载效果等",pos:"bottom"},{dom:".app-js-clearlocal",content:"【清除缓存】这里清除本地缓存",pos:"bottom"},{dom:".app-js-publish",content:"【预览/发布】做好之后，发布应用点击这里发布应用或者预览应用，全部OK后生成二维码",pos:"bottom"},{dom:".app-js-pagelist",content:"【页面列表】此处主要展示页面的列表，也可以在【模板中心】中选择模板进行页面添加",pos:"right"},{dom:".app-js-temps",content:"【模板中心】所有页面模板都在这里了，你可以选择系统提供的模板，也可以选择自己保存的模板",pos:"right"},{dom:".app-js-layermenu",content:"【图层】页面里面所有的元素叫做图层，你可以在这里选择需要创建的图层，也可以点击“。。。”展开图层，选择更多图层",pos:"bottom"},{dom:".app-js-setting",content:"【设置区域】只需要记住，页面，图层，动画，交互等任何设置相关的操作都在这里进行就可以了。顶部会显示：当前选中的对象",pos:"left"},{dom:".app-js-canvas",content:"【可视化区域】页面的可视化界面，所见即所得",pos:"left"},{dom:".app-js-layerlist",content:"【图层列表】可以展开图层列表，这里有图层相关的一些操作！",pos:"bottom"},{dom:".app-js-shortcut",content:"【快捷操作】这里有一些快捷操作的方法 <br/>【ctrl+s 保存预览APP】<br/>【ctrl+z 撤销】<br/>【ctrl+y 恢复】<br/>【ctrl+ - 缩小画布】<br/>【ctrl+ + 放大画布】<br/>【ctrl+ p 播放动画】<br/>【ctrl+g 合并图层】<br/>【ctrl+u 取消合并】<br/>【ctrl+ h 显示网格】<br/>【ctrl + d 删除】<br/>【上，下，左，右 微调距离】<br/>【shift + 上，下，左，右 大幅度调距离】",pos:"left"}]})}},{key:"changeAppType",value:function(e){var t=this;Object(Ee.transaction)((function(){t.props.h5ds.data.type=e,t.props.scope.resetCanvasSize(),window.pubSubEditor.publish("h5ds.setHistory")}))}},{key:"componentDidMount",value:function(){var e=this.props.h5ds.getPage();e&&(this.props.h5ds.edata.pageSize={width:e.style.width,height:e.style.height})}},{key:"onChangeTheme",value:function(e){document.querySelector("body").classList.toggle("app-theme-simple")}},{key:"render",value:function(){this.props.h5ds.data,this.props.scope.options.headerNav;return D.a.createElement("div",{className:"app-header"},D.a.createElement("div",{className:"app-layermenu"},D.a.createElement(Io,null)))}}]),n}(x.Component),se()(di.prototype,"clears",[be],Object.getOwnPropertyDescriptor(di.prototype,"clears"),di.prototype),se()(di.prototype,"setApp",[be],Object.getOwnPropertyDescriptor(di.prototype,"setApp"),di.prototype),se()(di.prototype,"help",[be],Object.getOwnPropertyDescriptor(di.prototype,"help"),di.prototype),se()(di.prototype,"changeAppType",[be],Object.getOwnPropertyDescriptor(di.prototype,"changeAppType"),di.prototype),se()(di.prototype,"onChangeTheme",[be],Object.getOwnPropertyDescriptor(di.prototype,"onChangeTheme"),di.prototype),hi=di))||hi)||hi;n(648);function gi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var bi=Object(P.b)("h5ds","scope")(yi=Object(P.c)((mi=function(e){w()(n,e);var t=gi(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).state={showPanel:!1},r}return g()(n,[{key:"changePanel",value:function(){this.setState({showPanel:!this.state.showPanel})}},{key:"componentDidMount",value:function(){var e=this;window.pubSubEditor.subscribe("h5ds.showPageTpls",(function(){e.setState({showPanel:!0})}))}},{key:"componentWillUnmount",value:function(){window.pubSubEditor.unsubscribe("h5ds.showPageTpls")}},{key:"render",value:function(){var e=this.props.scope.options.template,t=this.state.showPanel,n=["app-template"];return t&&n.push("app-temps-showpanel"),e?D.a.createElement("div",{className:n.join(" ")},D.a.createElement("a",{onClick:this.changePanel,className:"app-temps-flodbtn app-js-temps"},D.a.createElement("i",{className:t?"app-ico app-ico-a3left":"app-ico app-ico-a3right"})),D.a.createElement(e,{layerfun:this.props.layerfun,h5ds:this.props.h5ds,showPanel:t})):null}}]),n}(x.Component),se()(mi.prototype,"changePanel",[be],Object.getOwnPropertyDescriptor(mi.prototype,"changePanel"),mi.prototype),yi=mi))||yi)||yi;function wi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var ki=function(e){w()(n,e);var t=wi(n);function n(e){return m()(this,n),t.call(this,e)}return g()(n,[{key:"componentDidMount",value:function(){$("body").addClass("app-edit"),this.shortcuts||(this.shortcuts=!0,$(document).on("keydown.shortcuts",(function(e){var t=(e=window.event||e).keyCode;if(0===$(":focus").length)if(e.ctrlKey&&-1!==[83,90,89,189,187,80,75,71,72,67,85,86].indexOf(t))switch(e.preventDefault(),e.stopPropagation(),t){case 83:N.publish("h5ds.shortcuts_save");break;case 90:N.publish("h5ds.shortcuts_undo");break;case 89:N.publish("h5ds.shortcuts_redo");break;case 189:N.publish("h5ds.shortcuts_tomin");break;case 187:N.publish("h5ds.shortcuts_tomax");break;case 80:N.publish("h5ds.shortcuts_play");break;case 71:N.publish("h5ds.shortcuts_combin");break;case 72:N.publish("h5ds.shortcuts_grid");break;case 85:N.publish("h5ds.shortcuts_uncombin");break;case 86:N.publish("h5ds.shortcuts_pastelayer");break;case 67:N.publish("h5ds.shortcuts_copylayer")}else{if(46===t)return e.preventDefault(),void N.publish("h5ds.shortcuts_dellayer");if(-1===[38,40,37,39].indexOf(t));else{e.preventDefault(),e.stopPropagation();var n=1;switch(e.shiftKey&&(n=20),t){case 38:N.publish("h5ds.shortcuts_y",-n);break;case 37:N.publish("h5ds.shortcuts_x",-n);break;case 39:N.publish("h5ds.shortcuts_x",n);break;case 40:N.publish("h5ds.shortcuts_y",n)}}}})))}},{key:"componentWillUnmount",value:function(){$("body").removeClass("app-edit")}},{key:"render",value:function(){var e=this;this.props.scope.pluginsKey;var t=[];for(var n in this.props.scope.pluginsKey){var r=this.props.scope.pluginsKey[n].Modal;r&&t.push(r)}return[D.a.createElement(vi,{key:"1"}),D.a.createElement(Rr,{key:"2"}),D.a.createElement(ir,{key:"3"}),D.a.createElement(bi,{key:"8"}),D.a.createElement(So,{key:"12"})].concat(z()(t.map((function(t,n){return D.a.createElement(t,oe()({},e.props,{key:"modal_".concat(n)}))}))))}}]),n}(x.Component);n(650),n(652);function Ei(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var Oi=function(e){w()(n,e);var t=Ei(n);function n(){return m()(this,n),t.apply(this,arguments)}return g()(n,[{key:"render",value:function(){var e=this.props,t=e.tips,n=e.body,r=void 0===n?null:n;return D.a.createElement("div",{className:"app-loading-window"},r||D.a.createElement("div",{className:"app-loading-center"},D.a.createElement("div",{className:"app-loadbox"},t||"loading...")))}}]),n}(x.Component);function Si(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var xi,Di,Pi=function(e){w()(n,e);var t=Si(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).state={percent:0,sourceName:"h5ds.core.js"},r}return g()(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.appData;t?(window.pubSubEditor.subscribe("h5ds.load.plugins",(function(t){var n=t.count,r=t.index,a=t.progress,o=t.name,i=parseInt(100*a*.7,10);0===n||0!==n&&n===r+1?e.setState({percent:100,name:"plugins资源加载完成"}):e.setState({percent:i,sourceName:o})})),window.pubSubEditor.subscribe("h5ds.load.scripts",(function(t){var n=t.count,r=t.index,a=t.progress,o=t.name,i=parseInt(100*a*.3+70,10);0===n||0!==n&&n===r+1?e.setState({percent:100,name:"scripts资源加载完成"}):e.setState({percent:i,sourceName:o})}))):console.error("数据异常")}},{key:"componentWillUnmount",value:function(){this.hasUnmount=!0,window.pubSubEditor.unsubscribe("h5ds.load.scripts")}},{key:"render",value:function(){var e=this.state,t=e.percent,n=e.sourceName;return D.a.createElement(Oi,{body:D.a.createElement("div",{className:"app-loading-box"},D.a.createElement(ke.Progress,{strokeWidth:1,format:function(e){return D.a.createElement("div",{className:"app-loading-percent"},"资源载入",e,"% ",D.a.createElement("br",null),D.a.createElement("span",{className:"app-loading-info"},n))},width:200,type:"circle",percent:t}))})}}]),n}(x.Component);function ji(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ci(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ji(Object(n),!0).forEach((function(t){C()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ji(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ri(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var Ii,Ni,Li,Ai,_i,Ti,zi,Hi,$i,Wi,Mi,Bi,Fi,Vi,Gi,Ui,Yi,Ji,qi,Xi,Ki,Qi,Zi,es,ts,ns,rs,as,os,is,ss,cs,ps,ls,us,hs,ds,fs,ys,ms,vs,gs,bs,ws,ks,Es,Os,Ss,xs=Object(P.b)("h5ds","scope")(xi=Object(P.c)((Di=function(e){w()(a,e);var t,n,r=Ri(a);function a(e){var t;return m()(this,a),(t=r.call(this,e)).state={dataLoad:!1,loadEnd:!1,data:null},t.scripts=[],t}return g()(a,[{key:"mountExtendsPlugins",value:(n=f()(h.a.mark((function e(){var t,n,r,a=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.length>0&&void 0!==a[0]?a[0]:[],Yn(p),!this.props.debugger){e.next=7;break}t.forEach((function(e){Object(Un.mountPlugin)(e)})),window.pubSubEditor&&window.pubSubEditor.publish("h5ds.load.plugins",{count:t.length,index:t.length,progress:1,name:"all plugins load end",type:"plugin"}),e.next=10;break;case 7:return n=this.props.options.pluginsHost,r=void 0===n?"":n,e.next=10,qn(t,r,"editor");case 10:this.mountPluginsEnd();case 11:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"mountPluginsEnd",value:(t=f()(h.a.mark((function e(){var t,n,r,a,o,i=this;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Kn();case 2:t=window.H5DS_GLOBAL||{},n=t.scripts,r=void 0===n?[]:n,a=t.plugins,o=void 0===a?{}:a,setTimeout((function(){Object(Ee.transaction)((function(){i.props.scope.plugins=Object.values(o),i.props.scope.scripts=z()(r),i.props.scope.pluginsKey=o,i.props.scope.resetCanvasSize=i.resetCanvasSize.bind(i),i.props.scope.options=Ci({},i.props.options),i.setState({loadEnd:!0})}))}));case 4:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})},{key:"resetCanvasSize",value:function(){var e=this.props.h5ds,t=e.data,n=e.edata;xe(t.type),Object(Ee.transaction)((function(){var e=Se.appWidth,r=Se.appHeight,a=t.style,o=a.width,i=a.height;switch(t.type){case"pc":o=o<e?e:o,i=r;break;case"phone":o=o>e?e:o,i=r;break;case"horizontal-phone":case"ppt":i=r,o=e}t.style.width=o,t.style.height=i,[].concat(z()(t.pages),z()(t.popups),z()(t.fixeds)).map((function(e){e.style.height=i,e.style.width=o})),t.fixeds[0].style.height=0,n.pageSize.width=o,n.pageSize.height=i}))}},{key:"initAppData",value:function(){var e=this;if(!this.initAppDataMark){this.initAppDataMark=!0;var t=this.props.h5ds,n=this.state.data;"defaultData"===n&&(n=Pe()),t.initApp(n,this.props.options.appId).then((function(){e.mountExtendsPlugins(e.props.plugins)}))}}},{key:"componentWillUnmount",value:function(){$(document).off("h5ds"),window.pubSubEditor.unsubscribeAll()}},{key:"render",value:function(){var e=this.state,t=e.dataLoad,n=e.loadEnd,r=e.data,a=null;return t&&n?(this.initAppDataMark=!1,a=D.a.createElement("div",{className:"app-layout-frame"},D.a.createElement(ki,oe()({},this.props,{appData:r})))):t&&!n&&(this.initAppData(),a=D.a.createElement("div",{className:"app-layout-frame"},D.a.createElement(Pi,{appData:r}))),a}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.data?Object.assign(t,{data:e.data,dataLoad:!0}):t}}]),a}(x.Component),se()(Di.prototype,"mountExtendsPlugins",[be],Object.getOwnPropertyDescriptor(Di.prototype,"mountExtendsPlugins"),Di.prototype),se()(Di.prototype,"mountPluginsEnd",[be],Object.getOwnPropertyDescriptor(Di.prototype,"mountPluginsEnd"),Di.prototype),se()(Di.prototype,"resetCanvasSize",[be],Object.getOwnPropertyDescriptor(Di.prototype,"resetCanvasSize"),Di.prototype),se()(Di.prototype,"initAppData",[be],Object.getOwnPropertyDescriptor(Di.prototype,"initAppData"),Di.prototype),xi=Di))||xi)||xi,Ds=n(654),Ps=n.n(Ds),js=n(14),Cs=n.n(js);n(44);function Rs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Is(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rs(Object(n),!0).forEach((function(t){C()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rs(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ns=Se.appHeight,Ls=Se.appWidth,As={h5ds:new(Ii=function(){function e(){var t=this;m()(this,e),Cs()(this,"data",Ni,this),Cs()(this,"edata",Li,this),this.historyIndex=0,this.history=[],Cs()(this,"renderPageList",Ai,this),this.getData=function(e,t){var n=Q.getStorage("H5DS_APP_ID");return t||(t="h5ds_demo_appid"),t&&n===t?(e=Q.getStorage("H5DS_APP_DATA"))&&"object"===ue()(e)||(console.error("数据异常，使用默认数据初始化页面！"),e=Pe()):Q.setStorage("H5DS_APP_ID",t),Promise.resolve(e)},Cs()(this,"initApp",_i,this),Cs()(this,"setControlLockWideHigh",Ti,this),Cs()(this,"updateCanvas",zi,this),Cs()(this,"updateCanvasAsync",Hi,this),Cs()(this,"formatPageData",$i,this),Cs()(this,"formatLayerData",Wi,this),Cs()(this,"toJS",Mi,this),Cs()(this,"addSet",Bi,this),Cs()(this,"banAnimate",Fi,this),Cs()(this,"playAnimate",Vi,this),Cs()(this,"setLayerId",Gi,this),Cs()(this,"originLayerSet",Ui,this),Cs()(this,"setCanvasSize",Yi,this),this.getCanvasSize=function(){var e=t.edata,n=(e.headerHeight,e.timeLineHeight,$(window).height()),r=$(window).width()-350-140;return r<0&&(r=0),n<0&&(n=0),{canvasWidth:r,canvasHeight:n}},Cs()(this,"setType",Ji,this),Cs()(this,"setLayerStyle",qi,this),Cs()(this,"getPageNum",Xi,this),Cs()(this,"getPage",Ki,this),Cs()(this,"getPages",Qi,this),Cs()(this,"getLayers",Zi,this),Cs()(this,"getLayer",es,this),Cs()(this,"addLayer",ts,this),Cs()(this,"addLayerGetCenterPosition",ns,this),Cs()(this,"addLayers",rs,this),Cs()(this,"getPageDom",as,this),Cs()(this,"getPageLayerDom",os,this),Cs()(this,"getLayerDom",is,this),Cs()(this,"getGroups",ss,this),Cs()(this,"delLayer",cs,this),this.getLayerData=function(e){var n=t.edata.selectLayer,r=t.getLayers();e=Q.isEmpty(e)?n:e;var a=Object(Ee.toJS)(r[e]);return t.originLayerSet(a,!0)},Cs()(this,"delGroupLayer",ps,this),Cs()(this,"setPage",ls,this),Cs()(this,"clickLayer",us,this),Cs()(this,"setLayer",hs,this),Cs()(this,"exChangePage",ds,this),Cs()(this,"exChangeLayer",fs,this),Cs()(this,"delPage",ys,this),Cs()(this,"getNullPage",ms,this),Cs()(this,"addPage",vs,this),Cs()(this,"copyPage",gs,this),Cs()(this,"copyLayer",bs,this),Cs()(this,"copyAnimate",ws,this),Cs()(this,"pasteAnimate",ks,this),Cs()(this,"doHistory",Es,this),Cs()(this,"setHistoryAsync",Os,this),Cs()(this,"setHistory",Ss,this),this.saveToStore=Q.debounce((function(){var e=t.history[t.history.length-1],n=e.data,r=e.edata;Q.setStorage("H5DS_APP_DATA",n),Q.setStorage("H5DS_APP_EDATA",r)}),3e3)}return g()(e,[{key:"getJsonByPid",value:function(e,t){for(var n=e[t],r=n.LayerJSON,a=n.config,o=arguments.length,i=new Array(o>2?o-2:0),s=2;s<o;s++)i[s-2]=arguments[s];var c=Is(Is({},Ps()(r,i)),a);return this.originLayerSet(c)}}]),e}(),Ni=se()(Ii.prototype,"data",[Ee.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Li=se()(Ii.prototype,"edata",[Ee.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ai=se()(Ii.prototype,"renderPageList",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return Q.debounce((function(){e.edata.pageListKeys=Q.randomID()}),500)}}),_i=se()(Ii.prototype,"initApp",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,n){return N.subscribe("h5ds.setHistory",Q.debounce(e.setHistory,300)),e.getData(t,n).then((function(t){xe(t.type),Object(Ee.transaction)((function(){e.edata={appid:n,animateListShow:!1,eventListShow:!1,banAnimate:!1,canvasAnimate:Q.randomID(),gridAdsorb:!1,gridSize:5,headerHeight:60,timeLineHeight:14,pageSize:{width:Ls,height:Ns},phoneScale:Se.canvasScale||1,setType:"page",selectType:"pages",selectFixed:0,selectPage:0,selectPopup:0,selectLayer:null,selectGroup:!1,keys:Q.randomID(),selectlayerKeys:Q.randomID(),layerListKeys:Q.randomID(),pageListKeys:Q.randomID()};var r=e.getCanvasSize(),a=r.canvasHeight,o=r.canvasWidth;e.edata.canvasHeight=a,e.edata.canvasWidth=o,e.data=e.addSet(t),e.setHistory()}))}))}}}),Ti=se()(Ii.prototype,"setControlLockWideHigh",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var n=e.getLayerDom().find(".app-control");n[0]&&(n.find(".app-control-top").css("display",t?"none":"block"),n.find(".app-control-left").css("display",t?"none":"block"),n.find(".app-control-bottom").css("display",t?"none":"block"),n.find(".app-control-right").css("display",t?"none":"block"))}}}),zi=se()(Ii.prototype,"updateCanvas",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.edata.keys=Q.randomID()}}}),Hi=se()(Ii.prototype,"updateCanvasAsync",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return Q.debounce((function(){e.updateCanvas()}))}}),$i=se()(Ii.prototype,"formatPageData",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(e){return e.keyid=Q.randomID(),e.style.width||(e.style.width=Se.appWidth),e.style.height||(e.style.height=Se.appHeight),Vn(e.layers),e.layers.forEach((function(e){e.keyid=Q.randomID()})),e}}}),Wi=se()(Ii.prototype,"formatLayerData",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(e){return e.keyid=Q.randomID(),(e=Vn([e]))[0]}}}),Mi=se()(Ii.prototype,"toJS",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(e){var t=null;try{t=JSON.parse(JSON.stringify(e))}catch(e){return void console.error("数据转化错误")}return t}}}),Bi=se()(Ii.prototype,"addSet",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var n=t.pages,r=t.fixeds,a=t.popups;return[].concat(z()(n),z()(a),z()(r)).forEach((function(t){t.keyid||(t.keyid=Q.randomID()),t.layers.forEach((function(t){e.originLayerSet(t)}))})),t}}}),Fi=se()(Ii.prototype,"banAnimate",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){N.publish("h5ds.destoryControl"),e.edata.banAnimate=!0,$("#h5dsCanvas").find("audio").each((function(){this.pause()}))}}}),Vi=se()(Ii.prototype,"playAnimate",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){N.publish("h5ds.destoryControl"),Object(Ee.transaction)((function(){e.edata.banAnimate=!1,e.edata.canvasAnimate=Q.randomID()}))}}}),Gi=se()(Ii.prototype,"setLayerId",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(e){return e.id&&(e.id="ID_"+Q.randomID()),e.keyid=Q.randomID(),e}}}),Ui=se()(Ii.prototype,"originLayerSet",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t.keyid||(t.keyid=Q.randomID()),void 0===t.className&&(t.className=""),void 0===t.set&&(t.set={}),t.set.hide=!1,void 0===t.set.lock&&(t.set.lock=!1),n&&e.setLayerId(t),t}}}),Yi=se()(Ii.prototype,"setCanvasSize",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=e.getCanvasSize(),n=t.canvasHeight,r=t.canvasWidth;Is({},e.edata.pageSize),Object(Ee.transaction)((function(){e.edata.canvasWidth=r,e.edata.canvasHeight=n}))}}}),Ji=se()(Ii.prototype,"setType",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.edata.setType=t}}}),qi=se()(Ii.prototype,"setLayerStyle",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.getLayer().style=t}}}),Xi=se()(Ii.prototype,"getPageNum",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=e.edata,n=t.selectPage,r=t.selectPopup,a=t.selectFixed,o=null;switch(t.selectType){case"pages":o=n;break;case"fixeds":o=a;break;case"popups":o=r}return o}}}),Ki=se()(Ii.prototype,"getPage",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,n){var r=e.edata,a=r.selectPage,o=r.selectPopup,i=r.selectFixed,s=r.selectType,c=t||s,p=null;switch(c){case"pages":p=Q.isEmpty(n)?a:n;break;case"fixeds":p=Q.isEmpty(n)?i:n;break;case"popups":p=Q.isEmpty(n)?o:n}return e.data[c][p]||null}}}),Qi=se()(Ii.prototype,"getPages",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){return t||(t=e.edata.selectType),e.data[t]||[]}}}),Zi=se()(Ii.prototype,"getLayers",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=e.getPage(),n=null;return t?n=t.layers:console.warn("page 不存在!"),n}}}),es=se()(Ii.prototype,"getLayer",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=e.getLayers(),n=e.edata.selectLayer,r=null;if(null!==n)return t&&(r=t[n]),r;console.warn("还未选择任何图层")}}}),ts=se()(Ii.prototype,"addLayer",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,n){var r=e.getPage();r?Object(Ee.transaction)((function(){e.originLayerSet(t),Q.isEmpty(n)?r.layers.unshift(t):r.layers.splice(n,0,t),e.edata.layerListKeys=Q.randomID()})):ke.message.error("未选择任何页面！")}}}),ns=se()(Ii.prototype,"addLayerGetCenterPosition",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var n=e.getPage();if(n){if(t){var r=n.style,a=r.width,o=void 0===a?0:a,i=(r.height,t.width||0),s=(t.height,$(".app-canvas-realsize").position()),c=s.top,p=s.left;return(c=-c/e.edata.phoneScale)<0&&(c=0),(p=-p/e.edata.phoneScale)<0&&(p=0),{top:c,left:p+=(o/2-i)/e.edata.phoneScale}}ke.message.error("layerData异常")}else ke.message.error("未选择任何页面！")}}}),rs=se()(Ii.prototype,"addLayers",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,n,r){var a=e.getPage();Object(Ee.transaction)((function(){t.forEach((function(t){e.originLayerSet(t),t.style.left+=r.left,t.style.top+=r.top,a.layers.splice(n,0,t)})),e.delLayer(n+t.length),e.edata.layerListKeys=Q.randomID()}))}}}),as=se()(Ii.prototype,"getPageDom",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var n=e.edata,r=n.selectType,a=n.selectFixed,o=null;switch(t&&(r=t),r){case"popups":o=$("#h5dsPageViewPopup");break;case"fixeds":switch(a){case 0:o=$("#h5dsPageViewFixedUp");break;case 1:o=$("#h5dsPageViewFixedDown")}break;case"pages":o=$("#h5dsPageView")}return o}}}),os=se()(Ii.prototype,"getPageLayerDom",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var n=e.getPageDom().children(".app-swiper-layers-box").children(".app-swiper-layers").children(".layer");return Q.isEmpty(t)?n:n.eq(t)}}}),is=se()(Ii.prototype,"getLayerDom",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var n=e.edata.selectLayer;return Q.isEmpty(t)||(n=t),Q.isEmpty(n)?null:e.getPageLayerDom().eq(n)}}}),ss=se()(Ii.prototype,"getGroups",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=[],n=e.getLayers();return e.edata.selectGroup&&e.edata.selectGroup.forEach((function(e){t.push({key:e,layer:n[e]})})),t.sort((function(e,t){return e.key-t.key}))}}}),cs=se()(Ii.prototype,"delLayer",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var n=e.edata.selectLayer,r=e.getLayers();Object(Ee.transaction)((function(){r.splice(Q.isEmpty(t)?n:t,1),e.edata.selectLayer=null,e.edata.keys=Q.randomID(),e.setPage(),N.publish("h5ds.destoryControl")}))}}}),ps=se()(Ii.prototype,"delGroupLayer",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var n=e.edata.selectGroup;n?Object(Ee.transaction)((function(){var r=e.getPage();r.layers=r.layers.filter((function(e,t){return-1===n.indexOf(t)})),t&&t(r.layers.length),e.edata.selectGroup=!1,e.edata.keys=Q.randomID(),e.edata.layerListKeys=Q.randomID(),N.publish("h5ds.destoryControl")})):ke.message.error("请选择多个图层！")}}}),ls=se()(Ii.prototype,"setPage",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,n){Q.isEmpty(t)&&(t=e.getPageNum()),n||(n=e.edata.selectType),Object(Ee.transaction)((function(){switch(e.edata.selectType=n,n){case"popups":0===e.data.popups.length?e.edata.selectPopup=null:e.edata.selectPopup=t;break;case"pages":0===e.data.pages.length?e.edata.selectPage=null:e.edata.selectPage=t;break;case"fixeds":e.edata.selectFixed=t}e.edata.selectLayer=null,e.edata.pageListKeys=Q.randomID(),e.setType("page")}))}}}),us=se()(Ii.prototype,"clickLayer",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;$("#h5dsLayerList").find("li").eq(e).trigger("click")}}}),hs=se()(Ii.prototype,"setLayer",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){setTimeout((function(){Object(Ee.transaction)((function(){e.edata.selectlayerKeys=Q.randomID(),e.edata.setType="layer",e.edata.selectLayer=t,e.setType("layer")})),N.publish("h5ds.initControl"),N.publish("h5ds.setHistory")}),0)}}}),ds=se()(Ii.prototype,"exChangePage",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,n){var r=e.getPages();Object(Ee.transaction)((function(){switch(new Array(Math.abs(t-n)).fill(1).forEach((function(){if(t<n){var e=[r[t+1],r[t]];r[t]=e[0],r[t+1]=e[1],t++}else{var a=[r[t],r[t-1]];r[t-1]=a[0],r[t]=a[1],t--}})),e.edata.selectType){case"popups":e.edata.selectPopup=n;break;case"fixeds":e.edata.selectFixed=n;break;case"pages":e.edata.selectPage=n}e.edata.pageListKeys=Q.randomID()}))}}}),fs=se()(Ii.prototype,"exChangeLayer",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,n){if(t<0||n<0)return console.error("交换数据错误 i -> j",t,n),!1;var r=e.getLayers();Object(Ee.transaction)((function(){new Array(Math.abs(t-n)).fill(1).forEach((function(){if(t<n){var e=[r[t+1],r[t]];r[t]=e[0],r[t+1]=e[1],t++}else{var a=[r[t],r[t-1]];r[t-1]=a[0],r[t]=a[1],t--}})),e.edata.selectLayer=n,e.edata.keys=Q.randomID(),e.edata.layerListKeys=Q.randomID()}))}}}),ys=se()(Ii.prototype,"delPage",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var n=e.edata,r=n.selectType,a=n.selectPage,o=n.selectPopup,i=n.selectFixed;Object(Ee.transaction)((function(){var n=e.data[r];switch(r){case"popups":t=Q.isEmpty(t)?o:t,n.splice(t,1),e.edata.selectPopup=null;break;case"pages":t=Q.isEmpty(t)?a:t,n.splice(t,1),e.edata.selectPage=null;break;case"fixeds":t=Q.isEmpty(t)?i:t,n.splice(t,1),e.edata.selectFixed=null}e.edata.pageListKeys=Q.randomID()}))}}}),ms=se()(Ii.prototype,"getNullPage",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){return new De}}}),vs=se()(Ii.prototype,"addPage",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,n){if("fixeds"===e.edata.selectType)return ke.message.warn("不能添加浮动层"),!1;if(!t)return console.error("此方法必须传入参数！"),!1;var r=e.getPages();Object(Ee.transaction)((function(){var a=null;switch(e.edata.selectType){case"pages":a="selectPage";break;case"fixeds":a="selectFixed";break;case"popups":a="selectPopup"}t.keyid=Q.randomID();var o=e.edata[a];n&&(o=n),r.splice(o+1,0,Is({},t)),e.edata[a]=o+1,e.edata.selectLayer=null,e.edata.keys=Q.randomID(),e.edata.pageListKeys=Q.randomID()}))}}}),gs=se()(Ii.prototype,"copyPage",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var n=e.edata,r=n.selectType,a=n.selectPage,o=e.getPageNum(),i=e.data[r][t||o];i=e.toJS(i),Object(Ee.transaction)((function(){i.keyid=Q.randomID(),i.id=null,i.layers.map((function(t){return e.originLayerSet(t,!0)})),e.data[r].splice(t||a,0,i)}))}}}),bs=se()(Ii.prototype,"copyLayer",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var n=e.edata,r=n.selectType,a=n.selectLayer,o=e.getPageNum();if(null!==a||void 0!==t){void 0===t&&(t=a);var i=e.data[r][o].layers[t];Object(Ee.transaction)((function(){var n=e.data[r][o].layers,a=e.toJS(i);a.keyid=Q.randomID(),e.originLayerSet(a,!0),n.splice(t,0,a)}))}else ke.message.error("请先选择一个图层进行复制！")}}}),ws=se()(Ii.prototype,"copyAnimate",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=e.getLayer();t?(ke.message.success("复制动画成功！"),e.copyAnimateData=e.toJS(t.animate)):console.error("没有选择任何layer")}}}),ks=se()(Ii.prototype,"pasteAnimate",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=e.getLayer();Object(Ee.transaction)((function(){e.copyAnimateData[0]&&"in"===e.copyAnimateData[0].type&&(t.estyle.opacity=0),t.animate=e.toJS(e.copyAnimateData),ke.message.success("粘贴动画成功！")}))}}}),Es=se()(Ii.prototype,"doHistory",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){if(e.historyIndex,e.history.length,e.historyIndex>=0){"undo"===t?(e.historyIndex--,e.historyIndex<0&&(e.historyIndex=0)):(e.historyIndex++,e.historyIndex>e.history.length&&(e.historyIndex=e.history.length-1));var n=e.history[e.historyIndex]||{},r=n.data,a=n.edata;r&&Object(Ee.transaction)((function(){for(var t in e.data=JSON.parse(r),a=JSON.parse(a))e.edata[t]=a[t]}))}}}}),Os=se()(Ii.prototype,"setHistoryAsync",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return Q.debounce((function(t){e.setHistory(t)}),300)}}),Ss=se()(Ii.prototype,"setHistory",[Ee.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";e.historyIndex,e.history.length,Object(Ee.transaction)((function(){e.history.length!==e.historyIndex+1&&e.history.splice(e.history.length-1-e.historyIndex,e.history.length-1);var n={data:JSON.stringify(e.data),edata:JSON.stringify(e.edata),info:t};e.history.push(n),e.history.length>20&&e.history.shift(),e.historyIndex=e.history.length-1})),e.saveToStore()}}}),Ii),scope:new function e(){m()(this,e),this.props=null,this.plugins=null}};function _s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var Ts=function(e){w()(n,e);var t=_s(n);function n(){return m()(this,n),t.apply(this,arguments)}return g()(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return D.a.createElement(P.a,As,D.a.createElement(xs,this.props))}}]),n}(D.a.Component);function zs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Hs=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zs(Object(n),!0).forEach((function(t){C()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zs(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},je);Object(Un.mountValue)("editor",{H5dsEditor:Ts,getInitData:Pe,enums:Hs});var $s=Ts;function Ws(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var Ms,Bs=function(e){w()(n,e);var t=Ws(n);function n(){var e;m()(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).selectImage=function(t){e.props.select({url:t})},e}return g()(n,[{key:"render",value:function(){var e=this;return D.a.createElement("div",{className:"image-list"},D.a.createElement("ul",null,["http://cdn.h5ds.com/static/images/ad1.png","http://cdn.h5ds.com/static/images/ad2.png","http://cdn.h5ds.com/static/images/ad3.png"].map((function(t,n){return D.a.createElement("li",{key:n,onClick:function(){return e.selectImage(t)}},D.a.createElement("img",{src:t,alt:""}))}))))}}]),n}(x.Component);function Fs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S()(e);if(t){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}var Vs=Object(P.b)("user")(Ms=Object(P.c)(Ms=function(e){w()(n,e);var t=Fs(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).saveApp=function(){var e=f()(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.publishApp=function(){var e=f()(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.state={data:null},r}return g()(n,[{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){e.setState({data:"defaultData"})}),100)}},{key:"render",value:function(){var e=this.state.data;return D.a.createElement($s,{plugins:[],data:e,debugger:!1,options:{noServer:!0,imageSourceModal:Bs,pluginsHost:".",publishApp:this.publishApp,saveApp:this.saveApp,appId:"test_app_id"}})}}]),n}(x.Component))||Ms)||Ms;t.default=Vs}}]);